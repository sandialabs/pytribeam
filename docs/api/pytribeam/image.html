<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="generator" content="pdoc 14.7.0"/>
    <title>pytribeam.image API documentation</title>

    <style>/*! * Bootstrap Reboot v5.0.0 (https://getbootstrap.com/) * Copyright 2011-2021 The Bootstrap Authors * Copyright 2011-2021 Twitter, Inc. * Licensed under MIT (https://github.com/twbs/bootstrap/blob/main/LICENSE) * Forked from Normalize.css, licensed MIT (https://github.com/necolas/normalize.css/blob/master/LICENSE.md) */*,::after,::before{box-sizing:border-box}@media (prefers-reduced-motion:no-preference){:root{scroll-behavior:smooth}}body{margin:0;font-family:system-ui,-apple-system,"Segoe UI",Roboto,"Helvetica Neue",Arial,"Noto Sans","Liberation Sans",sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol","Noto Color Emoji";font-size:1rem;font-weight:400;line-height:1.5;color:#212529;background-color:#fff;-webkit-text-size-adjust:100%;-webkit-tap-highlight-color:transparent}hr{margin:1rem 0;color:inherit;background-color:currentColor;border:0;opacity:.25}hr:not([size]){height:1px}h1,h2,h3,h4,h5,h6{margin-top:0;margin-bottom:.5rem;font-weight:500;line-height:1.2}h1{font-size:calc(1.375rem + 1.5vw)}@media (min-width:1200px){h1{font-size:2.5rem}}h2{font-size:calc(1.325rem + .9vw)}@media (min-width:1200px){h2{font-size:2rem}}h3{font-size:calc(1.3rem + .6vw)}@media (min-width:1200px){h3{font-size:1.75rem}}h4{font-size:calc(1.275rem + .3vw)}@media (min-width:1200px){h4{font-size:1.5rem}}h5{font-size:1.25rem}h6{font-size:1rem}p{margin-top:0;margin-bottom:1rem}abbr[data-bs-original-title],abbr[title]{-webkit-text-decoration:underline dotted;text-decoration:underline dotted;cursor:help;-webkit-text-decoration-skip-ink:none;text-decoration-skip-ink:none}address{margin-bottom:1rem;font-style:normal;line-height:inherit}ol,ul{padding-left:2rem}dl,ol,ul{margin-top:0;margin-bottom:1rem}ol ol,ol ul,ul ol,ul ul{margin-bottom:0}dt{font-weight:700}dd{margin-bottom:.5rem;margin-left:0}blockquote{margin:0 0 1rem}b,strong{font-weight:bolder}small{font-size:.875em}mark{padding:.2em;background-color:#fcf8e3}sub,sup{position:relative;font-size:.75em;line-height:0;vertical-align:baseline}sub{bottom:-.25em}sup{top:-.5em}a{color:#0d6efd;text-decoration:underline}a:hover{color:#0a58ca}a:not([href]):not([class]),a:not([href]):not([class]):hover{color:inherit;text-decoration:none}code,kbd,pre,samp{font-family:SFMono-Regular,Menlo,Monaco,Consolas,"Liberation Mono","Courier New",monospace;font-size:1em;direction:ltr;unicode-bidi:bidi-override}pre{display:block;margin-top:0;margin-bottom:1rem;overflow:auto;font-size:.875em}pre code{font-size:inherit;color:inherit;word-break:normal}code{font-size:.875em;color:#d63384;word-wrap:break-word}a>code{color:inherit}kbd{padding:.2rem .4rem;font-size:.875em;color:#fff;background-color:#212529;border-radius:.2rem}kbd kbd{padding:0;font-size:1em;font-weight:700}figure{margin:0 0 1rem}img,svg{vertical-align:middle}table{caption-side:bottom;border-collapse:collapse}caption{padding-top:.5rem;padding-bottom:.5rem;color:#6c757d;text-align:left}th{text-align:inherit;text-align:-webkit-match-parent}tbody,td,tfoot,th,thead,tr{border-color:inherit;border-style:solid;border-width:0}label{display:inline-block}button{border-radius:0}button:focus:not(:focus-visible){outline:0}button,input,optgroup,select,textarea{margin:0;font-family:inherit;font-size:inherit;line-height:inherit}button,select{text-transform:none}[role=button]{cursor:pointer}select{word-wrap:normal}select:disabled{opacity:1}[list]::-webkit-calendar-picker-indicator{display:none}[type=button],[type=reset],[type=submit],button{-webkit-appearance:button}[type=button]:not(:disabled),[type=reset]:not(:disabled),[type=submit]:not(:disabled),button:not(:disabled){cursor:pointer}::-moz-focus-inner{padding:0;border-style:none}textarea{resize:vertical}fieldset{min-width:0;padding:0;margin:0;border:0}legend{float:left;width:100%;padding:0;margin-bottom:.5rem;font-size:calc(1.275rem + .3vw);line-height:inherit}@media (min-width:1200px){legend{font-size:1.5rem}}legend+*{clear:left}::-webkit-datetime-edit-day-field,::-webkit-datetime-edit-fields-wrapper,::-webkit-datetime-edit-hour-field,::-webkit-datetime-edit-minute,::-webkit-datetime-edit-month-field,::-webkit-datetime-edit-text,::-webkit-datetime-edit-year-field{padding:0}::-webkit-inner-spin-button{height:auto}[type=search]{outline-offset:-2px;-webkit-appearance:textfield}::-webkit-search-decoration{-webkit-appearance:none}::-webkit-color-swatch-wrapper{padding:0}::file-selector-button{font:inherit}::-webkit-file-upload-button{font:inherit;-webkit-appearance:button}output{display:inline-block}iframe{border:0}summary{display:list-item;cursor:pointer}progress{vertical-align:baseline}[hidden]{display:none!important}</style>
    <style>/*! syntax-highlighting.css */pre{line-height:125%;}span.linenos{color:inherit; background-color:transparent; padding-left:5px; padding-right:20px;}.pdoc-code .hll{background-color:#ffffcc}.pdoc-code{background:#f8f8f8;}.pdoc-code .c{color:#3D7B7B; font-style:italic}.pdoc-code .err{border:1px solid #FF0000}.pdoc-code .k{color:#008000; font-weight:bold}.pdoc-code .o{color:#666666}.pdoc-code .ch{color:#3D7B7B; font-style:italic}.pdoc-code .cm{color:#3D7B7B; font-style:italic}.pdoc-code .cp{color:#9C6500}.pdoc-code .cpf{color:#3D7B7B; font-style:italic}.pdoc-code .c1{color:#3D7B7B; font-style:italic}.pdoc-code .cs{color:#3D7B7B; font-style:italic}.pdoc-code .gd{color:#A00000}.pdoc-code .ge{font-style:italic}.pdoc-code .gr{color:#E40000}.pdoc-code .gh{color:#000080; font-weight:bold}.pdoc-code .gi{color:#008400}.pdoc-code .go{color:#717171}.pdoc-code .gp{color:#000080; font-weight:bold}.pdoc-code .gs{font-weight:bold}.pdoc-code .gu{color:#800080; font-weight:bold}.pdoc-code .gt{color:#0044DD}.pdoc-code .kc{color:#008000; font-weight:bold}.pdoc-code .kd{color:#008000; font-weight:bold}.pdoc-code .kn{color:#008000; font-weight:bold}.pdoc-code .kp{color:#008000}.pdoc-code .kr{color:#008000; font-weight:bold}.pdoc-code .kt{color:#B00040}.pdoc-code .m{color:#666666}.pdoc-code .s{color:#BA2121}.pdoc-code .na{color:#687822}.pdoc-code .nb{color:#008000}.pdoc-code .nc{color:#0000FF; font-weight:bold}.pdoc-code .no{color:#880000}.pdoc-code .nd{color:#AA22FF}.pdoc-code .ni{color:#717171; font-weight:bold}.pdoc-code .ne{color:#CB3F38; font-weight:bold}.pdoc-code .nf{color:#0000FF}.pdoc-code .nl{color:#767600}.pdoc-code .nn{color:#0000FF; font-weight:bold}.pdoc-code .nt{color:#008000; font-weight:bold}.pdoc-code .nv{color:#19177C}.pdoc-code .ow{color:#AA22FF; font-weight:bold}.pdoc-code .w{color:#bbbbbb}.pdoc-code .mb{color:#666666}.pdoc-code .mf{color:#666666}.pdoc-code .mh{color:#666666}.pdoc-code .mi{color:#666666}.pdoc-code .mo{color:#666666}.pdoc-code .sa{color:#BA2121}.pdoc-code .sb{color:#BA2121}.pdoc-code .sc{color:#BA2121}.pdoc-code .dl{color:#BA2121}.pdoc-code .sd{color:#BA2121; font-style:italic}.pdoc-code .s2{color:#BA2121}.pdoc-code .se{color:#AA5D1F; font-weight:bold}.pdoc-code .sh{color:#BA2121}.pdoc-code .si{color:#A45A77; font-weight:bold}.pdoc-code .sx{color:#008000}.pdoc-code .sr{color:#A45A77}.pdoc-code .s1{color:#BA2121}.pdoc-code .ss{color:#19177C}.pdoc-code .bp{color:#008000}.pdoc-code .fm{color:#0000FF}.pdoc-code .vc{color:#19177C}.pdoc-code .vg{color:#19177C}.pdoc-code .vi{color:#19177C}.pdoc-code .vm{color:#19177C}.pdoc-code .il{color:#666666}</style>
    <style>/*! theme.css */:root{--pdoc-background:#fff;}.pdoc{--text:#212529;--muted:#6c757d;--link:#3660a5;--link-hover:#1659c5;--code:#f8f8f8;--active:#fff598;--accent:#eee;--accent2:#c1c1c1;--nav-hover:rgba(255, 255, 255, 0.5);--name:#0066BB;--def:#008800;--annotation:#007020;}</style>
    <style>/*! layout.css */html, body{width:100%;height:100%;}html, main{scroll-behavior:smooth;}body{background-color:var(--pdoc-background);}@media (max-width:769px){#navtoggle{cursor:pointer;position:absolute;width:50px;height:40px;top:1rem;right:1rem;border-color:var(--text);color:var(--text);display:flex;opacity:0.8;z-index:999;}#navtoggle:hover{opacity:1;}#togglestate + div{display:none;}#togglestate:checked + div{display:inherit;}main, header{padding:2rem 3vw;}header + main{margin-top:-3rem;}.git-button{display:none !important;}nav input[type="search"]{max-width:77%;}nav input[type="search"]:first-child{margin-top:-6px;}nav input[type="search"]:valid ~ *{display:none !important;}}@media (min-width:770px){:root{--sidebar-width:clamp(12.5rem, 28vw, 22rem);}nav{position:fixed;overflow:auto;height:100vh;width:var(--sidebar-width);}main, header{padding:3rem 2rem 3rem calc(var(--sidebar-width) + 3rem);width:calc(54rem + var(--sidebar-width));max-width:100%;}header + main{margin-top:-4rem;}#navtoggle{display:none;}}#togglestate{position:absolute;height:0;opacity:0;}nav.pdoc{--pad:clamp(0.5rem, 2vw, 1.75rem);--indent:1.5rem;background-color:var(--accent);border-right:1px solid var(--accent2);box-shadow:0 0 20px rgba(50, 50, 50, .2) inset;padding:0 0 0 var(--pad);overflow-wrap:anywhere;scrollbar-width:thin; scrollbar-color:var(--accent2) transparent; z-index:1}nav.pdoc::-webkit-scrollbar{width:.4rem; }nav.pdoc::-webkit-scrollbar-thumb{background-color:var(--accent2); }nav.pdoc > div{padding:var(--pad) 0;}nav.pdoc .module-list-button{display:inline-flex;align-items:center;color:var(--text);border-color:var(--muted);margin-bottom:1rem;}nav.pdoc .module-list-button:hover{border-color:var(--text);}nav.pdoc input[type=search]{display:block;outline-offset:0;width:calc(100% - var(--pad));}nav.pdoc .logo{max-width:calc(100% - var(--pad));max-height:35vh;display:block;margin:0 auto 1rem;transform:translate(calc(-.5 * var(--pad)), 0);}nav.pdoc ul{list-style:none;padding-left:0;}nav.pdoc > div > ul{margin-left:calc(0px - var(--pad));}nav.pdoc li a{padding:.2rem 0 .2rem calc(var(--pad) + var(--indent));}nav.pdoc > div > ul > li > a{padding-left:var(--pad);}nav.pdoc li{transition:all 100ms;}nav.pdoc li:hover{background-color:var(--nav-hover);}nav.pdoc a, nav.pdoc a:hover{color:var(--text);}nav.pdoc a{display:block;}nav.pdoc > h2:first-of-type{margin-top:1.5rem;}nav.pdoc .class:before{content:"class ";color:var(--muted);}nav.pdoc .function:after{content:"()";color:var(--muted);}nav.pdoc footer:before{content:"";display:block;width:calc(100% - var(--pad));border-top:solid var(--accent2) 1px;margin-top:1.5rem;padding-top:.5rem;}nav.pdoc footer{font-size:small;}</style>
    <style>/*! content.css */.pdoc{color:var(--text);box-sizing:border-box;line-height:1.5;background:none;}.pdoc .pdoc-button{cursor:pointer;display:inline-block;border:solid black 1px;border-radius:2px;font-size:.75rem;padding:calc(0.5em - 1px) 1em;transition:100ms all;}.pdoc .alert{padding:1rem 1rem 1rem calc(1.5rem + 24px);border:1px solid transparent;border-radius:.25rem;background-repeat:no-repeat;background-position:.75rem center;margin-bottom:1rem;}.pdoc .alert > em{display:none;}.pdoc .alert > *:last-child{margin-bottom:0;}.pdoc .alert.note {color:#084298;background-color:#cfe2ff;border-color:#b6d4fe;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23084298%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8%2016A8%208%200%201%200%208%200a8%208%200%200%200%200%2016zm.93-9.412-1%204.705c-.07.34.029.533.304.533.194%200%20.487-.07.686-.246l-.088.416c-.287.346-.92.598-1.465.598-.703%200-1.002-.422-.808-1.319l.738-3.468c.064-.293.006-.399-.287-.47l-.451-.081.082-.381%202.29-.287zM8%205.5a1%201%200%201%201%200-2%201%201%200%200%201%200%202z%22/%3E%3C/svg%3E");}.pdoc .alert.warning{color:#664d03;background-color:#fff3cd;border-color:#ffecb5;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23664d03%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M8.982%201.566a1.13%201.13%200%200%200-1.96%200L.165%2013.233c-.457.778.091%201.767.98%201.767h13.713c.889%200%201.438-.99.98-1.767L8.982%201.566zM8%205c.535%200%20.954.462.9.995l-.35%203.507a.552.552%200%200%201-1.1%200L7.1%205.995A.905.905%200%200%201%208%205zm.002%206a1%201%200%201%201%200%202%201%201%200%200%201%200-2z%22/%3E%3C/svg%3E");}.pdoc .alert.danger{color:#842029;background-color:#f8d7da;border-color:#f5c2c7;background-image:url("data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20width%3D%2224%22%20height%3D%2224%22%20fill%3D%22%23842029%22%20viewBox%3D%220%200%2016%2016%22%3E%3Cpath%20d%3D%22M5.52.359A.5.5%200%200%201%206%200h4a.5.5%200%200%201%20.474.658L8.694%206H12.5a.5.5%200%200%201%20.395.807l-7%209a.5.5%200%200%201-.873-.454L6.823%209.5H3.5a.5.5%200%200%201-.48-.641l2.5-8.5z%22/%3E%3C/svg%3E");}.pdoc .visually-hidden{position:absolute !important;width:1px !important;height:1px !important;padding:0 !important;margin:-1px !important;overflow:hidden !important;clip:rect(0, 0, 0, 0) !important;white-space:nowrap !important;border:0 !important;}.pdoc h1, .pdoc h2, .pdoc h3{font-weight:300;margin:.3em 0;padding:.2em 0;}.pdoc > section:not(.module-info) h1{font-size:1.5rem;font-weight:500;}.pdoc > section:not(.module-info) h2{font-size:1.4rem;font-weight:500;}.pdoc > section:not(.module-info) h3{font-size:1.3rem;font-weight:500;}.pdoc > section:not(.module-info) h4{font-size:1.2rem;}.pdoc > section:not(.module-info) h5{font-size:1.1rem;}.pdoc a{text-decoration:none;color:var(--link);}.pdoc a:hover{color:var(--link-hover);}.pdoc blockquote{margin-left:2rem;}.pdoc pre{border-top:1px solid var(--accent2);border-bottom:1px solid var(--accent2);margin-top:0;margin-bottom:1em;padding:.5rem 0 .5rem .5rem;overflow-x:auto;background-color:var(--code);}.pdoc code{color:var(--text);padding:.2em .4em;margin:0;font-size:85%;background-color:var(--accent);border-radius:6px;}.pdoc a > code{color:inherit;}.pdoc pre > code{display:inline-block;font-size:inherit;background:none;border:none;padding:0;}.pdoc > section:not(.module-info){margin-bottom:1.5rem;}.pdoc .modulename{margin-top:0;font-weight:bold;}.pdoc .modulename a{color:var(--link);transition:100ms all;}.pdoc .git-button{float:right;border:solid var(--link) 1px;}.pdoc .git-button:hover{background-color:var(--link);color:var(--pdoc-background);}.view-source-toggle-state,.view-source-toggle-state ~ .pdoc-code{display:none;}.view-source-toggle-state:checked ~ .pdoc-code{display:block;}.view-source-button{display:inline-block;float:right;font-size:.75rem;line-height:1.5rem;color:var(--muted);padding:0 .4rem 0 1.3rem;cursor:pointer;text-indent:-2px;}.view-source-button > span{visibility:hidden;}.module-info .view-source-button{float:none;display:flex;justify-content:flex-end;margin:-1.2rem .4rem -.2rem 0;}.view-source-button::before{position:absolute;content:"View Source";display:list-item;list-style-type:disclosure-closed;}.view-source-toggle-state:checked ~ .attr .view-source-button::before,.view-source-toggle-state:checked ~ .view-source-button::before{list-style-type:disclosure-open;}.pdoc .docstring{margin-bottom:1.5rem;}.pdoc section:not(.module-info) .docstring{margin-left:clamp(0rem, 5vw - 2rem, 1rem);}.pdoc .docstring .pdoc-code{margin-left:1em;margin-right:1em;}.pdoc h1:target,.pdoc h2:target,.pdoc h3:target,.pdoc h4:target,.pdoc h5:target,.pdoc h6:target,.pdoc .pdoc-code > pre > span:target{background-color:var(--active);box-shadow:-1rem 0 0 0 var(--active);}.pdoc .pdoc-code > pre > span:target{display:block;}.pdoc div:target > .attr,.pdoc section:target > .attr,.pdoc dd:target > a{background-color:var(--active);}.pdoc *{scroll-margin:2rem;}.pdoc .pdoc-code .linenos{user-select:none;}.pdoc .attr:hover{filter:contrast(0.95);}.pdoc section, .pdoc .classattr{position:relative;}.pdoc .headerlink{--width:clamp(1rem, 3vw, 2rem);position:absolute;top:0;left:calc(0rem - var(--width));transition:all 100ms ease-in-out;opacity:0;}.pdoc .headerlink::before{content:"#";display:block;text-align:center;width:var(--width);height:2.3rem;line-height:2.3rem;font-size:1.5rem;}.pdoc .attr:hover ~ .headerlink,.pdoc *:target > .headerlink,.pdoc .headerlink:hover{opacity:1;}.pdoc .attr{display:block;margin:.5rem 0 .5rem;padding:.4rem .4rem .4rem 1rem;background-color:var(--accent);overflow-x:auto;}.pdoc .classattr{margin-left:2rem;}.pdoc .name{color:var(--name);font-weight:bold;}.pdoc .def{color:var(--def);font-weight:bold;}.pdoc .signature{background-color:transparent;}.pdoc .param, .pdoc .return-annotation{white-space:pre;}.pdoc .signature.multiline .param{display:block;}.pdoc .signature.condensed .param{display:inline-block;}.pdoc .annotation{color:var(--annotation);}.pdoc .view-value-toggle-state,.pdoc .view-value-toggle-state ~ .default_value{display:none;}.pdoc .view-value-toggle-state:checked ~ .default_value{display:inherit;}.pdoc .view-value-button{font-size:.5rem;vertical-align:middle;border-style:dashed;margin-top:-0.1rem;}.pdoc .view-value-button:hover{background:white;}.pdoc .view-value-button::before{content:"show";text-align:center;width:2.2em;display:inline-block;}.pdoc .view-value-toggle-state:checked ~ .view-value-button::before{content:"hide";}.pdoc .inherited{margin-left:2rem;}.pdoc .inherited dt{font-weight:700;}.pdoc .inherited dt, .pdoc .inherited dd{display:inline;margin-left:0;margin-bottom:.5rem;}.pdoc .inherited dd:not(:last-child):after{content:", ";}.pdoc .inherited .class:before{content:"class ";}.pdoc .inherited .function a:after{content:"()";}.pdoc .search-result .docstring{overflow:auto;max-height:25vh;}.pdoc .search-result.focused > .attr{background-color:var(--active);}.pdoc .attribution{margin-top:2rem;display:block;opacity:0.5;transition:all 200ms;filter:grayscale(100%);}.pdoc .attribution:hover{opacity:1;filter:grayscale(0%);}.pdoc .attribution img{margin-left:5px;height:35px;vertical-align:middle;width:70px;transition:all 200ms;}.pdoc table{display:block;width:max-content;max-width:100%;overflow:auto;margin-bottom:1rem;}.pdoc table th{font-weight:600;}.pdoc table th, .pdoc table td{padding:6px 13px;border:1px solid var(--accent2);}</style>
    <style>/*! custom.css */</style></head>
<body>
    <nav class="pdoc">
        <label id="navtoggle" for="togglestate" class="pdoc-button"><svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 30 30'><path stroke-linecap='round' stroke="currentColor" stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/></svg></label>
        <input id="togglestate" type="checkbox" aria-hidden="true" tabindex="-1">
        <div>            <a class="pdoc-button module-list-button" href="../pytribeam.html">
<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" fill="currentColor" class="bi bi-box-arrow-in-left" viewBox="0 0 16 16">
  <path fill-rule="evenodd" d="M10 3.5a.5.5 0 0 0-.5-.5h-8a.5.5 0 0 0-.5.5v9a.5.5 0 0 0 .5.5h8a.5.5 0 0 0 .5-.5v-2a.5.5 0 0 1 1 0v2A1.5 1.5 0 0 1 9.5 14h-8A1.5 1.5 0 0 1 0 12.5v-9A1.5 1.5 0 0 1 1.5 2h8A1.5 1.5 0 0 1 11 3.5v2a.5.5 0 0 1-1 0v-2z"/>
  <path fill-rule="evenodd" d="M4.146 8.354a.5.5 0 0 1 0-.708l3-3a.5.5 0 1 1 .708.708L5.707 7.5H14.5a.5.5 0 0 1 0 1H5.707l2.147 2.146a.5.5 0 0 1-.708.708l-3-3z"/>
</svg>                &nbsp;pytribeam</a>


            <input type="search" placeholder="Search..." role="searchbox" aria-label="search"
                   pattern=".+" required>

            <h2>Contents</h2>
            <ul>
  <li><a href="#microscope-imaging-module">Microscope Imaging Module</a>
  <ul>
    <li><a href="#functions">Functions</a></li>
  </ul></li>
</ul>



            <h2>API Documentation</h2>
                <ul class="memberlist">
            <li>
                    <a class="function" href="#beam_angular_correction">beam_angular_correction</a>
            </li>
            <li>
                    <a class="function" href="#beam_current">beam_current</a>
            </li>
            <li>
                    <a class="function" href="#beam_dwell_time">beam_dwell_time</a>
            </li>
            <li>
                    <a class="function" href="#beam_hfw">beam_hfw</a>
            </li>
            <li>
                    <a class="function" href="#beam_ready">beam_ready</a>
            </li>
            <li>
                    <a class="function" href="#beam_scan_full_frame">beam_scan_full_frame</a>
            </li>
            <li>
                    <a class="function" href="#beam_scan_resolution">beam_scan_resolution</a>
            </li>
            <li>
                    <a class="function" href="#beam_scan_rotation">beam_scan_rotation</a>
            </li>
            <li>
                    <a class="function" href="#beam_voltage">beam_voltage</a>
            </li>
            <li>
                    <a class="function" href="#beam_working_distance">beam_working_distance</a>
            </li>
            <li>
                    <a class="function" href="#detector_auto_cb">detector_auto_cb</a>
            </li>
            <li>
                    <a class="function" href="#detector_brightness">detector_brightness</a>
            </li>
            <li>
                    <a class="function" href="#detector_contrast">detector_contrast</a>
            </li>
            <li>
                    <a class="function" href="#detector_cb">detector_cb</a>
            </li>
            <li>
                    <a class="function" href="#detector_mode">detector_mode</a>
            </li>
            <li>
                    <a class="function" href="#detector_type">detector_type</a>
            </li>
            <li>
                    <a class="function" href="#grab_custom_resolution_frame">grab_custom_resolution_frame</a>
            </li>
            <li>
                    <a class="function" href="#grab_preset_resolution_frame">grab_preset_resolution_frame</a>
            </li>
            <li>
                    <a class="function" href="#imaging_detector">imaging_detector</a>
            </li>
            <li>
                    <a class="function" href="#imaging_device">imaging_device</a>
            </li>
            <li>
                    <a class="function" href="#imaging_scan">imaging_scan</a>
            </li>
            <li>
                    <a class="function" href="#prepare_imaging">prepare_imaging</a>
            </li>
            <li>
                    <a class="function" href="#set_view">set_view</a>
            </li>
            <li>
                    <a class="function" href="#set_beam_device">set_beam_device</a>
            </li>
            <li>
                    <a class="function" href="#collect_single_image">collect_single_image</a>
            </li>
            <li>
                    <a class="function" href="#collect_multiple_images">collect_multiple_images</a>
            </li>
            <li>
                    <a class="function" href="#image_operation">image_operation</a>
            </li>
    </ul>



        <a class="attribution" title="pdoc: Python API documentation generator" href="https://pdoc.dev" target="_blank">
            built with <span class="visually-hidden">pdoc</span><img
                alt="pdoc logo"
                src="data:image/svg+xml,%3Csvg%20xmlns%3D%22http%3A//www.w3.org/2000/svg%22%20role%3D%22img%22%20aria-label%3D%22pdoc%20logo%22%20width%3D%22300%22%20height%3D%22150%22%20viewBox%3D%22-1%200%2060%2030%22%3E%3Ctitle%3Epdoc%3C/title%3E%3Cpath%20d%3D%22M29.621%2021.293c-.011-.273-.214-.475-.511-.481a.5.5%200%200%200-.489.503l-.044%201.393c-.097.551-.695%201.215-1.566%201.704-.577.428-1.306.486-2.193.182-1.426-.617-2.467-1.654-3.304-2.487l-.173-.172a3.43%203.43%200%200%200-.365-.306.49.49%200%200%200-.286-.196c-1.718-1.06-4.931-1.47-7.353.191l-.219.15c-1.707%201.187-3.413%202.131-4.328%201.03-.02-.027-.49-.685-.141-1.763.233-.721.546-2.408.772-4.076.042-.09.067-.187.046-.288.166-1.347.277-2.625.241-3.351%201.378-1.008%202.271-2.586%202.271-4.362%200-.976-.272-1.935-.788-2.774-.057-.094-.122-.18-.184-.268.033-.167.052-.339.052-.516%200-1.477-1.202-2.679-2.679-2.679-.791%200-1.496.352-1.987.9a6.3%206.3%200%200%200-1.001.029c-.492-.564-1.207-.929-2.012-.929-1.477%200-2.679%201.202-2.679%202.679A2.65%202.65%200%200%200%20.97%206.554c-.383.747-.595%201.572-.595%202.41%200%202.311%201.507%204.29%203.635%205.107-.037.699-.147%202.27-.423%203.294l-.137.461c-.622%202.042-2.515%208.257%201.727%2010.643%201.614.908%203.06%201.248%204.317%201.248%202.665%200%204.492-1.524%205.322-2.401%201.476-1.559%202.886-1.854%206.491.82%201.877%201.393%203.514%201.753%204.861%201.068%202.223-1.713%202.811-3.867%203.399-6.374.077-.846.056-1.469.054-1.537zm-4.835%204.313c-.054.305-.156.586-.242.629-.034-.007-.131-.022-.307-.157-.145-.111-.314-.478-.456-.908.221.121.432.25.675.355.115.039.219.051.33.081zm-2.251-1.238c-.05.33-.158.648-.252.694-.022.001-.125-.018-.307-.157-.217-.166-.488-.906-.639-1.573.358.344.754.693%201.198%201.036zm-3.887-2.337c-.006-.116-.018-.231-.041-.342.635.145%201.189.368%201.599.625.097.231.166.481.174.642-.03.049-.055.101-.067.158-.046.013-.128.026-.298.004-.278-.037-.901-.57-1.367-1.087zm-1.127-.497c.116.306.176.625.12.71-.019.014-.117.045-.345.016-.206-.027-.604-.332-.986-.695.41-.051.816-.056%201.211-.031zm-4.535%201.535c.209.22.379.47.358.598-.006.041-.088.138-.351.234-.144.055-.539-.063-.979-.259a11.66%2011.66%200%200%200%20.972-.573zm.983-.664c.359-.237.738-.418%201.126-.554.25.237.479.548.457.694-.006.042-.087.138-.351.235-.174.064-.694-.105-1.232-.375zm-3.381%201.794c-.022.145-.061.29-.149.401-.133.166-.358.248-.69.251h-.002c-.133%200-.306-.26-.45-.621.417.091.854.07%201.291-.031zm-2.066-8.077a4.78%204.78%200%200%201-.775-.584c.172-.115.505-.254.88-.378l-.105.962zm-.331%202.302a10.32%2010.32%200%200%201-.828-.502c.202-.143.576-.328.984-.49l-.156.992zm-.45%202.157l-.701-.403c.214-.115.536-.249.891-.376a11.57%2011.57%200%200%201-.19.779zm-.181%201.716c.064.398.194.702.298.893-.194-.051-.435-.162-.736-.398.061-.119.224-.3.438-.495zM8.87%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zm-.735-.389a1.15%201.15%200%200%200-.314.783%201.16%201.16%200%200%200%201.162%201.162c.457%200%20.842-.27%201.032-.653.026.117.042.238.042.362a1.68%201.68%200%200%201-1.679%201.679%201.68%201.68%200%200%201-1.679-1.679c0-.843.626-1.535%201.436-1.654zM5.059%205.406A1.68%201.68%200%200%201%203.38%207.085a1.68%201.68%200%200%201-1.679-1.679c0-.037.009-.072.011-.109.21.3.541.508.935.508a1.16%201.16%200%200%200%201.162-1.162%201.14%201.14%200%200%200-.474-.912c.015%200%20.03-.005.045-.005.926.001%201.679.754%201.679%201.68zM3.198%204.141c0%20.152-.123.276-.276.276s-.275-.124-.275-.276.123-.276.276-.276.275.124.275.276zM1.375%208.964c0-.52.103-1.035.288-1.52.466.394%201.06.64%201.717.64%201.144%200%202.116-.725%202.499-1.738.383%201.012%201.355%201.738%202.499%201.738.867%200%201.631-.421%202.121-1.062.307.605.478%201.267.478%201.942%200%202.486-2.153%204.51-4.801%204.51s-4.801-2.023-4.801-4.51zm24.342%2019.349c-.985.498-2.267.168-3.813-.979-3.073-2.281-5.453-3.199-7.813-.705-1.315%201.391-4.163%203.365-8.423.97-3.174-1.786-2.239-6.266-1.261-9.479l.146-.492c.276-1.02.395-2.457.444-3.268a6.11%206.11%200%200%200%201.18.115%206.01%206.01%200%200%200%202.536-.562l-.006.175c-.802.215-1.848.612-2.021%201.25-.079.295.021.601.274.837.219.203.415.364.598.501-.667.304-1.243.698-1.311%201.179-.02.144-.022.507.393.787.213.144.395.26.564.365-1.285.521-1.361.96-1.381%201.126-.018.142-.011.496.427.746l.854.489c-.473.389-.971.914-.999%201.429-.018.278.095.532.316.713.675.556%201.231.721%201.653.721.059%200%20.104-.014.158-.02.207.707.641%201.64%201.513%201.64h.013c.8-.008%201.236-.345%201.462-.626.173-.216.268-.457.325-.692.424.195.93.374%201.372.374.151%200%20.294-.021.423-.068.732-.27.944-.704.993-1.021.009-.061.003-.119.002-.179.266.086.538.147.789.147.15%200%20.294-.021.423-.069.542-.2.797-.489.914-.754.237.147.478.258.704.288.106.014.205.021.296.021.356%200%20.595-.101.767-.229.438.435%201.094.992%201.656%201.067.106.014.205.021.296.021a1.56%201.56%200%200%200%20.323-.035c.17.575.453%201.289.866%201.605.358.273.665.362.914.362a.99.99%200%200%200%20.421-.093%201.03%201.03%200%200%200%20.245-.164c.168.428.39.846.68%201.068.358.273.665.362.913.362a.99.99%200%200%200%20.421-.093c.317-.148.512-.448.639-.762.251.157.495.257.726.257.127%200%20.25-.024.37-.071.427-.17.706-.617.841-1.314.022-.015.047-.022.068-.038.067-.051.133-.104.196-.159-.443%201.486-1.107%202.761-2.086%203.257zM8.66%209.925a.5.5%200%201%200-1%200c0%20.653-.818%201.205-1.787%201.205s-1.787-.552-1.787-1.205a.5.5%200%201%200-1%200c0%201.216%201.25%202.205%202.787%202.205s2.787-.989%202.787-2.205zm4.4%2015.965l-.208.097c-2.661%201.258-4.708%201.436-6.086.527-1.542-1.017-1.88-3.19-1.844-4.198a.4.4%200%200%200-.385-.414c-.242-.029-.406.164-.414.385-.046%201.249.367%203.686%202.202%204.896.708.467%201.547.7%202.51.7%201.248%200%202.706-.392%204.362-1.174l.185-.086a.4.4%200%200%200%20.205-.527c-.089-.204-.326-.291-.527-.206zM9.547%202.292c.093.077.205.114.317.114a.5.5%200%200%200%20.318-.886L8.817.397a.5.5%200%200%200-.703.068.5.5%200%200%200%20.069.703l1.364%201.124zm-7.661-.065c.086%200%20.173-.022.253-.068l1.523-.893a.5.5%200%200%200-.506-.863l-1.523.892a.5.5%200%200%200-.179.685c.094.158.261.247.432.247z%22%20transform%3D%22matrix%28-1%200%200%201%2058%200%29%22%20fill%3D%22%233bb300%22/%3E%3Cpath%20d%3D%22M.3%2021.86V10.18q0-.46.02-.68.04-.22.18-.5.28-.54%201.34-.54%201.06%200%201.42.28.38.26.44.78.76-1.04%202.38-1.04%201.64%200%203.1%201.54%201.46%201.54%201.46%203.58%200%202.04-1.46%203.58-1.44%201.54-3.08%201.54-1.64%200-2.38-.92v4.04q0%20.46-.04.68-.02.22-.18.5-.14.3-.5.42-.36.12-.98.12-.62%200-1-.12-.36-.12-.52-.4-.14-.28-.18-.5-.02-.22-.02-.68zm3.96-9.42q-.46.54-.46%201.18%200%20.64.46%201.18.48.52%201.2.52.74%200%201.24-.52.52-.52.52-1.18%200-.66-.48-1.18-.48-.54-1.26-.54-.76%200-1.22.54zm14.741-8.36q.16-.3.54-.42.38-.12%201-.12.64%200%201.02.12.38.12.52.42.16.3.18.54.04.22.04.68v11.94q0%20.46-.04.7-.02.22-.18.5-.3.54-1.7.54-1.38%200-1.54-.98-.84.96-2.34.96-1.8%200-3.28-1.56-1.48-1.58-1.48-3.66%200-2.1%201.48-3.68%201.5-1.58%203.28-1.58%201.48%200%202.3%201v-4.2q0-.46.02-.68.04-.24.18-.52zm-3.24%2010.86q.52.54%201.26.54.74%200%201.22-.54.5-.54.5-1.18%200-.66-.48-1.22-.46-.56-1.26-.56-.8%200-1.28.56-.48.54-.48%201.2%200%20.66.52%201.2zm7.833-1.2q0-2.4%201.68-3.96%201.68-1.56%203.84-1.56%202.16%200%203.82%201.56%201.66%201.54%201.66%203.94%200%201.66-.86%202.96-.86%201.28-2.1%201.9-1.22.6-2.54.6-1.32%200-2.56-.64-1.24-.66-2.1-1.92-.84-1.28-.84-2.88zm4.18%201.44q.64.48%201.3.48.66%200%201.32-.5.66-.5.66-1.48%200-.98-.62-1.46-.62-.48-1.34-.48-.72%200-1.34.5-.62.5-.62%201.48%200%20.96.64%201.46zm11.412-1.44q0%20.84.56%201.32.56.46%201.18.46.64%200%201.18-.36.56-.38.9-.38.6%200%201.46%201.06.46.58.46%201.04%200%20.76-1.1%201.42-1.14.8-2.8.8-1.86%200-3.58-1.34-.82-.64-1.34-1.7-.52-1.08-.52-2.36%200-1.3.52-2.34.52-1.06%201.34-1.7%201.66-1.32%203.54-1.32.76%200%201.48.22.72.2%201.06.4l.32.2q.36.24.56.38.52.4.52.92%200%20.5-.42%201.14-.72%201.1-1.38%201.1-.38%200-1.08-.44-.36-.34-1.04-.34-.66%200-1.24.48-.58.48-.58%201.34z%22%20fill%3D%22green%22/%3E%3C/svg%3E"/>
        </a>
</div>
    </nav>
    <main class="pdoc">
            <section class="module-info">
                    <h1 class="modulename">
<a href="./../pytribeam.html">pytribeam</a><wbr>.image    </h1>

                        <div class="docstring"><h1 id="microscope-imaging-module">Microscope Imaging Module</h1>

<p>This module provides a set of functions for configuring and operating the microscope for imaging purposes.
It includes functions for setting beam parameters, detector settings, and capturing images with custom
or preset resolutions.</p>

<h2 id="functions">Functions</h2>

<p>beam_angular_correction(microscope, dynamic_focus, tilt_correction, delay_s=0.5)
    Uses auto mode to set tilt correction and dynamic focus.</p>

<p>beam_current(beam, microscope, current_na, current_tol_na, delay_s=5.0)
    Sets the current for the selected beam type, with inputs in units of nanoamps.</p>

<p>beam_dwell_time(beam, microscope, dwell_us, delay_s=0.1)
    Sets the dwell time for the selected beam, with inputs in units of microseconds.</p>

<p>beam_hfw(beam, microscope, hfw_mm, delay_s=0.1)
    Sets the horizontal field width for the selected beam, with inputs in units of millimeters.</p>

<p>beam_ready(beam, microscope, delay_s=5.0, attempts=2)
    Checks if the beam is on or blanked, and tries to turn it on and unblank it if possible.</p>

<p>beam_scan_full_frame(beam, microscope)
    Sets the beam scan mode to full frame.</p>

<p>beam_scan_resolution(beam, microscope, resolution, delay_s=0.1)
    Sets the scan resolution for the selected beam, with inputs in units of preset resolutions.</p>

<p>beam_scan_rotation(beam, microscope, rotation_deg, delay_s=0.1)
    Sets the scan rotation for the selected beam, with inputs in units of degrees.</p>

<p>beam_voltage(beam, microscope, voltage_kv, voltage_tol_kv, delay_s=5.0)
    Sets the voltage for a given beam type, with inputs in units of kilovolts.</p>

<p>beam_working_dist(beam, microscope, wd_mm, delay_s=0.1)
    Sets the working distance for the selected beam, with inputs in units of millimeters.</p>

<p>collect_multiple_images(multiple_img_settings, num_frames)
    Sets up scanning for multiple frames.</p>

<p>collect_single_image(save_path, img_settings)
    Collects a single frame image with defined image settings.</p>

<p>detector_auto_cb(microscope, beam, settings, delay_s=0.1)
    Runs the detector auto contrast-brightness function.</p>

<p>detector_brightness(microscope, brightness, delay_s=0.1)
    Sets the detector brightness with input from 0 to 1.</p>

<p>detector_cb(microscope, detector_settings, beam)
    Sets detector contrast and brightness.</p>

<p>detector_contrast(microscope, contrast, delay_s=0.1)
    Sets the detector contrast with input from 0 to 1.</p>

<p>detector_mode(microscope, detector_mode, delay_s=0.1)
    Sets the detector mode.</p>

<p>detector_type(microscope, detector, delay_s=0.1)
    Sets the detector type.</p>

<p>grab_custom_resolution_frame(img_settings, save_path)
    Captures a single frame image using custom resolutions and saves it to the specified path.</p>

<p>grab_preset_resolution_frame(img_settings)
    Captures a single frame image using preset resolutions.</p>

<p>image_operation(step, image_settings, general_settings, slice_number)
    Performs an image operation based on the specified settings.</p>

<p>imaging_detector(img_settings)
    Prepares the detector and inserts it if applicable.</p>

<p>imaging_device(microscope, beam)
    Prepares the imaging beam, viewing quad, and the beam voltage and current.</p>

<p>imaging_scan(img_settings)
    Sets all scan settings except for the resolution.</p>

<p>prepare_imaging(img_settings)
    Prepares various imaging settings.</p>

<p>set_beam_device(microscope, device, delay_s=0.1)
    Sets the active imaging device.</p>

<p>set_view(microscope, quad)
    Sets the active view to the specified quad.</p>
</div>

                        <input id="mod-image-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">

                        <label class="view-source-button" for="mod-image-view-source"><span>View Source</span></label>

                        <div class="pdoc-code codehilite"><pre><span></span><span id="L-1"><a href="#L-1"><span class="linenos">   1</span></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-2"><a href="#L-2"><span class="linenos">   2</span></a><span class="sd">Microscope Imaging Module</span>
</span><span id="L-3"><a href="#L-3"><span class="linenos">   3</span></a><span class="sd">=========================</span>
</span><span id="L-4"><a href="#L-4"><span class="linenos">   4</span></a>
</span><span id="L-5"><a href="#L-5"><span class="linenos">   5</span></a><span class="sd">This module provides a set of functions for configuring and operating the microscope for imaging purposes.</span>
</span><span id="L-6"><a href="#L-6"><span class="linenos">   6</span></a><span class="sd">It includes functions for setting beam parameters, detector settings, and capturing images with custom</span>
</span><span id="L-7"><a href="#L-7"><span class="linenos">   7</span></a><span class="sd">or preset resolutions.</span>
</span><span id="L-8"><a href="#L-8"><span class="linenos">   8</span></a>
</span><span id="L-9"><a href="#L-9"><span class="linenos">   9</span></a><span class="sd">Functions</span>
</span><span id="L-10"><a href="#L-10"><span class="linenos">  10</span></a><span class="sd">---------</span>
</span><span id="L-11"><a href="#L-11"><span class="linenos">  11</span></a><span class="sd">beam_angular_correction(microscope, dynamic_focus, tilt_correction, delay_s=0.5)</span>
</span><span id="L-12"><a href="#L-12"><span class="linenos">  12</span></a><span class="sd">    Uses auto mode to set tilt correction and dynamic focus.</span>
</span><span id="L-13"><a href="#L-13"><span class="linenos">  13</span></a>
</span><span id="L-14"><a href="#L-14"><span class="linenos">  14</span></a><span class="sd">beam_current(beam, microscope, current_na, current_tol_na, delay_s=5.0)</span>
</span><span id="L-15"><a href="#L-15"><span class="linenos">  15</span></a><span class="sd">    Sets the current for the selected beam type, with inputs in units of nanoamps.</span>
</span><span id="L-16"><a href="#L-16"><span class="linenos">  16</span></a>
</span><span id="L-17"><a href="#L-17"><span class="linenos">  17</span></a><span class="sd">beam_dwell_time(beam, microscope, dwell_us, delay_s=0.1)</span>
</span><span id="L-18"><a href="#L-18"><span class="linenos">  18</span></a><span class="sd">    Sets the dwell time for the selected beam, with inputs in units of microseconds.</span>
</span><span id="L-19"><a href="#L-19"><span class="linenos">  19</span></a>
</span><span id="L-20"><a href="#L-20"><span class="linenos">  20</span></a><span class="sd">beam_hfw(beam, microscope, hfw_mm, delay_s=0.1)</span>
</span><span id="L-21"><a href="#L-21"><span class="linenos">  21</span></a><span class="sd">    Sets the horizontal field width for the selected beam, with inputs in units of millimeters.</span>
</span><span id="L-22"><a href="#L-22"><span class="linenos">  22</span></a>
</span><span id="L-23"><a href="#L-23"><span class="linenos">  23</span></a><span class="sd">beam_ready(beam, microscope, delay_s=5.0, attempts=2)</span>
</span><span id="L-24"><a href="#L-24"><span class="linenos">  24</span></a><span class="sd">    Checks if the beam is on or blanked, and tries to turn it on and unblank it if possible.</span>
</span><span id="L-25"><a href="#L-25"><span class="linenos">  25</span></a>
</span><span id="L-26"><a href="#L-26"><span class="linenos">  26</span></a><span class="sd">beam_scan_full_frame(beam, microscope)</span>
</span><span id="L-27"><a href="#L-27"><span class="linenos">  27</span></a><span class="sd">    Sets the beam scan mode to full frame.</span>
</span><span id="L-28"><a href="#L-28"><span class="linenos">  28</span></a>
</span><span id="L-29"><a href="#L-29"><span class="linenos">  29</span></a><span class="sd">beam_scan_resolution(beam, microscope, resolution, delay_s=0.1)</span>
</span><span id="L-30"><a href="#L-30"><span class="linenos">  30</span></a><span class="sd">    Sets the scan resolution for the selected beam, with inputs in units of preset resolutions.</span>
</span><span id="L-31"><a href="#L-31"><span class="linenos">  31</span></a>
</span><span id="L-32"><a href="#L-32"><span class="linenos">  32</span></a><span class="sd">beam_scan_rotation(beam, microscope, rotation_deg, delay_s=0.1)</span>
</span><span id="L-33"><a href="#L-33"><span class="linenos">  33</span></a><span class="sd">    Sets the scan rotation for the selected beam, with inputs in units of degrees.</span>
</span><span id="L-34"><a href="#L-34"><span class="linenos">  34</span></a>
</span><span id="L-35"><a href="#L-35"><span class="linenos">  35</span></a><span class="sd">beam_voltage(beam, microscope, voltage_kv, voltage_tol_kv, delay_s=5.0)</span>
</span><span id="L-36"><a href="#L-36"><span class="linenos">  36</span></a><span class="sd">    Sets the voltage for a given beam type, with inputs in units of kilovolts.</span>
</span><span id="L-37"><a href="#L-37"><span class="linenos">  37</span></a>
</span><span id="L-38"><a href="#L-38"><span class="linenos">  38</span></a><span class="sd">beam_working_dist(beam, microscope, wd_mm, delay_s=0.1)</span>
</span><span id="L-39"><a href="#L-39"><span class="linenos">  39</span></a><span class="sd">    Sets the working distance for the selected beam, with inputs in units of millimeters.</span>
</span><span id="L-40"><a href="#L-40"><span class="linenos">  40</span></a>
</span><span id="L-41"><a href="#L-41"><span class="linenos">  41</span></a><span class="sd">collect_multiple_images(multiple_img_settings, num_frames)</span>
</span><span id="L-42"><a href="#L-42"><span class="linenos">  42</span></a><span class="sd">    Sets up scanning for multiple frames.</span>
</span><span id="L-43"><a href="#L-43"><span class="linenos">  43</span></a>
</span><span id="L-44"><a href="#L-44"><span class="linenos">  44</span></a><span class="sd">collect_single_image(save_path, img_settings)</span>
</span><span id="L-45"><a href="#L-45"><span class="linenos">  45</span></a><span class="sd">    Collects a single frame image with defined image settings.</span>
</span><span id="L-46"><a href="#L-46"><span class="linenos">  46</span></a>
</span><span id="L-47"><a href="#L-47"><span class="linenos">  47</span></a><span class="sd">detector_auto_cb(microscope, beam, settings, delay_s=0.1)</span>
</span><span id="L-48"><a href="#L-48"><span class="linenos">  48</span></a><span class="sd">    Runs the detector auto contrast-brightness function.</span>
</span><span id="L-49"><a href="#L-49"><span class="linenos">  49</span></a>
</span><span id="L-50"><a href="#L-50"><span class="linenos">  50</span></a><span class="sd">detector_brightness(microscope, brightness, delay_s=0.1)</span>
</span><span id="L-51"><a href="#L-51"><span class="linenos">  51</span></a><span class="sd">    Sets the detector brightness with input from 0 to 1.</span>
</span><span id="L-52"><a href="#L-52"><span class="linenos">  52</span></a>
</span><span id="L-53"><a href="#L-53"><span class="linenos">  53</span></a><span class="sd">detector_cb(microscope, detector_settings, beam)</span>
</span><span id="L-54"><a href="#L-54"><span class="linenos">  54</span></a><span class="sd">    Sets detector contrast and brightness.</span>
</span><span id="L-55"><a href="#L-55"><span class="linenos">  55</span></a>
</span><span id="L-56"><a href="#L-56"><span class="linenos">  56</span></a><span class="sd">detector_contrast(microscope, contrast, delay_s=0.1)</span>
</span><span id="L-57"><a href="#L-57"><span class="linenos">  57</span></a><span class="sd">    Sets the detector contrast with input from 0 to 1.</span>
</span><span id="L-58"><a href="#L-58"><span class="linenos">  58</span></a>
</span><span id="L-59"><a href="#L-59"><span class="linenos">  59</span></a><span class="sd">detector_mode(microscope, detector_mode, delay_s=0.1)</span>
</span><span id="L-60"><a href="#L-60"><span class="linenos">  60</span></a><span class="sd">    Sets the detector mode.</span>
</span><span id="L-61"><a href="#L-61"><span class="linenos">  61</span></a>
</span><span id="L-62"><a href="#L-62"><span class="linenos">  62</span></a><span class="sd">detector_type(microscope, detector, delay_s=0.1)</span>
</span><span id="L-63"><a href="#L-63"><span class="linenos">  63</span></a><span class="sd">    Sets the detector type.</span>
</span><span id="L-64"><a href="#L-64"><span class="linenos">  64</span></a>
</span><span id="L-65"><a href="#L-65"><span class="linenos">  65</span></a><span class="sd">grab_custom_resolution_frame(img_settings, save_path)</span>
</span><span id="L-66"><a href="#L-66"><span class="linenos">  66</span></a><span class="sd">    Captures a single frame image using custom resolutions and saves it to the specified path.</span>
</span><span id="L-67"><a href="#L-67"><span class="linenos">  67</span></a>
</span><span id="L-68"><a href="#L-68"><span class="linenos">  68</span></a><span class="sd">grab_preset_resolution_frame(img_settings)</span>
</span><span id="L-69"><a href="#L-69"><span class="linenos">  69</span></a><span class="sd">    Captures a single frame image using preset resolutions.</span>
</span><span id="L-70"><a href="#L-70"><span class="linenos">  70</span></a>
</span><span id="L-71"><a href="#L-71"><span class="linenos">  71</span></a><span class="sd">image_operation(step, image_settings, general_settings, slice_number)</span>
</span><span id="L-72"><a href="#L-72"><span class="linenos">  72</span></a><span class="sd">    Performs an image operation based on the specified settings.</span>
</span><span id="L-73"><a href="#L-73"><span class="linenos">  73</span></a>
</span><span id="L-74"><a href="#L-74"><span class="linenos">  74</span></a><span class="sd">imaging_detector(img_settings)</span>
</span><span id="L-75"><a href="#L-75"><span class="linenos">  75</span></a><span class="sd">    Prepares the detector and inserts it if applicable.</span>
</span><span id="L-76"><a href="#L-76"><span class="linenos">  76</span></a>
</span><span id="L-77"><a href="#L-77"><span class="linenos">  77</span></a><span class="sd">imaging_device(microscope, beam)</span>
</span><span id="L-78"><a href="#L-78"><span class="linenos">  78</span></a><span class="sd">    Prepares the imaging beam, viewing quad, and the beam voltage and current.</span>
</span><span id="L-79"><a href="#L-79"><span class="linenos">  79</span></a>
</span><span id="L-80"><a href="#L-80"><span class="linenos">  80</span></a><span class="sd">imaging_scan(img_settings)</span>
</span><span id="L-81"><a href="#L-81"><span class="linenos">  81</span></a><span class="sd">    Sets all scan settings except for the resolution.</span>
</span><span id="L-82"><a href="#L-82"><span class="linenos">  82</span></a>
</span><span id="L-83"><a href="#L-83"><span class="linenos">  83</span></a><span class="sd">prepare_imaging(img_settings)</span>
</span><span id="L-84"><a href="#L-84"><span class="linenos">  84</span></a><span class="sd">    Prepares various imaging settings.</span>
</span><span id="L-85"><a href="#L-85"><span class="linenos">  85</span></a>
</span><span id="L-86"><a href="#L-86"><span class="linenos">  86</span></a><span class="sd">set_beam_device(microscope, device, delay_s=0.1)</span>
</span><span id="L-87"><a href="#L-87"><span class="linenos">  87</span></a><span class="sd">    Sets the active imaging device.</span>
</span><span id="L-88"><a href="#L-88"><span class="linenos">  88</span></a>
</span><span id="L-89"><a href="#L-89"><span class="linenos">  89</span></a><span class="sd">set_view(microscope, quad)</span>
</span><span id="L-90"><a href="#L-90"><span class="linenos">  90</span></a><span class="sd">    Sets the active view to the specified quad.</span>
</span><span id="L-91"><a href="#L-91"><span class="linenos">  91</span></a>
</span><span id="L-92"><a href="#L-92"><span class="linenos">  92</span></a><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-93"><a href="#L-93"><span class="linenos">  93</span></a>
</span><span id="L-94"><a href="#L-94"><span class="linenos">  94</span></a><span class="c1"># Default python modules</span>
</span><span id="L-95"><a href="#L-95"><span class="linenos">  95</span></a><span class="c1"># from functools import singledispatch</span>
</span><span id="L-96"><a href="#L-96"><span class="linenos">  96</span></a><span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
</span><span id="L-97"><a href="#L-97"><span class="linenos">  97</span></a><span class="kn">import</span> <span class="nn">time</span>
</span><span id="L-98"><a href="#L-98"><span class="linenos">  98</span></a><span class="kn">import</span> <span class="nn">warnings</span>
</span><span id="L-99"><a href="#L-99"><span class="linenos">  99</span></a><span class="kn">from</span> <span class="nn">typing</span> <span class="kn">import</span> <span class="n">List</span>
</span><span id="L-100"><a href="#L-100"><span class="linenos"> 100</span></a><span class="kn">import</span> <span class="nn">math</span>
</span><span id="L-101"><a href="#L-101"><span class="linenos"> 101</span></a>
</span><span id="L-102"><a href="#L-102"><span class="linenos"> 102</span></a><span class="c1"># Local scripts</span>
</span><span id="L-103"><a href="#L-103"><span class="linenos"> 103</span></a><span class="kn">import</span> <span class="nn">pytribeam.constants</span> <span class="k">as</span> <span class="nn">cs</span>
</span><span id="L-104"><a href="#L-104"><span class="linenos"> 104</span></a><span class="kn">import</span> <span class="nn">pytribeam.insertable_devices</span> <span class="k">as</span> <span class="nn">devices</span>
</span><span id="L-105"><a href="#L-105"><span class="linenos"> 105</span></a><span class="kn">import</span> <span class="nn">pytribeam.types</span> <span class="k">as</span> <span class="nn">tbt</span>
</span><span id="L-106"><a href="#L-106"><span class="linenos"> 106</span></a><span class="kn">import</span> <span class="nn">pytribeam.utilities</span> <span class="k">as</span> <span class="nn">ut</span>
</span><span id="L-107"><a href="#L-107"><span class="linenos"> 107</span></a>
</span><span id="L-108"><a href="#L-108"><span class="linenos"> 108</span></a>
</span><span id="L-109"><a href="#L-109"><span class="linenos"> 109</span></a><span class="k">def</span> <span class="nf">beam_angular_correction</span><span class="p">(</span>
</span><span id="L-110"><a href="#L-110"><span class="linenos"> 110</span></a>    <span class="n">microscope</span><span class="p">:</span> <span class="n">tbt</span><span class="o">.</span><span class="n">Microscope</span><span class="p">,</span>
</span><span id="L-111"><a href="#L-111"><span class="linenos"> 111</span></a>    <span class="n">dynamic_focus</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
</span><span id="L-112"><a href="#L-112"><span class="linenos"> 112</span></a>    <span class="n">tilt_correction</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
</span><span id="L-113"><a href="#L-113"><span class="linenos"> 113</span></a>    <span class="c1"># correction_angle_deg: float = None,</span>
</span><span id="L-114"><a href="#L-114"><span class="linenos"> 114</span></a>    <span class="n">delay_s</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span>
</span><span id="L-115"><a href="#L-115"><span class="linenos"> 115</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-116"><a href="#L-116"><span class="linenos"> 116</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-117"><a href="#L-117"><span class="linenos"> 117</span></a><span class="sd">    Uses auto mode to set tilt correction and dynamic focus.</span>
</span><span id="L-118"><a href="#L-118"><span class="linenos"> 118</span></a>
</span><span id="L-119"><a href="#L-119"><span class="linenos"> 119</span></a><span class="sd">    This function configures the electron beam&#39;s angular correction mode to automatic,</span>
</span><span id="L-120"><a href="#L-120"><span class="linenos"> 120</span></a><span class="sd">    sets the scan rotation to zero, and enables or disables dynamic focus and tilt correction</span>
</span><span id="L-121"><a href="#L-121"><span class="linenos"> 121</span></a><span class="sd">    based on the provided parameters.</span>
</span><span id="L-122"><a href="#L-122"><span class="linenos"> 122</span></a>
</span><span id="L-123"><a href="#L-123"><span class="linenos"> 123</span></a><span class="sd">    Parameters</span>
</span><span id="L-124"><a href="#L-124"><span class="linenos"> 124</span></a><span class="sd">    ----------</span>
</span><span id="L-125"><a href="#L-125"><span class="linenos"> 125</span></a><span class="sd">    microscope : tbt.Microscope</span>
</span><span id="L-126"><a href="#L-126"><span class="linenos"> 126</span></a><span class="sd">        The microscope object to configure.</span>
</span><span id="L-127"><a href="#L-127"><span class="linenos"> 127</span></a><span class="sd">    dynamic_focus : bool</span>
</span><span id="L-128"><a href="#L-128"><span class="linenos"> 128</span></a><span class="sd">        If True, dynamic focus will be turned on. If False, dynamic focus will be turned off.</span>
</span><span id="L-129"><a href="#L-129"><span class="linenos"> 129</span></a><span class="sd">    tilt_correction : bool</span>
</span><span id="L-130"><a href="#L-130"><span class="linenos"> 130</span></a><span class="sd">        If True, tilt correction will be turned on. If False, tilt correction will be turned off.</span>
</span><span id="L-131"><a href="#L-131"><span class="linenos"> 131</span></a><span class="sd">    delay_s : float, optional</span>
</span><span id="L-132"><a href="#L-132"><span class="linenos"> 132</span></a><span class="sd">        The delay in seconds to wait after turning dynamic focus or tilt correction on or off (default is 0.5).</span>
</span><span id="L-133"><a href="#L-133"><span class="linenos"> 133</span></a>
</span><span id="L-134"><a href="#L-134"><span class="linenos"> 134</span></a><span class="sd">    Returns</span>
</span><span id="L-135"><a href="#L-135"><span class="linenos"> 135</span></a><span class="sd">    -------</span>
</span><span id="L-136"><a href="#L-136"><span class="linenos"> 136</span></a><span class="sd">    bool</span>
</span><span id="L-137"><a href="#L-137"><span class="linenos"> 137</span></a><span class="sd">        True if the configuration is successful, False otherwise.</span>
</span><span id="L-138"><a href="#L-138"><span class="linenos"> 138</span></a>
</span><span id="L-139"><a href="#L-139"><span class="linenos"> 139</span></a><span class="sd">    Raises</span>
</span><span id="L-140"><a href="#L-140"><span class="linenos"> 140</span></a><span class="sd">    ------</span>
</span><span id="L-141"><a href="#L-141"><span class="linenos"> 141</span></a><span class="sd">    SystemError</span>
</span><span id="L-142"><a href="#L-142"><span class="linenos"> 142</span></a><span class="sd">        If unable to turn dynamic focus or tilt correction on or off.</span>
</span><span id="L-143"><a href="#L-143"><span class="linenos"> 143</span></a>
</span><span id="L-144"><a href="#L-144"><span class="linenos"> 144</span></a><span class="sd">    Examples</span>
</span><span id="L-145"><a href="#L-145"><span class="linenos"> 145</span></a><span class="sd">    --------</span>
</span><span id="L-146"><a href="#L-146"><span class="linenos"> 146</span></a><span class="sd">    &gt;&gt;&gt; import pytribeam.types as tbt</span>
</span><span id="L-147"><a href="#L-147"><span class="linenos"> 147</span></a><span class="sd">    &gt;&gt;&gt; microscope = tbt.Microscope()</span>
</span><span id="L-148"><a href="#L-148"><span class="linenos"> 148</span></a><span class="sd">    &gt;&gt;&gt; microscope.connect(&quot;localhost&quot;)</span>
</span><span id="L-149"><a href="#L-149"><span class="linenos"> 149</span></a><span class="sd">    Client connecting to [localhost:7520]...</span>
</span><span id="L-150"><a href="#L-150"><span class="linenos"> 150</span></a><span class="sd">    Client connected to [localhost:7520]</span>
</span><span id="L-151"><a href="#L-151"><span class="linenos"> 151</span></a><span class="sd">    &gt;&gt;&gt; success = beam_angular_correction(microscope, dynamic_focus=True, tilt_correction=False)</span>
</span><span id="L-152"><a href="#L-152"><span class="linenos"> 152</span></a><span class="sd">    &gt;&gt;&gt; print(success)</span>
</span><span id="L-153"><a href="#L-153"><span class="linenos"> 153</span></a><span class="sd">    True</span>
</span><span id="L-154"><a href="#L-154"><span class="linenos"> 154</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-155"><a href="#L-155"><span class="linenos"> 155</span></a>    <span class="n">angular_correction</span> <span class="o">=</span> <span class="n">microscope</span><span class="o">.</span><span class="n">beams</span><span class="o">.</span><span class="n">electron_beam</span><span class="o">.</span><span class="n">angular_correction</span>
</span><span id="L-156"><a href="#L-156"><span class="linenos"> 156</span></a>    <span class="n">angular_correction</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="n">tbt</span><span class="o">.</span><span class="n">AngularCorrectionMode</span><span class="o">.</span><span class="n">AUTOMATIC</span>
</span><span id="L-157"><a href="#L-157"><span class="linenos"> 157</span></a>    <span class="c1"># scan rotation must be zero for auto mode</span>
</span><span id="L-158"><a href="#L-158"><span class="linenos"> 158</span></a>    <span class="n">microscope</span><span class="o">.</span><span class="n">beams</span><span class="o">.</span><span class="n">electron_beam</span><span class="o">.</span><span class="n">scanning</span><span class="o">.</span><span class="n">rotation</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="L-159"><a href="#L-159"><span class="linenos"> 159</span></a>
</span><span id="L-160"><a href="#L-160"><span class="linenos"> 160</span></a>    <span class="c1"># manual adjustment not implemented yet, only works at zero scan rotation</span>
</span><span id="L-161"><a href="#L-161"><span class="linenos"> 161</span></a>    <span class="c1"># if correction_angle_deg is not None:</span>
</span><span id="L-162"><a href="#L-162"><span class="linenos"> 162</span></a>    <span class="c1">#     angular_correction.mode = tbt.AngularCorrectionMode.MANUAL</span>
</span><span id="L-163"><a href="#L-163"><span class="linenos"> 163</span></a>    <span class="k">if</span> <span class="n">dynamic_focus</span><span class="p">:</span>
</span><span id="L-164"><a href="#L-164"><span class="linenos"> 164</span></a>        <span class="n">angular_correction</span><span class="o">.</span><span class="n">dynamic_focus</span><span class="o">.</span><span class="n">turn_on</span><span class="p">()</span>
</span><span id="L-165"><a href="#L-165"><span class="linenos"> 165</span></a>        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">delay_s</span><span class="p">)</span>
</span><span id="L-166"><a href="#L-166"><span class="linenos"> 166</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">angular_correction</span><span class="o">.</span><span class="n">dynamic_focus</span><span class="o">.</span><span class="n">is_on</span><span class="p">:</span>
</span><span id="L-167"><a href="#L-167"><span class="linenos"> 167</span></a>            <span class="k">raise</span> <span class="ne">SystemError</span><span class="p">(</span><span class="s2">&quot;Unable to turn dynamic focus on.&quot;</span><span class="p">)</span>
</span><span id="L-168"><a href="#L-168"><span class="linenos"> 168</span></a>    <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">dynamic_focus</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">dynamic_focus</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="L-169"><a href="#L-169"><span class="linenos"> 169</span></a>        <span class="n">angular_correction</span><span class="o">.</span><span class="n">dynamic_focus</span><span class="o">.</span><span class="n">turn_off</span><span class="p">()</span>
</span><span id="L-170"><a href="#L-170"><span class="linenos"> 170</span></a>        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">delay_s</span><span class="p">)</span>
</span><span id="L-171"><a href="#L-171"><span class="linenos"> 171</span></a>        <span class="k">if</span> <span class="n">angular_correction</span><span class="o">.</span><span class="n">dynamic_focus</span><span class="o">.</span><span class="n">is_on</span><span class="p">:</span>
</span><span id="L-172"><a href="#L-172"><span class="linenos"> 172</span></a>            <span class="k">raise</span> <span class="ne">SystemError</span><span class="p">(</span><span class="s2">&quot;Unable to turn dynamic focus off.&quot;</span><span class="p">)</span>
</span><span id="L-173"><a href="#L-173"><span class="linenos"> 173</span></a>
</span><span id="L-174"><a href="#L-174"><span class="linenos"> 174</span></a>    <span class="k">if</span> <span class="n">tilt_correction</span><span class="p">:</span>
</span><span id="L-175"><a href="#L-175"><span class="linenos"> 175</span></a>        <span class="n">angular_correction</span><span class="o">.</span><span class="n">tilt_correction</span><span class="o">.</span><span class="n">turn_on</span><span class="p">()</span>
</span><span id="L-176"><a href="#L-176"><span class="linenos"> 176</span></a>        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">delay_s</span><span class="p">)</span>
</span><span id="L-177"><a href="#L-177"><span class="linenos"> 177</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">angular_correction</span><span class="o">.</span><span class="n">tilt_correction</span><span class="o">.</span><span class="n">is_on</span><span class="p">:</span>
</span><span id="L-178"><a href="#L-178"><span class="linenos"> 178</span></a>            <span class="k">raise</span> <span class="ne">SystemError</span><span class="p">(</span><span class="s2">&quot;Unable to turn tilt correction on.&quot;</span><span class="p">)</span>
</span><span id="L-179"><a href="#L-179"><span class="linenos"> 179</span></a>    <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">tilt_correction</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">tilt_correction</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="L-180"><a href="#L-180"><span class="linenos"> 180</span></a>        <span class="n">angular_correction</span><span class="o">.</span><span class="n">tilt_correction</span><span class="o">.</span><span class="n">turn_off</span><span class="p">()</span>
</span><span id="L-181"><a href="#L-181"><span class="linenos"> 181</span></a>        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">delay_s</span><span class="p">)</span>
</span><span id="L-182"><a href="#L-182"><span class="linenos"> 182</span></a>        <span class="k">if</span> <span class="n">angular_correction</span><span class="o">.</span><span class="n">tilt_correction</span><span class="o">.</span><span class="n">is_on</span><span class="p">:</span>
</span><span id="L-183"><a href="#L-183"><span class="linenos"> 183</span></a>            <span class="k">raise</span> <span class="ne">SystemError</span><span class="p">(</span><span class="s2">&quot;Unable to turn tilt correction off.&quot;</span><span class="p">)</span>
</span><span id="L-184"><a href="#L-184"><span class="linenos"> 184</span></a>
</span><span id="L-185"><a href="#L-185"><span class="linenos"> 185</span></a>
</span><span id="L-186"><a href="#L-186"><span class="linenos"> 186</span></a><span class="k">def</span> <span class="nf">beam_current</span><span class="p">(</span>
</span><span id="L-187"><a href="#L-187"><span class="linenos"> 187</span></a>    <span class="n">beam</span><span class="p">:</span> <span class="n">tbt</span><span class="o">.</span><span class="n">Beam</span><span class="p">,</span>
</span><span id="L-188"><a href="#L-188"><span class="linenos"> 188</span></a>    <span class="n">microscope</span><span class="p">:</span> <span class="n">tbt</span><span class="o">.</span><span class="n">Microscope</span><span class="p">,</span>
</span><span id="L-189"><a href="#L-189"><span class="linenos"> 189</span></a>    <span class="n">current_na</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="L-190"><a href="#L-190"><span class="linenos"> 190</span></a>    <span class="n">current_tol_na</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="L-191"><a href="#L-191"><span class="linenos"> 191</span></a>    <span class="n">delay_s</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">5.0</span><span class="p">,</span>
</span><span id="L-192"><a href="#L-192"><span class="linenos"> 192</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-193"><a href="#L-193"><span class="linenos"> 193</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-194"><a href="#L-194"><span class="linenos"> 194</span></a><span class="sd">    Sets the current for the selected beam type, with inputs in units of nanoamps.</span>
</span><span id="L-195"><a href="#L-195"><span class="linenos"> 195</span></a>
</span><span id="L-196"><a href="#L-196"><span class="linenos"> 196</span></a><span class="sd">    This function sets the beam current for the specified beam type on the microscope.</span>
</span><span id="L-197"><a href="#L-197"><span class="linenos"> 197</span></a><span class="sd">    If the current difference exceeds the tolerance, it adjusts the beam current and</span>
</span><span id="L-198"><a href="#L-198"><span class="linenos"> 198</span></a><span class="sd">    waits for the specified delay.</span>
</span><span id="L-199"><a href="#L-199"><span class="linenos"> 199</span></a>
</span><span id="L-200"><a href="#L-200"><span class="linenos"> 200</span></a><span class="sd">    Parameters</span>
</span><span id="L-201"><a href="#L-201"><span class="linenos"> 201</span></a><span class="sd">    ----------</span>
</span><span id="L-202"><a href="#L-202"><span class="linenos"> 202</span></a><span class="sd">    beam : tbt.Beam</span>
</span><span id="L-203"><a href="#L-203"><span class="linenos"> 203</span></a><span class="sd">        The beam type to configure.</span>
</span><span id="L-204"><a href="#L-204"><span class="linenos"> 204</span></a><span class="sd">    microscope : tbt.Microscope</span>
</span><span id="L-205"><a href="#L-205"><span class="linenos"> 205</span></a><span class="sd">        The microscope object to configure.</span>
</span><span id="L-206"><a href="#L-206"><span class="linenos"> 206</span></a><span class="sd">    current_na : float</span>
</span><span id="L-207"><a href="#L-207"><span class="linenos"> 207</span></a><span class="sd">        The desired beam current in nanoamps.</span>
</span><span id="L-208"><a href="#L-208"><span class="linenos"> 208</span></a><span class="sd">    current_tol_na : float</span>
</span><span id="L-209"><a href="#L-209"><span class="linenos"> 209</span></a><span class="sd">        The tolerance for the beam current in nanoamps.</span>
</span><span id="L-210"><a href="#L-210"><span class="linenos"> 210</span></a><span class="sd">    delay_s : float, optional</span>
</span><span id="L-211"><a href="#L-211"><span class="linenos"> 211</span></a><span class="sd">        The delay in seconds to wait after adjusting the beam current (default is 5.0).</span>
</span><span id="L-212"><a href="#L-212"><span class="linenos"> 212</span></a>
</span><span id="L-213"><a href="#L-213"><span class="linenos"> 213</span></a><span class="sd">    Returns</span>
</span><span id="L-214"><a href="#L-214"><span class="linenos"> 214</span></a><span class="sd">    -------</span>
</span><span id="L-215"><a href="#L-215"><span class="linenos"> 215</span></a><span class="sd">    bool</span>
</span><span id="L-216"><a href="#L-216"><span class="linenos"> 216</span></a><span class="sd">        True if the beam current is set successfully, False otherwise.</span>
</span><span id="L-217"><a href="#L-217"><span class="linenos"> 217</span></a>
</span><span id="L-218"><a href="#L-218"><span class="linenos"> 218</span></a><span class="sd">    Raises</span>
</span><span id="L-219"><a href="#L-219"><span class="linenos"> 219</span></a><span class="sd">    ------</span>
</span><span id="L-220"><a href="#L-220"><span class="linenos"> 220</span></a><span class="sd">    ValueError</span>
</span><span id="L-221"><a href="#L-221"><span class="linenos"> 221</span></a><span class="sd">        If the beam current cannot be adjusted within the specified tolerance.</span>
</span><span id="L-222"><a href="#L-222"><span class="linenos"> 222</span></a>
</span><span id="L-223"><a href="#L-223"><span class="linenos"> 223</span></a><span class="sd">    Examples</span>
</span><span id="L-224"><a href="#L-224"><span class="linenos"> 224</span></a><span class="sd">    --------</span>
</span><span id="L-225"><a href="#L-225"><span class="linenos"> 225</span></a><span class="sd">    &gt;&gt;&gt; import pytribeam.types as tbt</span>
</span><span id="L-226"><a href="#L-226"><span class="linenos"> 226</span></a><span class="sd">    &gt;&gt;&gt; microscope = tbt.Microscope()</span>
</span><span id="L-227"><a href="#L-227"><span class="linenos"> 227</span></a><span class="sd">    &gt;&gt;&gt; microscope.connect(&quot;localhost&quot;)</span>
</span><span id="L-228"><a href="#L-228"><span class="linenos"> 228</span></a><span class="sd">    Client connecting to [localhost:7520]...</span>
</span><span id="L-229"><a href="#L-229"><span class="linenos"> 229</span></a><span class="sd">    Client connected to [localhost:7520]</span>
</span><span id="L-230"><a href="#L-230"><span class="linenos"> 230</span></a><span class="sd">    &gt;&gt;&gt; beam = tbt.ElectronBeam(settings=None)</span>
</span><span id="L-231"><a href="#L-231"><span class="linenos"> 231</span></a><span class="sd">    &gt;&gt;&gt; success = beam_current(beam, microscope, current_na=1.0, current_tol_na=0.1)</span>
</span><span id="L-232"><a href="#L-232"><span class="linenos"> 232</span></a><span class="sd">    &gt;&gt;&gt; print(success)</span>
</span><span id="L-233"><a href="#L-233"><span class="linenos"> 233</span></a><span class="sd">    True</span>
</span><span id="L-234"><a href="#L-234"><span class="linenos"> 234</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-235"><a href="#L-235"><span class="linenos"> 235</span></a>    <span class="n">selected_beam</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">beam_type</span><span class="p">(</span><span class="n">beam</span><span class="p">,</span> <span class="n">microscope</span><span class="p">)</span>
</span><span id="L-236"><a href="#L-236"><span class="linenos"> 236</span></a>
</span><span id="L-237"><a href="#L-237"><span class="linenos"> 237</span></a>    <span class="n">exisiting_current_a</span> <span class="o">=</span> <span class="n">selected_beam</span><span class="o">.</span><span class="n">beam_current</span><span class="o">.</span><span class="n">value</span>  <span class="c1"># amps</span>
</span><span id="L-238"><a href="#L-238"><span class="linenos"> 238</span></a>    <span class="n">delta_current_na</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span>
</span><span id="L-239"><a href="#L-239"><span class="linenos"> 239</span></a>        <span class="n">exisiting_current_a</span> <span class="o">*</span> <span class="n">cs</span><span class="o">.</span><span class="n">Conversions</span><span class="o">.</span><span class="n">A_TO_NA</span> <span class="o">-</span> <span class="n">current_na</span>
</span><span id="L-240"><a href="#L-240"><span class="linenos"> 240</span></a>    <span class="p">)</span>  <span class="c1"># nanoamps</span>
</span><span id="L-241"><a href="#L-241"><span class="linenos"> 241</span></a>    <span class="k">if</span> <span class="n">delta_current_na</span> <span class="o">&gt;</span> <span class="n">current_tol_na</span><span class="p">:</span>
</span><span id="L-242"><a href="#L-242"><span class="linenos"> 242</span></a>        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
</span><span id="L-243"><a href="#L-243"><span class="linenos"> 243</span></a>            <span class="s2">&quot;Requested beam current is not the current setting, imaging conditions may be non-ideal.&quot;</span>
</span><span id="L-244"><a href="#L-244"><span class="linenos"> 244</span></a>        <span class="p">)</span>
</span><span id="L-245"><a href="#L-245"><span class="linenos"> 245</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Adjusting beam current...&quot;</span><span class="p">)</span>
</span><span id="L-246"><a href="#L-246"><span class="linenos"> 246</span></a>        <span class="n">selected_beam</span><span class="o">.</span><span class="n">beam_current</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">current_na</span> <span class="o">*</span> <span class="n">cs</span><span class="o">.</span><span class="n">Conversions</span><span class="o">.</span><span class="n">NA_TO_A</span>
</span><span id="L-247"><a href="#L-247"><span class="linenos"> 247</span></a>        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">delay_s</span><span class="p">)</span>
</span><span id="L-248"><a href="#L-248"><span class="linenos"> 248</span></a>
</span><span id="L-249"><a href="#L-249"><span class="linenos"> 249</span></a>        <span class="n">new_current_na</span> <span class="o">=</span> <span class="n">selected_beam</span><span class="o">.</span><span class="n">beam_current</span><span class="o">.</span><span class="n">value</span> <span class="o">*</span> <span class="n">cs</span><span class="o">.</span><span class="n">Conversions</span><span class="o">.</span><span class="n">A_TO_NA</span>
</span><span id="L-250"><a href="#L-250"><span class="linenos"> 250</span></a>        <span class="n">current_diff_na</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">new_current_na</span> <span class="o">-</span> <span class="n">current_na</span><span class="p">)</span>
</span><span id="L-251"><a href="#L-251"><span class="linenos"> 251</span></a>        <span class="k">if</span> <span class="n">current_diff_na</span> <span class="o">&gt;</span> <span class="n">current_tol_na</span><span class="p">:</span>
</span><span id="L-252"><a href="#L-252"><span class="linenos"> 252</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="L-253"><a href="#L-253"><span class="linenos"> 253</span></a>                <span class="sa">f</span><span class="s2">&quot;&quot;&quot;Could not correctly adjust beam voltage,</span>
</span><span id="L-254"><a href="#L-254"><span class="linenos"> 254</span></a><span class="s2">                requested </span><span class="si">{</span><span class="n">current_na</span><span class="si">}</span><span class="s2"> nA, current beam current is</span>
</span><span id="L-255"><a href="#L-255"><span class="linenos"> 255</span></a><span class="s2">                </span><span class="si">{</span><span class="n">new_current_na</span><span class="si">}</span><span class="s2"> nA&quot;&quot;&quot;</span>
</span><span id="L-256"><a href="#L-256"><span class="linenos"> 256</span></a>            <span class="p">)</span>
</span><span id="L-257"><a href="#L-257"><span class="linenos"> 257</span></a>
</span><span id="L-258"><a href="#L-258"><span class="linenos"> 258</span></a>    <span class="k">return</span> <span class="kc">True</span>
</span><span id="L-259"><a href="#L-259"><span class="linenos"> 259</span></a>
</span><span id="L-260"><a href="#L-260"><span class="linenos"> 260</span></a>
</span><span id="L-261"><a href="#L-261"><span class="linenos"> 261</span></a><span class="k">def</span> <span class="nf">beam_dwell_time</span><span class="p">(</span>
</span><span id="L-262"><a href="#L-262"><span class="linenos"> 262</span></a>    <span class="n">beam</span><span class="p">:</span> <span class="n">tbt</span><span class="o">.</span><span class="n">Beam</span><span class="p">,</span>
</span><span id="L-263"><a href="#L-263"><span class="linenos"> 263</span></a>    <span class="n">microscope</span><span class="p">:</span> <span class="n">tbt</span><span class="o">.</span><span class="n">Microscope</span><span class="p">,</span>
</span><span id="L-264"><a href="#L-264"><span class="linenos"> 264</span></a>    <span class="n">dwell_us</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="L-265"><a href="#L-265"><span class="linenos"> 265</span></a>    <span class="n">delay_s</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span>
</span><span id="L-266"><a href="#L-266"><span class="linenos"> 266</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-267"><a href="#L-267"><span class="linenos"> 267</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-268"><a href="#L-268"><span class="linenos"> 268</span></a><span class="sd">    Sets the dwell time for the selected beam, with inputs in units of microseconds.</span>
</span><span id="L-269"><a href="#L-269"><span class="linenos"> 269</span></a>
</span><span id="L-270"><a href="#L-270"><span class="linenos"> 270</span></a><span class="sd">    This function sets the dwell time for the specified beam type on the microscope.</span>
</span><span id="L-271"><a href="#L-271"><span class="linenos"> 271</span></a><span class="sd">    It converts the dwell time from microseconds to seconds, sets the dwell time, and</span>
</span><span id="L-272"><a href="#L-272"><span class="linenos"> 272</span></a><span class="sd">    waits for the specified delay.</span>
</span><span id="L-273"><a href="#L-273"><span class="linenos"> 273</span></a>
</span><span id="L-274"><a href="#L-274"><span class="linenos"> 274</span></a><span class="sd">    Parameters</span>
</span><span id="L-275"><a href="#L-275"><span class="linenos"> 275</span></a><span class="sd">    ----------</span>
</span><span id="L-276"><a href="#L-276"><span class="linenos"> 276</span></a><span class="sd">    beam : tbt.Beam</span>
</span><span id="L-277"><a href="#L-277"><span class="linenos"> 277</span></a><span class="sd">        The beam type to configure.</span>
</span><span id="L-278"><a href="#L-278"><span class="linenos"> 278</span></a><span class="sd">    microscope : tbt.Microscope</span>
</span><span id="L-279"><a href="#L-279"><span class="linenos"> 279</span></a><span class="sd">        The microscope object to configure.</span>
</span><span id="L-280"><a href="#L-280"><span class="linenos"> 280</span></a><span class="sd">    dwell_us : float</span>
</span><span id="L-281"><a href="#L-281"><span class="linenos"> 281</span></a><span class="sd">        The desired dwell time in microseconds.</span>
</span><span id="L-282"><a href="#L-282"><span class="linenos"> 282</span></a><span class="sd">    delay_s : float, optional</span>
</span><span id="L-283"><a href="#L-283"><span class="linenos"> 283</span></a><span class="sd">        The delay in seconds to wait after adjusting the dwell time (default is 0.1).</span>
</span><span id="L-284"><a href="#L-284"><span class="linenos"> 284</span></a>
</span><span id="L-285"><a href="#L-285"><span class="linenos"> 285</span></a><span class="sd">    Returns</span>
</span><span id="L-286"><a href="#L-286"><span class="linenos"> 286</span></a><span class="sd">    -------</span>
</span><span id="L-287"><a href="#L-287"><span class="linenos"> 287</span></a><span class="sd">    bool</span>
</span><span id="L-288"><a href="#L-288"><span class="linenos"> 288</span></a><span class="sd">        True if the dwell time is set successfully, False otherwise.</span>
</span><span id="L-289"><a href="#L-289"><span class="linenos"> 289</span></a>
</span><span id="L-290"><a href="#L-290"><span class="linenos"> 290</span></a><span class="sd">    Raises</span>
</span><span id="L-291"><a href="#L-291"><span class="linenos"> 291</span></a><span class="sd">    ------</span>
</span><span id="L-292"><a href="#L-292"><span class="linenos"> 292</span></a><span class="sd">    ValueError</span>
</span><span id="L-293"><a href="#L-293"><span class="linenos"> 293</span></a><span class="sd">        If the dwell time cannot be adjusted correctly.</span>
</span><span id="L-294"><a href="#L-294"><span class="linenos"> 294</span></a>
</span><span id="L-295"><a href="#L-295"><span class="linenos"> 295</span></a><span class="sd">    Examples</span>
</span><span id="L-296"><a href="#L-296"><span class="linenos"> 296</span></a><span class="sd">    --------</span>
</span><span id="L-297"><a href="#L-297"><span class="linenos"> 297</span></a><span class="sd">    &gt;&gt;&gt; import pytribeam.types as tbt</span>
</span><span id="L-298"><a href="#L-298"><span class="linenos"> 298</span></a><span class="sd">    &gt;&gt;&gt; microscope = tbt.Microscope()</span>
</span><span id="L-299"><a href="#L-299"><span class="linenos"> 299</span></a><span class="sd">    &gt;&gt;&gt; microscope.connect(&quot;localhost&quot;)</span>
</span><span id="L-300"><a href="#L-300"><span class="linenos"> 300</span></a><span class="sd">    Client connecting to [localhost:7520]...</span>
</span><span id="L-301"><a href="#L-301"><span class="linenos"> 301</span></a><span class="sd">    Client connected to [localhost:7520]</span>
</span><span id="L-302"><a href="#L-302"><span class="linenos"> 302</span></a><span class="sd">    &gt;&gt;&gt; beam = tbt.ElectronBeam(settings=None)</span>
</span><span id="L-303"><a href="#L-303"><span class="linenos"> 303</span></a><span class="sd">    &gt;&gt;&gt; success = beam_dwell_time(beam, microscope, dwell_us=10.0)</span>
</span><span id="L-304"><a href="#L-304"><span class="linenos"> 304</span></a><span class="sd">    &gt;&gt;&gt; print(success)</span>
</span><span id="L-305"><a href="#L-305"><span class="linenos"> 305</span></a><span class="sd">    True</span>
</span><span id="L-306"><a href="#L-306"><span class="linenos"> 306</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-307"><a href="#L-307"><span class="linenos"> 307</span></a>    <span class="n">selected_beam</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">beam_type</span><span class="p">(</span><span class="n">beam</span><span class="p">,</span> <span class="n">microscope</span><span class="p">)</span>
</span><span id="L-308"><a href="#L-308"><span class="linenos"> 308</span></a>    <span class="n">dwell_s</span> <span class="o">=</span> <span class="n">dwell_us</span> <span class="o">*</span> <span class="n">cs</span><span class="o">.</span><span class="n">Conversions</span><span class="o">.</span><span class="n">US_TO_S</span>
</span><span id="L-309"><a href="#L-309"><span class="linenos"> 309</span></a>    <span class="n">selected_beam</span><span class="o">.</span><span class="n">scanning</span><span class="o">.</span><span class="n">dwell_time</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">dwell_s</span>
</span><span id="L-310"><a href="#L-310"><span class="linenos"> 310</span></a>    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">delay_s</span><span class="p">)</span>
</span><span id="L-311"><a href="#L-311"><span class="linenos"> 311</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">math</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span>
</span><span id="L-312"><a href="#L-312"><span class="linenos"> 312</span></a>        <span class="n">selected_beam</span><span class="o">.</span><span class="n">scanning</span><span class="o">.</span><span class="n">dwell_time</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
</span><span id="L-313"><a href="#L-313"><span class="linenos"> 313</span></a>        <span class="n">dwell_s</span><span class="p">,</span>
</span><span id="L-314"><a href="#L-314"><span class="linenos"> 314</span></a>        <span class="n">rel_tol</span><span class="o">=</span><span class="n">cs</span><span class="o">.</span><span class="n">Constants</span><span class="o">.</span><span class="n">beam_dwell_tol_ratio</span><span class="p">,</span>
</span><span id="L-315"><a href="#L-315"><span class="linenos"> 315</span></a>    <span class="p">):</span>
</span><span id="L-316"><a href="#L-316"><span class="linenos"> 316</span></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="L-317"><a href="#L-317"><span class="linenos"> 317</span></a>            <span class="sa">f</span><span class="s2">&quot;&quot;&quot;Could not correctly adjust dwell time,</span>
</span><span id="L-318"><a href="#L-318"><span class="linenos"> 318</span></a><span class="s2">            requested </span><span class="si">{</span><span class="n">dwell_s</span><span class="si">}</span><span class="s2"> seconds, current dwell time is</span>
</span><span id="L-319"><a href="#L-319"><span class="linenos"> 319</span></a><span class="s2">            </span><span class="si">{</span><span class="n">selected_beam</span><span class="o">.</span><span class="n">scanning</span><span class="o">.</span><span class="n">dwell_time</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2"> seconds&quot;&quot;&quot;</span>
</span><span id="L-320"><a href="#L-320"><span class="linenos"> 320</span></a>        <span class="p">)</span>
</span><span id="L-321"><a href="#L-321"><span class="linenos"> 321</span></a>
</span><span id="L-322"><a href="#L-322"><span class="linenos"> 322</span></a>    <span class="k">return</span> <span class="kc">True</span>
</span><span id="L-323"><a href="#L-323"><span class="linenos"> 323</span></a>
</span><span id="L-324"><a href="#L-324"><span class="linenos"> 324</span></a>
</span><span id="L-325"><a href="#L-325"><span class="linenos"> 325</span></a><span class="k">def</span> <span class="nf">beam_hfw</span><span class="p">(</span>
</span><span id="L-326"><a href="#L-326"><span class="linenos"> 326</span></a>    <span class="n">beam</span><span class="p">:</span> <span class="n">tbt</span><span class="o">.</span><span class="n">Beam</span><span class="p">,</span>
</span><span id="L-327"><a href="#L-327"><span class="linenos"> 327</span></a>    <span class="n">microscope</span><span class="p">:</span> <span class="n">tbt</span><span class="o">.</span><span class="n">Microscope</span><span class="p">,</span>
</span><span id="L-328"><a href="#L-328"><span class="linenos"> 328</span></a>    <span class="n">hfw_mm</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="L-329"><a href="#L-329"><span class="linenos"> 329</span></a>    <span class="n">delay_s</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span>
</span><span id="L-330"><a href="#L-330"><span class="linenos"> 330</span></a>    <span class="n">hfw_tol_mm</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-6</span><span class="p">,</span>  <span class="c1"># 1 nm of tolerance</span>
</span><span id="L-331"><a href="#L-331"><span class="linenos"> 331</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-332"><a href="#L-332"><span class="linenos"> 332</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-333"><a href="#L-333"><span class="linenos"> 333</span></a><span class="sd">    Sets the horizontal field width for the selected beam, with inputs in units of millimeters.</span>
</span><span id="L-334"><a href="#L-334"><span class="linenos"> 334</span></a>
</span><span id="L-335"><a href="#L-335"><span class="linenos"> 335</span></a><span class="sd">    This function sets the horizontal field width (HFW) for the specified beam type on the microscope.</span>
</span><span id="L-336"><a href="#L-336"><span class="linenos"> 336</span></a><span class="sd">    It converts the HFW from millimeters to meters, sets the HFW, and waits for the specified delay.</span>
</span><span id="L-337"><a href="#L-337"><span class="linenos"> 337</span></a><span class="sd">    This should be done after adjusting the working distance.</span>
</span><span id="L-338"><a href="#L-338"><span class="linenos"> 338</span></a>
</span><span id="L-339"><a href="#L-339"><span class="linenos"> 339</span></a><span class="sd">    Parameters</span>
</span><span id="L-340"><a href="#L-340"><span class="linenos"> 340</span></a><span class="sd">    ----------</span>
</span><span id="L-341"><a href="#L-341"><span class="linenos"> 341</span></a><span class="sd">    beam : tbt.Beam</span>
</span><span id="L-342"><a href="#L-342"><span class="linenos"> 342</span></a><span class="sd">        The beam type to configure.</span>
</span><span id="L-343"><a href="#L-343"><span class="linenos"> 343</span></a><span class="sd">    microscope : tbt.Microscope</span>
</span><span id="L-344"><a href="#L-344"><span class="linenos"> 344</span></a><span class="sd">        The microscope object to configure.</span>
</span><span id="L-345"><a href="#L-345"><span class="linenos"> 345</span></a><span class="sd">    hfw_mm : float</span>
</span><span id="L-346"><a href="#L-346"><span class="linenos"> 346</span></a><span class="sd">        The desired horizontal field width in millimeters.</span>
</span><span id="L-347"><a href="#L-347"><span class="linenos"> 347</span></a><span class="sd">    delay_s : float, optional</span>
</span><span id="L-348"><a href="#L-348"><span class="linenos"> 348</span></a><span class="sd">        The delay in seconds to wait after adjusting the HFW (default is 0.1).</span>
</span><span id="L-349"><a href="#L-349"><span class="linenos"> 349</span></a>
</span><span id="L-350"><a href="#L-350"><span class="linenos"> 350</span></a><span class="sd">    Returns</span>
</span><span id="L-351"><a href="#L-351"><span class="linenos"> 351</span></a><span class="sd">    -------</span>
</span><span id="L-352"><a href="#L-352"><span class="linenos"> 352</span></a><span class="sd">    bool</span>
</span><span id="L-353"><a href="#L-353"><span class="linenos"> 353</span></a><span class="sd">        True if the HFW is set successfully, False otherwise.</span>
</span><span id="L-354"><a href="#L-354"><span class="linenos"> 354</span></a>
</span><span id="L-355"><a href="#L-355"><span class="linenos"> 355</span></a><span class="sd">    Raises</span>
</span><span id="L-356"><a href="#L-356"><span class="linenos"> 356</span></a><span class="sd">    ------</span>
</span><span id="L-357"><a href="#L-357"><span class="linenos"> 357</span></a><span class="sd">    ValueError</span>
</span><span id="L-358"><a href="#L-358"><span class="linenos"> 358</span></a><span class="sd">        If the HFW cannot be adjusted correctly.</span>
</span><span id="L-359"><a href="#L-359"><span class="linenos"> 359</span></a>
</span><span id="L-360"><a href="#L-360"><span class="linenos"> 360</span></a><span class="sd">    Examples</span>
</span><span id="L-361"><a href="#L-361"><span class="linenos"> 361</span></a><span class="sd">    --------</span>
</span><span id="L-362"><a href="#L-362"><span class="linenos"> 362</span></a><span class="sd">    &gt;&gt;&gt; import pytribeam.types as tbt</span>
</span><span id="L-363"><a href="#L-363"><span class="linenos"> 363</span></a><span class="sd">    &gt;&gt;&gt; microscope = tbt.Microscope()</span>
</span><span id="L-364"><a href="#L-364"><span class="linenos"> 364</span></a><span class="sd">    &gt;&gt;&gt; microscope.connect(&quot;localhost&quot;)</span>
</span><span id="L-365"><a href="#L-365"><span class="linenos"> 365</span></a><span class="sd">    Client connecting to [localhost:7520]...</span>
</span><span id="L-366"><a href="#L-366"><span class="linenos"> 366</span></a><span class="sd">    Client connected to [localhost:7520]</span>
</span><span id="L-367"><a href="#L-367"><span class="linenos"> 367</span></a><span class="sd">    &gt;&gt;&gt; beam = tbt.ElectronBeam(settings=None)</span>
</span><span id="L-368"><a href="#L-368"><span class="linenos"> 368</span></a><span class="sd">    &gt;&gt;&gt; success = beam_hfw(beam, microscope, hfw_mm=1.0)</span>
</span><span id="L-369"><a href="#L-369"><span class="linenos"> 369</span></a><span class="sd">    &gt;&gt;&gt; print(success)</span>
</span><span id="L-370"><a href="#L-370"><span class="linenos"> 370</span></a><span class="sd">    True</span>
</span><span id="L-371"><a href="#L-371"><span class="linenos"> 371</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-372"><a href="#L-372"><span class="linenos"> 372</span></a>    <span class="n">selected_beam</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">beam_type</span><span class="p">(</span><span class="n">beam</span><span class="p">,</span> <span class="n">microscope</span><span class="p">)</span>
</span><span id="L-373"><a href="#L-373"><span class="linenos"> 373</span></a>    <span class="n">hfw_m</span> <span class="o">=</span> <span class="n">hfw_mm</span> <span class="o">*</span> <span class="n">cs</span><span class="o">.</span><span class="n">Conversions</span><span class="o">.</span><span class="n">MM_TO_M</span>
</span><span id="L-374"><a href="#L-374"><span class="linenos"> 374</span></a>    <span class="n">selected_beam</span><span class="o">.</span><span class="n">horizontal_field_width</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">hfw_m</span>
</span><span id="L-375"><a href="#L-375"><span class="linenos"> 375</span></a>    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">delay_s</span><span class="p">)</span>
</span><span id="L-376"><a href="#L-376"><span class="linenos"> 376</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">math</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span>
</span><span id="L-377"><a href="#L-377"><span class="linenos"> 377</span></a>        <span class="n">selected_beam</span><span class="o">.</span><span class="n">horizontal_field_width</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
</span><span id="L-378"><a href="#L-378"><span class="linenos"> 378</span></a>        <span class="n">hfw_m</span><span class="p">,</span>
</span><span id="L-379"><a href="#L-379"><span class="linenos"> 379</span></a>        <span class="n">abs_tol</span><span class="o">=</span><span class="n">hfw_tol_mm</span>
</span><span id="L-380"><a href="#L-380"><span class="linenos"> 380</span></a>        <span class="o">*</span> <span class="n">cs</span><span class="o">.</span><span class="n">Conversions</span><span class="o">.</span><span class="n">MM_TO_M</span><span class="p">,</span>  <span class="c1"># convert to meters for autoscript calls</span>
</span><span id="L-381"><a href="#L-381"><span class="linenos"> 381</span></a>    <span class="p">):</span>
</span><span id="L-382"><a href="#L-382"><span class="linenos"> 382</span></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="L-383"><a href="#L-383"><span class="linenos"> 383</span></a>            <span class="sa">f</span><span class="s2">&quot;&quot;&quot;Could not correctly adjust horizontal field width,</span>
</span><span id="L-384"><a href="#L-384"><span class="linenos"> 384</span></a><span class="s2">            requested </span><span class="si">{</span><span class="n">hfw_mm</span><span class="si">}</span><span class="s2"> millimeters, current field with is</span>
</span><span id="L-385"><a href="#L-385"><span class="linenos"> 385</span></a><span class="s2">            </span><span class="si">{</span><span class="n">selected_beam</span><span class="o">.</span><span class="n">horizontal_field_width</span><span class="o">.</span><span class="n">value</span><span class="o">*</span><span class="n">cs</span><span class="o">.</span><span class="n">Conversions</span><span class="o">.</span><span class="n">M_TO_MM</span><span class="si">}</span><span class="s2"> millimeters&quot;&quot;&quot;</span>
</span><span id="L-386"><a href="#L-386"><span class="linenos"> 386</span></a>        <span class="p">)</span>
</span><span id="L-387"><a href="#L-387"><span class="linenos"> 387</span></a>
</span><span id="L-388"><a href="#L-388"><span class="linenos"> 388</span></a>    <span class="k">return</span> <span class="kc">True</span>
</span><span id="L-389"><a href="#L-389"><span class="linenos"> 389</span></a>
</span><span id="L-390"><a href="#L-390"><span class="linenos"> 390</span></a>
</span><span id="L-391"><a href="#L-391"><span class="linenos"> 391</span></a><span class="k">def</span> <span class="nf">beam_ready</span><span class="p">(</span>
</span><span id="L-392"><a href="#L-392"><span class="linenos"> 392</span></a>    <span class="n">beam</span><span class="p">:</span> <span class="n">tbt</span><span class="o">.</span><span class="n">Beam</span><span class="p">,</span>
</span><span id="L-393"><a href="#L-393"><span class="linenos"> 393</span></a>    <span class="n">microscope</span><span class="p">:</span> <span class="n">tbt</span><span class="o">.</span><span class="n">Microscope</span><span class="p">,</span>
</span><span id="L-394"><a href="#L-394"><span class="linenos"> 394</span></a>    <span class="n">delay_s</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">5.0</span><span class="p">,</span>
</span><span id="L-395"><a href="#L-395"><span class="linenos"> 395</span></a>    <span class="n">attempts</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
</span><span id="L-396"><a href="#L-396"><span class="linenos"> 396</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-397"><a href="#L-397"><span class="linenos"> 397</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-398"><a href="#L-398"><span class="linenos"> 398</span></a><span class="sd">    Checks if the beam is on or blanked, and tries to turn it on and unblank it if possible.</span>
</span><span id="L-399"><a href="#L-399"><span class="linenos"> 399</span></a>
</span><span id="L-400"><a href="#L-400"><span class="linenos"> 400</span></a><span class="sd">    This function checks the vacuum state, ensures the beam is on, and unblanks the beam if it is blanked.</span>
</span><span id="L-401"><a href="#L-401"><span class="linenos"> 401</span></a><span class="sd">    It makes multiple attempts to turn on and unblank the beam, waiting for the specified delay between attempts.</span>
</span><span id="L-402"><a href="#L-402"><span class="linenos"> 402</span></a>
</span><span id="L-403"><a href="#L-403"><span class="linenos"> 403</span></a><span class="sd">    Parameters</span>
</span><span id="L-404"><a href="#L-404"><span class="linenos"> 404</span></a><span class="sd">    ----------</span>
</span><span id="L-405"><a href="#L-405"><span class="linenos"> 405</span></a><span class="sd">    beam : tbt.Beam</span>
</span><span id="L-406"><a href="#L-406"><span class="linenos"> 406</span></a><span class="sd">        The beam type to check.</span>
</span><span id="L-407"><a href="#L-407"><span class="linenos"> 407</span></a><span class="sd">    microscope : tbt.Microscope</span>
</span><span id="L-408"><a href="#L-408"><span class="linenos"> 408</span></a><span class="sd">        The microscope object to check.</span>
</span><span id="L-409"><a href="#L-409"><span class="linenos"> 409</span></a><span class="sd">    delay_s : float, optional</span>
</span><span id="L-410"><a href="#L-410"><span class="linenos"> 410</span></a><span class="sd">        The delay in seconds to wait between attempts (default is 5.0).</span>
</span><span id="L-411"><a href="#L-411"><span class="linenos"> 411</span></a><span class="sd">    attempts : int, optional</span>
</span><span id="L-412"><a href="#L-412"><span class="linenos"> 412</span></a><span class="sd">        The number of attempts to turn on and unblank the beam (default is 2).</span>
</span><span id="L-413"><a href="#L-413"><span class="linenos"> 413</span></a>
</span><span id="L-414"><a href="#L-414"><span class="linenos"> 414</span></a><span class="sd">    Returns</span>
</span><span id="L-415"><a href="#L-415"><span class="linenos"> 415</span></a><span class="sd">    -------</span>
</span><span id="L-416"><a href="#L-416"><span class="linenos"> 416</span></a><span class="sd">    bool</span>
</span><span id="L-417"><a href="#L-417"><span class="linenos"> 417</span></a><span class="sd">        True if the beam is ready (on and unblanked), False otherwise.</span>
</span><span id="L-418"><a href="#L-418"><span class="linenos"> 418</span></a>
</span><span id="L-419"><a href="#L-419"><span class="linenos"> 419</span></a><span class="sd">    Raises</span>
</span><span id="L-420"><a href="#L-420"><span class="linenos"> 420</span></a><span class="sd">    ------</span>
</span><span id="L-421"><a href="#L-421"><span class="linenos"> 421</span></a><span class="sd">    ValueError</span>
</span><span id="L-422"><a href="#L-422"><span class="linenos"> 422</span></a><span class="sd">        If the vacuum is not pumped.</span>
</span><span id="L-423"><a href="#L-423"><span class="linenos"> 423</span></a><span class="sd">        If the beam cannot be turned on after the specified number of attempts.</span>
</span><span id="L-424"><a href="#L-424"><span class="linenos"> 424</span></a><span class="sd">        If the beam cannot be unblanked after the specified number of attempts.</span>
</span><span id="L-425"><a href="#L-425"><span class="linenos"> 425</span></a>
</span><span id="L-426"><a href="#L-426"><span class="linenos"> 426</span></a><span class="sd">    Examples</span>
</span><span id="L-427"><a href="#L-427"><span class="linenos"> 427</span></a><span class="sd">    --------</span>
</span><span id="L-428"><a href="#L-428"><span class="linenos"> 428</span></a><span class="sd">    &gt;&gt;&gt; import pytribeam.types as tbt</span>
</span><span id="L-429"><a href="#L-429"><span class="linenos"> 429</span></a><span class="sd">    &gt;&gt;&gt; microscope = tbt.Microscope()</span>
</span><span id="L-430"><a href="#L-430"><span class="linenos"> 430</span></a><span class="sd">    &gt;&gt;&gt; microscope.connect(&quot;localhost&quot;)</span>
</span><span id="L-431"><a href="#L-431"><span class="linenos"> 431</span></a><span class="sd">    Client connecting to [localhost:7520]...</span>
</span><span id="L-432"><a href="#L-432"><span class="linenos"> 432</span></a><span class="sd">    Client connected to [localhost:7520]</span>
</span><span id="L-433"><a href="#L-433"><span class="linenos"> 433</span></a><span class="sd">    &gt;&gt;&gt; beam = tbt.ElectronBeam(settings=None)</span>
</span><span id="L-434"><a href="#L-434"><span class="linenos"> 434</span></a><span class="sd">    &gt;&gt;&gt; success = beam_ready(beam, microscope)</span>
</span><span id="L-435"><a href="#L-435"><span class="linenos"> 435</span></a><span class="sd">    &gt;&gt;&gt; print(success)</span>
</span><span id="L-436"><a href="#L-436"><span class="linenos"> 436</span></a><span class="sd">    True</span>
</span><span id="L-437"><a href="#L-437"><span class="linenos"> 437</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-438"><a href="#L-438"><span class="linenos"> 438</span></a>    <span class="n">selected_beam</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">beam_type</span><span class="p">(</span><span class="n">beam</span><span class="p">,</span> <span class="n">microscope</span><span class="p">)</span>
</span><span id="L-439"><a href="#L-439"><span class="linenos"> 439</span></a>
</span><span id="L-440"><a href="#L-440"><span class="linenos"> 440</span></a>    <span class="c1"># check vaccum</span>
</span><span id="L-441"><a href="#L-441"><span class="linenos"> 441</span></a>    <span class="n">vacuum</span> <span class="o">=</span> <span class="n">microscope</span><span class="o">.</span><span class="n">vacuum</span><span class="o">.</span><span class="n">chamber_state</span>
</span><span id="L-442"><a href="#L-442"><span class="linenos"> 442</span></a>    <span class="k">if</span> <span class="n">vacuum</span> <span class="o">!=</span> <span class="n">tbt</span><span class="o">.</span><span class="n">VacuumState</span><span class="o">.</span><span class="n">PUMPED</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>
</span><span id="L-443"><a href="#L-443"><span class="linenos"> 443</span></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Vacuum is not pumped, current state is &quot;</span><span class="si">{</span><span class="n">vacuum</span><span class="si">}</span><span class="s1">&quot;&#39;</span><span class="p">)</span>
</span><span id="L-444"><a href="#L-444"><span class="linenos"> 444</span></a>
</span><span id="L-445"><a href="#L-445"><span class="linenos"> 445</span></a>    <span class="c1"># check beam on</span>
</span><span id="L-446"><a href="#L-446"><span class="linenos"> 446</span></a>    <span class="n">count</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-447"><a href="#L-447"><span class="linenos"> 447</span></a>    <span class="k">while</span> <span class="n">count</span> <span class="o">&lt;</span> <span class="n">attempts</span><span class="p">:</span>
</span><span id="L-448"><a href="#L-448"><span class="linenos"> 448</span></a>        <span class="n">beam_on</span> <span class="o">=</span> <span class="n">selected_beam</span><span class="o">.</span><span class="n">is_on</span>
</span><span id="L-449"><a href="#L-449"><span class="linenos"> 449</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">beam_on</span><span class="p">:</span>
</span><span id="L-450"><a href="#L-450"><span class="linenos"> 450</span></a>            <span class="n">selected_beam</span><span class="o">.</span><span class="n">turn_on</span><span class="p">()</span>
</span><span id="L-451"><a href="#L-451"><span class="linenos"> 451</span></a>            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">delay_s</span><span class="p">)</span>
</span><span id="L-452"><a href="#L-452"><span class="linenos"> 452</span></a>        <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="L-453"><a href="#L-453"><span class="linenos"> 453</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">beam_on</span><span class="p">:</span>
</span><span id="L-454"><a href="#L-454"><span class="linenos"> 454</span></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="L-455"><a href="#L-455"><span class="linenos"> 455</span></a>            <span class="sa">f</span><span class="s2">&quot;Unable to turn on </span><span class="si">{</span><span class="n">beam</span><span class="o">.</span><span class="n">type</span><span class="si">}</span><span class="s2"> beam after </span><span class="si">{</span><span class="n">attempts</span><span class="si">}</span><span class="s2"> attempts.&quot;</span>
</span><span id="L-456"><a href="#L-456"><span class="linenos"> 456</span></a>        <span class="p">)</span>
</span><span id="L-457"><a href="#L-457"><span class="linenos"> 457</span></a>
</span><span id="L-458"><a href="#L-458"><span class="linenos"> 458</span></a>    <span class="c1"># check beam blank</span>
</span><span id="L-459"><a href="#L-459"><span class="linenos"> 459</span></a>    <span class="n">count</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="L-460"><a href="#L-460"><span class="linenos"> 460</span></a>    <span class="k">while</span> <span class="n">count</span> <span class="o">&lt;</span> <span class="n">attempts</span><span class="p">:</span>
</span><span id="L-461"><a href="#L-461"><span class="linenos"> 461</span></a>        <span class="n">beam_blank</span> <span class="o">=</span> <span class="n">selected_beam</span><span class="o">.</span><span class="n">is_blanked</span>
</span><span id="L-462"><a href="#L-462"><span class="linenos"> 462</span></a>        <span class="k">if</span> <span class="n">beam_blank</span><span class="p">:</span>
</span><span id="L-463"><a href="#L-463"><span class="linenos"> 463</span></a>            <span class="n">selected_beam</span><span class="o">.</span><span class="n">unblank</span><span class="p">()</span>
</span><span id="L-464"><a href="#L-464"><span class="linenos"> 464</span></a>            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">delay_s</span><span class="p">)</span>
</span><span id="L-465"><a href="#L-465"><span class="linenos"> 465</span></a>        <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="L-466"><a href="#L-466"><span class="linenos"> 466</span></a>    <span class="k">if</span> <span class="n">beam_blank</span><span class="p">:</span>
</span><span id="L-467"><a href="#L-467"><span class="linenos"> 467</span></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="L-468"><a href="#L-468"><span class="linenos"> 468</span></a>            <span class="sa">f</span><span class="s2">&quot;Unable to unblank </span><span class="si">{</span><span class="n">beam</span><span class="o">.</span><span class="n">type</span><span class="si">}</span><span class="s2"> beam after </span><span class="si">{</span><span class="n">attempts</span><span class="si">}</span><span class="s2"> attempts.&quot;</span>
</span><span id="L-469"><a href="#L-469"><span class="linenos"> 469</span></a>        <span class="p">)</span>
</span><span id="L-470"><a href="#L-470"><span class="linenos"> 470</span></a>
</span><span id="L-471"><a href="#L-471"><span class="linenos"> 471</span></a>    <span class="k">return</span> <span class="kc">True</span>
</span><span id="L-472"><a href="#L-472"><span class="linenos"> 472</span></a>
</span><span id="L-473"><a href="#L-473"><span class="linenos"> 473</span></a>
</span><span id="L-474"><a href="#L-474"><span class="linenos"> 474</span></a><span class="k">def</span> <span class="nf">beam_scan_full_frame</span><span class="p">(</span>
</span><span id="L-475"><a href="#L-475"><span class="linenos"> 475</span></a>    <span class="n">beam</span><span class="p">:</span> <span class="n">tbt</span><span class="o">.</span><span class="n">Beam</span><span class="p">,</span>
</span><span id="L-476"><a href="#L-476"><span class="linenos"> 476</span></a>    <span class="n">microscope</span><span class="p">:</span> <span class="n">tbt</span><span class="o">.</span><span class="n">Microscope</span><span class="p">,</span>
</span><span id="L-477"><a href="#L-477"><span class="linenos"> 477</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-478"><a href="#L-478"><span class="linenos"> 478</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-479"><a href="#L-479"><span class="linenos"> 479</span></a><span class="sd">    Set beam scan mode to full frame.</span>
</span><span id="L-480"><a href="#L-480"><span class="linenos"> 480</span></a>
</span><span id="L-481"><a href="#L-481"><span class="linenos"> 481</span></a><span class="sd">    This function sets the scanning mode of the specified beam to full frame on the microscope.</span>
</span><span id="L-482"><a href="#L-482"><span class="linenos"> 482</span></a>
</span><span id="L-483"><a href="#L-483"><span class="linenos"> 483</span></a><span class="sd">    Parameters</span>
</span><span id="L-484"><a href="#L-484"><span class="linenos"> 484</span></a><span class="sd">    ----------</span>
</span><span id="L-485"><a href="#L-485"><span class="linenos"> 485</span></a><span class="sd">    beam : tbt.Beam</span>
</span><span id="L-486"><a href="#L-486"><span class="linenos"> 486</span></a><span class="sd">        The beam type to configure.</span>
</span><span id="L-487"><a href="#L-487"><span class="linenos"> 487</span></a><span class="sd">    microscope : tbt.Microscope</span>
</span><span id="L-488"><a href="#L-488"><span class="linenos"> 488</span></a><span class="sd">        The microscope object to configure.</span>
</span><span id="L-489"><a href="#L-489"><span class="linenos"> 489</span></a>
</span><span id="L-490"><a href="#L-490"><span class="linenos"> 490</span></a><span class="sd">    Returns</span>
</span><span id="L-491"><a href="#L-491"><span class="linenos"> 491</span></a><span class="sd">    -------</span>
</span><span id="L-492"><a href="#L-492"><span class="linenos"> 492</span></a><span class="sd">    bool</span>
</span><span id="L-493"><a href="#L-493"><span class="linenos"> 493</span></a><span class="sd">        True if the scan mode is set to full frame successfully, False otherwise.</span>
</span><span id="L-494"><a href="#L-494"><span class="linenos"> 494</span></a>
</span><span id="L-495"><a href="#L-495"><span class="linenos"> 495</span></a><span class="sd">    Raises</span>
</span><span id="L-496"><a href="#L-496"><span class="linenos"> 496</span></a><span class="sd">    ------</span>
</span><span id="L-497"><a href="#L-497"><span class="linenos"> 497</span></a><span class="sd">    SystemError</span>
</span><span id="L-498"><a href="#L-498"><span class="linenos"> 498</span></a><span class="sd">        If unable to set the scan mode to full frame.</span>
</span><span id="L-499"><a href="#L-499"><span class="linenos"> 499</span></a>
</span><span id="L-500"><a href="#L-500"><span class="linenos"> 500</span></a><span class="sd">    Examples</span>
</span><span id="L-501"><a href="#L-501"><span class="linenos"> 501</span></a><span class="sd">    --------</span>
</span><span id="L-502"><a href="#L-502"><span class="linenos"> 502</span></a><span class="sd">    &gt;&gt;&gt; import pytribeam.types as tbt</span>
</span><span id="L-503"><a href="#L-503"><span class="linenos"> 503</span></a><span class="sd">    &gt;&gt;&gt; microscope = tbt.Microscope()</span>
</span><span id="L-504"><a href="#L-504"><span class="linenos"> 504</span></a><span class="sd">    &gt;&gt;&gt; microscope.connect(&quot;localhost&quot;)</span>
</span><span id="L-505"><a href="#L-505"><span class="linenos"> 505</span></a><span class="sd">    Client connecting to [localhost:7520]...</span>
</span><span id="L-506"><a href="#L-506"><span class="linenos"> 506</span></a><span class="sd">    Client connected to [localhost:7520]</span>
</span><span id="L-507"><a href="#L-507"><span class="linenos"> 507</span></a><span class="sd">    &gt;&gt;&gt; beam = tbt.ElectronBeam(settings=None)</span>
</span><span id="L-508"><a href="#L-508"><span class="linenos"> 508</span></a><span class="sd">    &gt;&gt;&gt; success = beam_scan_full_frame(beam, microscope)</span>
</span><span id="L-509"><a href="#L-509"><span class="linenos"> 509</span></a><span class="sd">    &gt;&gt;&gt; print(success)</span>
</span><span id="L-510"><a href="#L-510"><span class="linenos"> 510</span></a><span class="sd">    True</span>
</span><span id="L-511"><a href="#L-511"><span class="linenos"> 511</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-512"><a href="#L-512"><span class="linenos"> 512</span></a>    <span class="n">selected_beam</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">beam_type</span><span class="p">(</span><span class="n">beam</span><span class="p">,</span> <span class="n">microscope</span><span class="p">)</span>
</span><span id="L-513"><a href="#L-513"><span class="linenos"> 513</span></a>    <span class="n">selected_beam</span><span class="o">.</span><span class="n">scanning</span><span class="o">.</span><span class="n">mode</span><span class="o">.</span><span class="n">set_full_frame</span><span class="p">()</span>
</span><span id="L-514"><a href="#L-514"><span class="linenos"> 514</span></a>    <span class="n">scan_mode</span> <span class="o">=</span> <span class="n">selected_beam</span><span class="o">.</span><span class="n">scanning</span><span class="o">.</span><span class="n">mode</span><span class="o">.</span><span class="n">value</span>
</span><span id="L-515"><a href="#L-515"><span class="linenos"> 515</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">scan_mode</span> <span class="o">==</span> <span class="n">tbt</span><span class="o">.</span><span class="n">ScanMode</span><span class="o">.</span><span class="n">FULL_FRAME</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>
</span><span id="L-516"><a href="#L-516"><span class="linenos"> 516</span></a>        <span class="k">raise</span> <span class="ne">SystemError</span><span class="p">(</span>
</span><span id="L-517"><a href="#L-517"><span class="linenos"> 517</span></a>            <span class="sa">f</span><span class="s2">&quot;Unable to set imaging to full frame. Current scan mode is </span><span class="si">{</span><span class="n">scan_mode</span><span class="si">}</span><span class="s2">.&quot;</span>
</span><span id="L-518"><a href="#L-518"><span class="linenos"> 518</span></a>        <span class="p">)</span>
</span><span id="L-519"><a href="#L-519"><span class="linenos"> 519</span></a>    <span class="k">return</span> <span class="kc">True</span>
</span><span id="L-520"><a href="#L-520"><span class="linenos"> 520</span></a>
</span><span id="L-521"><a href="#L-521"><span class="linenos"> 521</span></a>
</span><span id="L-522"><a href="#L-522"><span class="linenos"> 522</span></a><span class="k">def</span> <span class="nf">beam_scan_resolution</span><span class="p">(</span>
</span><span id="L-523"><a href="#L-523"><span class="linenos"> 523</span></a>    <span class="n">beam</span><span class="p">:</span> <span class="n">tbt</span><span class="o">.</span><span class="n">Beam</span><span class="p">,</span>
</span><span id="L-524"><a href="#L-524"><span class="linenos"> 524</span></a>    <span class="n">microscope</span><span class="p">:</span> <span class="n">tbt</span><span class="o">.</span><span class="n">Microscope</span><span class="p">,</span>
</span><span id="L-525"><a href="#L-525"><span class="linenos"> 525</span></a>    <span class="n">resolution</span><span class="p">:</span> <span class="n">tbt</span><span class="o">.</span><span class="n">Resolution</span><span class="p">,</span>
</span><span id="L-526"><a href="#L-526"><span class="linenos"> 526</span></a>    <span class="n">delay_s</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span>
</span><span id="L-527"><a href="#L-527"><span class="linenos"> 527</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-528"><a href="#L-528"><span class="linenos"> 528</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-529"><a href="#L-529"><span class="linenos"> 529</span></a><span class="sd">    Sets the scan resolution for the selected beam, with inputs in units of preset resolutions.</span>
</span><span id="L-530"><a href="#L-530"><span class="linenos"> 530</span></a>
</span><span id="L-531"><a href="#L-531"><span class="linenos"> 531</span></a><span class="sd">    This function sets the scan resolution for the specified beam type on the microscope.</span>
</span><span id="L-532"><a href="#L-532"><span class="linenos"> 532</span></a><span class="sd">    It only works for preset resolutions and waits for the specified delay after setting the resolution.</span>
</span><span id="L-533"><a href="#L-533"><span class="linenos"> 533</span></a>
</span><span id="L-534"><a href="#L-534"><span class="linenos"> 534</span></a><span class="sd">    Parameters</span>
</span><span id="L-535"><a href="#L-535"><span class="linenos"> 535</span></a><span class="sd">    ----------</span>
</span><span id="L-536"><a href="#L-536"><span class="linenos"> 536</span></a><span class="sd">    beam : tbt.Beam</span>
</span><span id="L-537"><a href="#L-537"><span class="linenos"> 537</span></a><span class="sd">        The beam type to configure.</span>
</span><span id="L-538"><a href="#L-538"><span class="linenos"> 538</span></a><span class="sd">    microscope : tbt.Microscope</span>
</span><span id="L-539"><a href="#L-539"><span class="linenos"> 539</span></a><span class="sd">        The microscope object to configure.</span>
</span><span id="L-540"><a href="#L-540"><span class="linenos"> 540</span></a><span class="sd">    resolution : tbt.Resolution</span>
</span><span id="L-541"><a href="#L-541"><span class="linenos"> 541</span></a><span class="sd">        The desired scan resolution (must be a preset resolution).</span>
</span><span id="L-542"><a href="#L-542"><span class="linenos"> 542</span></a><span class="sd">    delay_s : float, optional</span>
</span><span id="L-543"><a href="#L-543"><span class="linenos"> 543</span></a><span class="sd">        The delay in seconds to wait after adjusting the resolution (default is 0.1).</span>
</span><span id="L-544"><a href="#L-544"><span class="linenos"> 544</span></a>
</span><span id="L-545"><a href="#L-545"><span class="linenos"> 545</span></a><span class="sd">    Returns</span>
</span><span id="L-546"><a href="#L-546"><span class="linenos"> 546</span></a><span class="sd">    -------</span>
</span><span id="L-547"><a href="#L-547"><span class="linenos"> 547</span></a><span class="sd">    bool</span>
</span><span id="L-548"><a href="#L-548"><span class="linenos"> 548</span></a><span class="sd">        True if the scan resolution is set successfully, False otherwise.</span>
</span><span id="L-549"><a href="#L-549"><span class="linenos"> 549</span></a>
</span><span id="L-550"><a href="#L-550"><span class="linenos"> 550</span></a><span class="sd">    Raises</span>
</span><span id="L-551"><a href="#L-551"><span class="linenos"> 551</span></a><span class="sd">    ------</span>
</span><span id="L-552"><a href="#L-552"><span class="linenos"> 552</span></a><span class="sd">    ValueError</span>
</span><span id="L-553"><a href="#L-553"><span class="linenos"> 553</span></a><span class="sd">        If a custom resolution is requested or if the resolution cannot be adjusted correctly.</span>
</span><span id="L-554"><a href="#L-554"><span class="linenos"> 554</span></a>
</span><span id="L-555"><a href="#L-555"><span class="linenos"> 555</span></a><span class="sd">    Examples</span>
</span><span id="L-556"><a href="#L-556"><span class="linenos"> 556</span></a><span class="sd">    --------</span>
</span><span id="L-557"><a href="#L-557"><span class="linenos"> 557</span></a><span class="sd">    &gt;&gt;&gt; import pytribeam.types as tbt</span>
</span><span id="L-558"><a href="#L-558"><span class="linenos"> 558</span></a><span class="sd">    &gt;&gt;&gt; import pytribeam.utility as ut</span>
</span><span id="L-559"><a href="#L-559"><span class="linenos"> 559</span></a><span class="sd">    &gt;&gt;&gt; microscope = tbt.Microscope()</span>
</span><span id="L-560"><a href="#L-560"><span class="linenos"> 560</span></a><span class="sd">    &gt;&gt;&gt; microscope.connect(&quot;localhost&quot;)</span>
</span><span id="L-561"><a href="#L-561"><span class="linenos"> 561</span></a><span class="sd">    Client connecting to [localhost:7520]...</span>
</span><span id="L-562"><a href="#L-562"><span class="linenos"> 562</span></a><span class="sd">    Client connected to [localhost:7520]</span>
</span><span id="L-563"><a href="#L-563"><span class="linenos"> 563</span></a><span class="sd">    &gt;&gt;&gt; beam = tbt.ElectronBeam(settings=None)</span>
</span><span id="L-564"><a href="#L-564"><span class="linenos"> 564</span></a><span class="sd">    &gt;&gt;&gt; resolution = tbt.PresetResolution.HIGH</span>
</span><span id="L-565"><a href="#L-565"><span class="linenos"> 565</span></a><span class="sd">    &gt;&gt;&gt; success = beam_scan_resolution(beam, microscope, resolution)</span>
</span><span id="L-566"><a href="#L-566"><span class="linenos"> 566</span></a><span class="sd">    &gt;&gt;&gt; print(success)</span>
</span><span id="L-567"><a href="#L-567"><span class="linenos"> 567</span></a><span class="sd">    True</span>
</span><span id="L-568"><a href="#L-568"><span class="linenos"> 568</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-569"><a href="#L-569"><span class="linenos"> 569</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">resolution</span><span class="p">,</span> <span class="n">tbt</span><span class="o">.</span><span class="n">PresetResolution</span><span class="p">):</span>
</span><span id="L-570"><a href="#L-570"><span class="linenos"> 570</span></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="L-571"><a href="#L-571"><span class="linenos"> 571</span></a>            <span class="sa">f</span><span class="s2">&quot;Requested a custom resolution of </span><span class="si">{</span><span class="n">resolution</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2">. Only preset resolutions allowed.&quot;</span>
</span><span id="L-572"><a href="#L-572"><span class="linenos"> 572</span></a>        <span class="p">)</span>
</span><span id="L-573"><a href="#L-573"><span class="linenos"> 573</span></a>
</span><span id="L-574"><a href="#L-574"><span class="linenos"> 574</span></a>    <span class="n">selected_beam</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">beam_type</span><span class="p">(</span><span class="n">beam</span><span class="p">,</span> <span class="n">microscope</span><span class="p">)</span>
</span><span id="L-575"><a href="#L-575"><span class="linenos"> 575</span></a>    <span class="n">selected_beam</span><span class="o">.</span><span class="n">scanning</span><span class="o">.</span><span class="n">resolution</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">resolution</span><span class="o">.</span><span class="n">value</span>
</span><span id="L-576"><a href="#L-576"><span class="linenos"> 576</span></a>    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">delay_s</span><span class="p">)</span>
</span><span id="L-577"><a href="#L-577"><span class="linenos"> 577</span></a>    <span class="k">if</span> <span class="n">selected_beam</span><span class="o">.</span><span class="n">scanning</span><span class="o">.</span><span class="n">resolution</span><span class="o">.</span><span class="n">value</span> <span class="o">!=</span> <span class="n">resolution</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>
</span><span id="L-578"><a href="#L-578"><span class="linenos"> 578</span></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="L-579"><a href="#L-579"><span class="linenos"> 579</span></a>            <span class="sa">f</span><span class="s2">&quot;&quot;&quot;Could not correctly adjust scan resolution,</span>
</span><span id="L-580"><a href="#L-580"><span class="linenos"> 580</span></a><span class="s2">            requested </span><span class="si">{</span><span class="n">resolution</span><span class="si">}</span><span class="s2">, current resolution is</span>
</span><span id="L-581"><a href="#L-581"><span class="linenos"> 581</span></a><span class="s2">            </span><span class="si">{</span><span class="n">selected_beam</span><span class="o">.</span><span class="n">scanning</span><span class="o">.</span><span class="n">resolution</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;&quot;&quot;</span>
</span><span id="L-582"><a href="#L-582"><span class="linenos"> 582</span></a>        <span class="p">)</span>
</span><span id="L-583"><a href="#L-583"><span class="linenos"> 583</span></a>
</span><span id="L-584"><a href="#L-584"><span class="linenos"> 584</span></a>    <span class="k">return</span> <span class="kc">True</span>
</span><span id="L-585"><a href="#L-585"><span class="linenos"> 585</span></a>
</span><span id="L-586"><a href="#L-586"><span class="linenos"> 586</span></a>
</span><span id="L-587"><a href="#L-587"><span class="linenos"> 587</span></a><span class="k">def</span> <span class="nf">beam_scan_rotation</span><span class="p">(</span>
</span><span id="L-588"><a href="#L-588"><span class="linenos"> 588</span></a>    <span class="n">beam</span><span class="p">:</span> <span class="n">tbt</span><span class="o">.</span><span class="n">Beam</span><span class="p">,</span>
</span><span id="L-589"><a href="#L-589"><span class="linenos"> 589</span></a>    <span class="n">microscope</span><span class="p">:</span> <span class="n">tbt</span><span class="o">.</span><span class="n">Microscope</span><span class="p">,</span>
</span><span id="L-590"><a href="#L-590"><span class="linenos"> 590</span></a>    <span class="n">rotation_deg</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="L-591"><a href="#L-591"><span class="linenos"> 591</span></a>    <span class="n">delay_s</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span>
</span><span id="L-592"><a href="#L-592"><span class="linenos"> 592</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-593"><a href="#L-593"><span class="linenos"> 593</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-594"><a href="#L-594"><span class="linenos"> 594</span></a><span class="sd">    Sets the scan rotation for the selected beam, with inputs in units of degrees.</span>
</span><span id="L-595"><a href="#L-595"><span class="linenos"> 595</span></a>
</span><span id="L-596"><a href="#L-596"><span class="linenos"> 596</span></a><span class="sd">    This function sets the scan rotation for the specified beam type on the microscope.</span>
</span><span id="L-597"><a href="#L-597"><span class="linenos"> 597</span></a><span class="sd">    It converts the rotation from degrees to radians, sets the scan rotation, and waits for the specified delay.</span>
</span><span id="L-598"><a href="#L-598"><span class="linenos"> 598</span></a>
</span><span id="L-599"><a href="#L-599"><span class="linenos"> 599</span></a><span class="sd">    Parameters</span>
</span><span id="L-600"><a href="#L-600"><span class="linenos"> 600</span></a><span class="sd">    ----------</span>
</span><span id="L-601"><a href="#L-601"><span class="linenos"> 601</span></a><span class="sd">    beam : tbt.Beam</span>
</span><span id="L-602"><a href="#L-602"><span class="linenos"> 602</span></a><span class="sd">        The beam type to configure.</span>
</span><span id="L-603"><a href="#L-603"><span class="linenos"> 603</span></a><span class="sd">    microscope : tbt.Microscope</span>
</span><span id="L-604"><a href="#L-604"><span class="linenos"> 604</span></a><span class="sd">        The microscope object to configure.</span>
</span><span id="L-605"><a href="#L-605"><span class="linenos"> 605</span></a><span class="sd">    rotation_deg : float</span>
</span><span id="L-606"><a href="#L-606"><span class="linenos"> 606</span></a><span class="sd">        The desired scan rotation in degrees.</span>
</span><span id="L-607"><a href="#L-607"><span class="linenos"> 607</span></a><span class="sd">    delay_s : float, optional</span>
</span><span id="L-608"><a href="#L-608"><span class="linenos"> 608</span></a><span class="sd">        The delay in seconds to wait after adjusting the scan rotation (default is 0.1).</span>
</span><span id="L-609"><a href="#L-609"><span class="linenos"> 609</span></a>
</span><span id="L-610"><a href="#L-610"><span class="linenos"> 610</span></a><span class="sd">    Returns</span>
</span><span id="L-611"><a href="#L-611"><span class="linenos"> 611</span></a><span class="sd">    -------</span>
</span><span id="L-612"><a href="#L-612"><span class="linenos"> 612</span></a><span class="sd">    bool</span>
</span><span id="L-613"><a href="#L-613"><span class="linenos"> 613</span></a><span class="sd">        True if the scan rotation is set successfully, False otherwise.</span>
</span><span id="L-614"><a href="#L-614"><span class="linenos"> 614</span></a>
</span><span id="L-615"><a href="#L-615"><span class="linenos"> 615</span></a><span class="sd">    Raises</span>
</span><span id="L-616"><a href="#L-616"><span class="linenos"> 616</span></a><span class="sd">    ------</span>
</span><span id="L-617"><a href="#L-617"><span class="linenos"> 617</span></a><span class="sd">    ValueError</span>
</span><span id="L-618"><a href="#L-618"><span class="linenos"> 618</span></a><span class="sd">        If the scan rotation cannot be adjusted correctly.</span>
</span><span id="L-619"><a href="#L-619"><span class="linenos"> 619</span></a>
</span><span id="L-620"><a href="#L-620"><span class="linenos"> 620</span></a><span class="sd">    Examples</span>
</span><span id="L-621"><a href="#L-621"><span class="linenos"> 621</span></a><span class="sd">    --------</span>
</span><span id="L-622"><a href="#L-622"><span class="linenos"> 622</span></a><span class="sd">    &gt;&gt;&gt; import pytribeam.types as tbt</span>
</span><span id="L-623"><a href="#L-623"><span class="linenos"> 623</span></a><span class="sd">    &gt;&gt;&gt; microscope = tbt.Microscope()</span>
</span><span id="L-624"><a href="#L-624"><span class="linenos"> 624</span></a><span class="sd">    &gt;&gt;&gt; microscope.connect(&quot;localhost&quot;)</span>
</span><span id="L-625"><a href="#L-625"><span class="linenos"> 625</span></a><span class="sd">    Client connecting to [localhost:7520]...</span>
</span><span id="L-626"><a href="#L-626"><span class="linenos"> 626</span></a><span class="sd">    Client connected to [localhost:7520]</span>
</span><span id="L-627"><a href="#L-627"><span class="linenos"> 627</span></a><span class="sd">    &gt;&gt;&gt; beam = tbt.ElectronBeam(settings=None)</span>
</span><span id="L-628"><a href="#L-628"><span class="linenos"> 628</span></a><span class="sd">    &gt;&gt;&gt; success = beam_scan_rotation(beam, microscope, rotation_deg=45.0)</span>
</span><span id="L-629"><a href="#L-629"><span class="linenos"> 629</span></a><span class="sd">    &gt;&gt;&gt; print(success)</span>
</span><span id="L-630"><a href="#L-630"><span class="linenos"> 630</span></a><span class="sd">    True</span>
</span><span id="L-631"><a href="#L-631"><span class="linenos"> 631</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-632"><a href="#L-632"><span class="linenos"> 632</span></a>    <span class="n">selected_beam</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">beam_type</span><span class="p">(</span><span class="n">beam</span><span class="p">,</span> <span class="n">microscope</span><span class="p">)</span>
</span><span id="L-633"><a href="#L-633"><span class="linenos"> 633</span></a>    <span class="n">rotation_rad</span> <span class="o">=</span> <span class="n">rotation_deg</span> <span class="o">*</span> <span class="n">cs</span><span class="o">.</span><span class="n">Conversions</span><span class="o">.</span><span class="n">DEG_TO_RAD</span>
</span><span id="L-634"><a href="#L-634"><span class="linenos"> 634</span></a>    <span class="n">selected_beam</span><span class="o">.</span><span class="n">scanning</span><span class="o">.</span><span class="n">rotation</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">rotation_rad</span>
</span><span id="L-635"><a href="#L-635"><span class="linenos"> 635</span></a>    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">delay_s</span><span class="p">)</span>
</span><span id="L-636"><a href="#L-636"><span class="linenos"> 636</span></a>    <span class="k">if</span> <span class="n">selected_beam</span><span class="o">.</span><span class="n">scanning</span><span class="o">.</span><span class="n">rotation</span><span class="o">.</span><span class="n">value</span> <span class="o">!=</span> <span class="n">rotation_rad</span><span class="p">:</span>
</span><span id="L-637"><a href="#L-637"><span class="linenos"> 637</span></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="L-638"><a href="#L-638"><span class="linenos"> 638</span></a>            <span class="sa">f</span><span class="s2">&quot;&quot;&quot;Could not correctly adjust scan rotation,</span>
</span><span id="L-639"><a href="#L-639"><span class="linenos"> 639</span></a><span class="s2">            requested </span><span class="si">{</span><span class="n">rotation_rad</span><span class="si">}</span><span class="s2"> radians, current scan rotation is</span>
</span><span id="L-640"><a href="#L-640"><span class="linenos"> 640</span></a><span class="s2">            </span><span class="si">{</span><span class="n">selected_beam</span><span class="o">.</span><span class="n">scanning</span><span class="o">.</span><span class="n">rotation</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2"> radians&quot;&quot;&quot;</span>
</span><span id="L-641"><a href="#L-641"><span class="linenos"> 641</span></a>        <span class="p">)</span>
</span><span id="L-642"><a href="#L-642"><span class="linenos"> 642</span></a>
</span><span id="L-643"><a href="#L-643"><span class="linenos"> 643</span></a>    <span class="k">return</span> <span class="kc">True</span>
</span><span id="L-644"><a href="#L-644"><span class="linenos"> 644</span></a>
</span><span id="L-645"><a href="#L-645"><span class="linenos"> 645</span></a>
</span><span id="L-646"><a href="#L-646"><span class="linenos"> 646</span></a><span class="k">def</span> <span class="nf">beam_voltage</span><span class="p">(</span>
</span><span id="L-647"><a href="#L-647"><span class="linenos"> 647</span></a>    <span class="n">beam</span><span class="p">:</span> <span class="n">tbt</span><span class="o">.</span><span class="n">Beam</span><span class="p">,</span>
</span><span id="L-648"><a href="#L-648"><span class="linenos"> 648</span></a>    <span class="n">microscope</span><span class="p">:</span> <span class="n">tbt</span><span class="o">.</span><span class="n">Microscope</span><span class="p">,</span>
</span><span id="L-649"><a href="#L-649"><span class="linenos"> 649</span></a>    <span class="n">voltage_kv</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="L-650"><a href="#L-650"><span class="linenos"> 650</span></a>    <span class="n">voltage_tol_kv</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="L-651"><a href="#L-651"><span class="linenos"> 651</span></a>    <span class="n">delay_s</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">5.0</span><span class="p">,</span>
</span><span id="L-652"><a href="#L-652"><span class="linenos"> 652</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-653"><a href="#L-653"><span class="linenos"> 653</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-654"><a href="#L-654"><span class="linenos"> 654</span></a><span class="sd">    Sets the voltage for a given beam type, with inputs in units of kilovolts.</span>
</span><span id="L-655"><a href="#L-655"><span class="linenos"> 655</span></a>
</span><span id="L-656"><a href="#L-656"><span class="linenos"> 656</span></a><span class="sd">    This function sets the beam voltage for the specified beam type on the microscope.</span>
</span><span id="L-657"><a href="#L-657"><span class="linenos"> 657</span></a><span class="sd">    If the voltage difference exceeds the tolerance, it adjusts the beam voltage and waits for the specified delay.</span>
</span><span id="L-658"><a href="#L-658"><span class="linenos"> 658</span></a>
</span><span id="L-659"><a href="#L-659"><span class="linenos"> 659</span></a><span class="sd">    Parameters</span>
</span><span id="L-660"><a href="#L-660"><span class="linenos"> 660</span></a><span class="sd">    ----------</span>
</span><span id="L-661"><a href="#L-661"><span class="linenos"> 661</span></a><span class="sd">    beam : tbt.Beam</span>
</span><span id="L-662"><a href="#L-662"><span class="linenos"> 662</span></a><span class="sd">        The beam type to configure.</span>
</span><span id="L-663"><a href="#L-663"><span class="linenos"> 663</span></a><span class="sd">    microscope : tbt.Microscope</span>
</span><span id="L-664"><a href="#L-664"><span class="linenos"> 664</span></a><span class="sd">        The microscope object to configure.</span>
</span><span id="L-665"><a href="#L-665"><span class="linenos"> 665</span></a><span class="sd">    voltage_kv : float</span>
</span><span id="L-666"><a href="#L-666"><span class="linenos"> 666</span></a><span class="sd">        The desired beam voltage in kilovolts.</span>
</span><span id="L-667"><a href="#L-667"><span class="linenos"> 667</span></a><span class="sd">    voltage_tol_kv : float</span>
</span><span id="L-668"><a href="#L-668"><span class="linenos"> 668</span></a><span class="sd">        The tolerance for the beam voltage in kilovolts.</span>
</span><span id="L-669"><a href="#L-669"><span class="linenos"> 669</span></a><span class="sd">    delay_s : float, optional</span>
</span><span id="L-670"><a href="#L-670"><span class="linenos"> 670</span></a><span class="sd">        The delay in seconds to wait after adjusting the beam voltage (default is 5.0).</span>
</span><span id="L-671"><a href="#L-671"><span class="linenos"> 671</span></a>
</span><span id="L-672"><a href="#L-672"><span class="linenos"> 672</span></a><span class="sd">    Returns</span>
</span><span id="L-673"><a href="#L-673"><span class="linenos"> 673</span></a><span class="sd">    -------</span>
</span><span id="L-674"><a href="#L-674"><span class="linenos"> 674</span></a><span class="sd">    bool</span>
</span><span id="L-675"><a href="#L-675"><span class="linenos"> 675</span></a><span class="sd">        True if the beam voltage is set successfully, False otherwise.</span>
</span><span id="L-676"><a href="#L-676"><span class="linenos"> 676</span></a>
</span><span id="L-677"><a href="#L-677"><span class="linenos"> 677</span></a><span class="sd">    Raises</span>
</span><span id="L-678"><a href="#L-678"><span class="linenos"> 678</span></a><span class="sd">    ------</span>
</span><span id="L-679"><a href="#L-679"><span class="linenos"> 679</span></a><span class="sd">    ValueError</span>
</span><span id="L-680"><a href="#L-680"><span class="linenos"> 680</span></a><span class="sd">        If the beam voltage cannot be adjusted within the specified tolerance.</span>
</span><span id="L-681"><a href="#L-681"><span class="linenos"> 681</span></a><span class="sd">        If the beam is not controllable.</span>
</span><span id="L-682"><a href="#L-682"><span class="linenos"> 682</span></a>
</span><span id="L-683"><a href="#L-683"><span class="linenos"> 683</span></a><span class="sd">    Examples</span>
</span><span id="L-684"><a href="#L-684"><span class="linenos"> 684</span></a><span class="sd">    --------</span>
</span><span id="L-685"><a href="#L-685"><span class="linenos"> 685</span></a><span class="sd">    &gt;&gt;&gt; import pytribeam.types as tbt</span>
</span><span id="L-686"><a href="#L-686"><span class="linenos"> 686</span></a><span class="sd">    &gt;&gt;&gt; microscope = tbt.Microscope()</span>
</span><span id="L-687"><a href="#L-687"><span class="linenos"> 687</span></a><span class="sd">    &gt;&gt;&gt; microscope.connect(&quot;localhost&quot;)</span>
</span><span id="L-688"><a href="#L-688"><span class="linenos"> 688</span></a><span class="sd">    Client connecting to [localhost:7520]...</span>
</span><span id="L-689"><a href="#L-689"><span class="linenos"> 689</span></a><span class="sd">    Client connected to [localhost:7520]</span>
</span><span id="L-690"><a href="#L-690"><span class="linenos"> 690</span></a><span class="sd">    &gt;&gt;&gt; beam = tbt.ElectronBeam(settings=None)</span>
</span><span id="L-691"><a href="#L-691"><span class="linenos"> 691</span></a><span class="sd">    &gt;&gt;&gt; success = beam_voltage(beam, microscope, voltage_kv=15.0, voltage_tol_kv=0.5)</span>
</span><span id="L-692"><a href="#L-692"><span class="linenos"> 692</span></a><span class="sd">    &gt;&gt;&gt; print(success)</span>
</span><span id="L-693"><a href="#L-693"><span class="linenos"> 693</span></a><span class="sd">    True</span>
</span><span id="L-694"><a href="#L-694"><span class="linenos"> 694</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-695"><a href="#L-695"><span class="linenos"> 695</span></a>    <span class="n">selected_beam</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">beam_type</span><span class="p">(</span><span class="n">beam</span><span class="p">,</span> <span class="n">microscope</span><span class="p">)</span>
</span><span id="L-696"><a href="#L-696"><span class="linenos"> 696</span></a>
</span><span id="L-697"><a href="#L-697"><span class="linenos"> 697</span></a>    <span class="n">exisiting_voltage_v</span> <span class="o">=</span> <span class="n">selected_beam</span><span class="o">.</span><span class="n">high_voltage</span><span class="o">.</span><span class="n">value</span>  <span class="c1"># volts</span>
</span><span id="L-698"><a href="#L-698"><span class="linenos"> 698</span></a>    <span class="n">delta_voltage_kv</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span>
</span><span id="L-699"><a href="#L-699"><span class="linenos"> 699</span></a>        <span class="n">exisiting_voltage_v</span> <span class="o">*</span> <span class="n">cs</span><span class="o">.</span><span class="n">Conversions</span><span class="o">.</span><span class="n">V_TO_KV</span> <span class="o">-</span> <span class="n">voltage_kv</span>
</span><span id="L-700"><a href="#L-700"><span class="linenos"> 700</span></a>    <span class="p">)</span>  <span class="c1"># kilovolts</span>
</span><span id="L-701"><a href="#L-701"><span class="linenos"> 701</span></a>    <span class="k">if</span> <span class="n">delta_voltage_kv</span> <span class="o">&gt;</span> <span class="n">voltage_tol_kv</span><span class="p">:</span>
</span><span id="L-702"><a href="#L-702"><span class="linenos"> 702</span></a>        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
</span><span id="L-703"><a href="#L-703"><span class="linenos"> 703</span></a>            <span class="s2">&quot;Requested beam current is not the current setting, imaging conditions may be non-ideal.&quot;</span>
</span><span id="L-704"><a href="#L-704"><span class="linenos"> 704</span></a>        <span class="p">)</span>
</span><span id="L-705"><a href="#L-705"><span class="linenos"> 705</span></a>        <span class="n">beam_controllable</span> <span class="o">=</span> <span class="n">selected_beam</span><span class="o">.</span><span class="n">high_voltage</span><span class="o">.</span><span class="n">is_controllable</span>
</span><span id="L-706"><a href="#L-706"><span class="linenos"> 706</span></a>
</span><span id="L-707"><a href="#L-707"><span class="linenos"> 707</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">beam_controllable</span><span class="p">:</span>
</span><span id="L-708"><a href="#L-708"><span class="linenos"> 708</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="L-709"><a href="#L-709"><span class="linenos"> 709</span></a>                <span class="sa">f</span><span class="s2">&quot;Unable to modify beam voltage, beam is not currently controllable.&quot;</span>
</span><span id="L-710"><a href="#L-710"><span class="linenos"> 710</span></a>            <span class="p">)</span>
</span><span id="L-711"><a href="#L-711"><span class="linenos"> 711</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Adjusting beam voltage...&quot;</span><span class="p">)</span>
</span><span id="L-712"><a href="#L-712"><span class="linenos"> 712</span></a>        <span class="n">selected_beam</span><span class="o">.</span><span class="n">high_voltage</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">voltage_kv</span> <span class="o">*</span> <span class="n">cs</span><span class="o">.</span><span class="n">Conversions</span><span class="o">.</span><span class="n">KV_TO_V</span>
</span><span id="L-713"><a href="#L-713"><span class="linenos"> 713</span></a>        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">delay_s</span><span class="p">)</span>
</span><span id="L-714"><a href="#L-714"><span class="linenos"> 714</span></a>        <span class="n">new_voltage_kv</span> <span class="o">=</span> <span class="n">selected_beam</span><span class="o">.</span><span class="n">high_voltage</span><span class="o">.</span><span class="n">value</span> <span class="o">*</span> <span class="n">cs</span><span class="o">.</span><span class="n">Conversions</span><span class="o">.</span><span class="n">V_TO_KV</span>
</span><span id="L-715"><a href="#L-715"><span class="linenos"> 715</span></a>        <span class="n">voltage_diff_kv</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">new_voltage_kv</span> <span class="o">-</span> <span class="n">voltage_kv</span><span class="p">)</span>
</span><span id="L-716"><a href="#L-716"><span class="linenos"> 716</span></a>        <span class="k">if</span> <span class="n">voltage_diff_kv</span> <span class="o">&gt;</span> <span class="n">voltage_tol_kv</span><span class="p">:</span>
</span><span id="L-717"><a href="#L-717"><span class="linenos"> 717</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="L-718"><a href="#L-718"><span class="linenos"> 718</span></a>                <span class="sa">f</span><span class="s2">&quot;&quot;&quot;Could not correctly adjust beam voltage,</span>
</span><span id="L-719"><a href="#L-719"><span class="linenos"> 719</span></a><span class="s2">                requested </span><span class="si">{</span><span class="n">voltage_kv</span><span class="si">}</span><span class="s2"> kV, current beam voltage is</span>
</span><span id="L-720"><a href="#L-720"><span class="linenos"> 720</span></a><span class="s2">                </span><span class="si">{</span><span class="n">new_voltage_kv</span><span class="si">}</span><span class="s2"> kV&quot;&quot;&quot;</span>
</span><span id="L-721"><a href="#L-721"><span class="linenos"> 721</span></a>            <span class="p">)</span>
</span><span id="L-722"><a href="#L-722"><span class="linenos"> 722</span></a>
</span><span id="L-723"><a href="#L-723"><span class="linenos"> 723</span></a>    <span class="k">return</span> <span class="kc">True</span>
</span><span id="L-724"><a href="#L-724"><span class="linenos"> 724</span></a>
</span><span id="L-725"><a href="#L-725"><span class="linenos"> 725</span></a>
</span><span id="L-726"><a href="#L-726"><span class="linenos"> 726</span></a><span class="k">def</span> <span class="nf">beam_working_distance</span><span class="p">(</span>
</span><span id="L-727"><a href="#L-727"><span class="linenos"> 727</span></a>    <span class="n">beam</span><span class="p">:</span> <span class="n">tbt</span><span class="o">.</span><span class="n">Beam</span><span class="p">,</span>
</span><span id="L-728"><a href="#L-728"><span class="linenos"> 728</span></a>    <span class="n">microscope</span><span class="p">:</span> <span class="n">tbt</span><span class="o">.</span><span class="n">Microscope</span><span class="p">,</span>
</span><span id="L-729"><a href="#L-729"><span class="linenos"> 729</span></a>    <span class="n">wd_mm</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="L-730"><a href="#L-730"><span class="linenos"> 730</span></a>    <span class="n">delay_s</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span>
</span><span id="L-731"><a href="#L-731"><span class="linenos"> 731</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-732"><a href="#L-732"><span class="linenos"> 732</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-733"><a href="#L-733"><span class="linenos"> 733</span></a><span class="sd">    Sets the working distance for the selected beam, with inputs in units of millimeters.</span>
</span><span id="L-734"><a href="#L-734"><span class="linenos"> 734</span></a>
</span><span id="L-735"><a href="#L-735"><span class="linenos"> 735</span></a><span class="sd">    This function sets the working distance (WD) for the specified beam type on the microscope.</span>
</span><span id="L-736"><a href="#L-736"><span class="linenos"> 736</span></a><span class="sd">    It converts the WD from millimeters to meters, sets the WD, and waits for the specified delay.</span>
</span><span id="L-737"><a href="#L-737"><span class="linenos"> 737</span></a><span class="sd">    This should be done before adjusting the horizontal field width.</span>
</span><span id="L-738"><a href="#L-738"><span class="linenos"> 738</span></a>
</span><span id="L-739"><a href="#L-739"><span class="linenos"> 739</span></a><span class="sd">    Parameters</span>
</span><span id="L-740"><a href="#L-740"><span class="linenos"> 740</span></a><span class="sd">    ----------</span>
</span><span id="L-741"><a href="#L-741"><span class="linenos"> 741</span></a><span class="sd">    beam : tbt.Beam</span>
</span><span id="L-742"><a href="#L-742"><span class="linenos"> 742</span></a><span class="sd">        The beam type to configure.</span>
</span><span id="L-743"><a href="#L-743"><span class="linenos"> 743</span></a><span class="sd">    microscope : tbt.Microscope</span>
</span><span id="L-744"><a href="#L-744"><span class="linenos"> 744</span></a><span class="sd">        The microscope object to configure.</span>
</span><span id="L-745"><a href="#L-745"><span class="linenos"> 745</span></a><span class="sd">    wd_mm : float</span>
</span><span id="L-746"><a href="#L-746"><span class="linenos"> 746</span></a><span class="sd">        The desired working distance in millimeters.</span>
</span><span id="L-747"><a href="#L-747"><span class="linenos"> 747</span></a><span class="sd">    delay_s : float, optional</span>
</span><span id="L-748"><a href="#L-748"><span class="linenos"> 748</span></a><span class="sd">        The delay in seconds to wait after adjusting the working distance (default is 0.1).</span>
</span><span id="L-749"><a href="#L-749"><span class="linenos"> 749</span></a>
</span><span id="L-750"><a href="#L-750"><span class="linenos"> 750</span></a><span class="sd">    Returns</span>
</span><span id="L-751"><a href="#L-751"><span class="linenos"> 751</span></a><span class="sd">    -------</span>
</span><span id="L-752"><a href="#L-752"><span class="linenos"> 752</span></a><span class="sd">    bool</span>
</span><span id="L-753"><a href="#L-753"><span class="linenos"> 753</span></a><span class="sd">        True if the working distance is set successfully, False otherwise.</span>
</span><span id="L-754"><a href="#L-754"><span class="linenos"> 754</span></a>
</span><span id="L-755"><a href="#L-755"><span class="linenos"> 755</span></a><span class="sd">    Raises</span>
</span><span id="L-756"><a href="#L-756"><span class="linenos"> 756</span></a><span class="sd">    ------</span>
</span><span id="L-757"><a href="#L-757"><span class="linenos"> 757</span></a><span class="sd">    ValueError</span>
</span><span id="L-758"><a href="#L-758"><span class="linenos"> 758</span></a><span class="sd">        If the working distance cannot be adjusted correctly.</span>
</span><span id="L-759"><a href="#L-759"><span class="linenos"> 759</span></a>
</span><span id="L-760"><a href="#L-760"><span class="linenos"> 760</span></a><span class="sd">    Examples</span>
</span><span id="L-761"><a href="#L-761"><span class="linenos"> 761</span></a><span class="sd">    --------</span>
</span><span id="L-762"><a href="#L-762"><span class="linenos"> 762</span></a><span class="sd">    &gt;&gt;&gt; import pytribeam.types as tbt</span>
</span><span id="L-763"><a href="#L-763"><span class="linenos"> 763</span></a><span class="sd">    &gt;&gt;&gt; microscope = tbt.Microscope()</span>
</span><span id="L-764"><a href="#L-764"><span class="linenos"> 764</span></a><span class="sd">    &gt;&gt;&gt; microscope.connect(&quot;localhost&quot;)</span>
</span><span id="L-765"><a href="#L-765"><span class="linenos"> 765</span></a><span class="sd">    Client connecting to [localhost:7520]...</span>
</span><span id="L-766"><a href="#L-766"><span class="linenos"> 766</span></a><span class="sd">    Client connected to [localhost:7520]</span>
</span><span id="L-767"><a href="#L-767"><span class="linenos"> 767</span></a><span class="sd">    &gt;&gt;&gt; beam = tbt.ElectronBeam(settings=None)</span>
</span><span id="L-768"><a href="#L-768"><span class="linenos"> 768</span></a><span class="sd">    &gt;&gt;&gt; success = beam_working_dist(beam, microscope, wd_mm=5.0)</span>
</span><span id="L-769"><a href="#L-769"><span class="linenos"> 769</span></a><span class="sd">    &gt;&gt;&gt; print(success)</span>
</span><span id="L-770"><a href="#L-770"><span class="linenos"> 770</span></a><span class="sd">    True</span>
</span><span id="L-771"><a href="#L-771"><span class="linenos"> 771</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-772"><a href="#L-772"><span class="linenos"> 772</span></a>    <span class="n">selected_beam</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">beam_type</span><span class="p">(</span><span class="n">beam</span><span class="p">,</span> <span class="n">microscope</span><span class="p">)</span>
</span><span id="L-773"><a href="#L-773"><span class="linenos"> 773</span></a>    <span class="n">wd_m</span> <span class="o">=</span> <span class="n">wd_mm</span> <span class="o">*</span> <span class="n">cs</span><span class="o">.</span><span class="n">Conversions</span><span class="o">.</span><span class="n">MM_TO_M</span>
</span><span id="L-774"><a href="#L-774"><span class="linenos"> 774</span></a>    <span class="n">selected_beam</span><span class="o">.</span><span class="n">working_distance</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">wd_m</span>
</span><span id="L-775"><a href="#L-775"><span class="linenos"> 775</span></a>    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">delay_s</span><span class="p">)</span>
</span><span id="L-776"><a href="#L-776"><span class="linenos"> 776</span></a>    <span class="k">if</span> <span class="n">selected_beam</span><span class="o">.</span><span class="n">working_distance</span><span class="o">.</span><span class="n">value</span> <span class="o">!=</span> <span class="n">wd_m</span><span class="p">:</span>
</span><span id="L-777"><a href="#L-777"><span class="linenos"> 777</span></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="L-778"><a href="#L-778"><span class="linenos"> 778</span></a>            <span class="sa">f</span><span class="s2">&quot;&quot;&quot;Could not correctly adjust working distance,</span>
</span><span id="L-779"><a href="#L-779"><span class="linenos"> 779</span></a><span class="s2">            requested </span><span class="si">{</span><span class="n">wd_m</span><span class="si">}</span><span class="s2"> meters, current working distance is</span>
</span><span id="L-780"><a href="#L-780"><span class="linenos"> 780</span></a><span class="s2">            </span><span class="si">{</span><span class="n">selected_beam</span><span class="o">.</span><span class="n">working_distance</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2"> meters&quot;&quot;&quot;</span>
</span><span id="L-781"><a href="#L-781"><span class="linenos"> 781</span></a>        <span class="p">)</span>
</span><span id="L-782"><a href="#L-782"><span class="linenos"> 782</span></a>
</span><span id="L-783"><a href="#L-783"><span class="linenos"> 783</span></a>    <span class="k">return</span> <span class="kc">True</span>
</span><span id="L-784"><a href="#L-784"><span class="linenos"> 784</span></a>
</span><span id="L-785"><a href="#L-785"><span class="linenos"> 785</span></a>
</span><span id="L-786"><a href="#L-786"><span class="linenos"> 786</span></a><span class="k">def</span> <span class="nf">detector_auto_cb</span><span class="p">(</span>
</span><span id="L-787"><a href="#L-787"><span class="linenos"> 787</span></a>    <span class="n">microscope</span><span class="p">:</span> <span class="n">tbt</span><span class="o">.</span><span class="n">Microscope</span><span class="p">,</span>
</span><span id="L-788"><a href="#L-788"><span class="linenos"> 788</span></a>    <span class="n">beam</span><span class="p">:</span> <span class="n">tbt</span><span class="o">.</span><span class="n">Beam</span><span class="p">,</span>
</span><span id="L-789"><a href="#L-789"><span class="linenos"> 789</span></a>    <span class="n">settings</span><span class="p">:</span> <span class="n">tbt</span><span class="o">.</span><span class="n">ScanArea</span><span class="p">,</span>
</span><span id="L-790"><a href="#L-790"><span class="linenos"> 790</span></a>    <span class="n">delay_s</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span>
</span><span id="L-791"><a href="#L-791"><span class="linenos"> 791</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-792"><a href="#L-792"><span class="linenos"> 792</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-793"><a href="#L-793"><span class="linenos"> 793</span></a><span class="sd">    Detector auto contrast brightness. Currently only reduced scan area option is supported.</span>
</span><span id="L-794"><a href="#L-794"><span class="linenos"> 794</span></a>
</span><span id="L-795"><a href="#L-795"><span class="linenos"> 795</span></a><span class="sd">    This function sets the scanning mode to reduced area, runs the auto contrast-brightness function,</span>
</span><span id="L-796"><a href="#L-796"><span class="linenos"> 796</span></a><span class="sd">    and then sets the scanning mode back to full frame.</span>
</span><span id="L-797"><a href="#L-797"><span class="linenos"> 797</span></a>
</span><span id="L-798"><a href="#L-798"><span class="linenos"> 798</span></a><span class="sd">    Parameters</span>
</span><span id="L-799"><a href="#L-799"><span class="linenos"> 799</span></a><span class="sd">    ----------</span>
</span><span id="L-800"><a href="#L-800"><span class="linenos"> 800</span></a><span class="sd">    microscope : tbt.Microscope</span>
</span><span id="L-801"><a href="#L-801"><span class="linenos"> 801</span></a><span class="sd">        The microscope object to configure.</span>
</span><span id="L-802"><a href="#L-802"><span class="linenos"> 802</span></a><span class="sd">    beam : tbt.Beam</span>
</span><span id="L-803"><a href="#L-803"><span class="linenos"> 803</span></a><span class="sd">        The beam type to configure.</span>
</span><span id="L-804"><a href="#L-804"><span class="linenos"> 804</span></a><span class="sd">    settings : tbt.ScanArea</span>
</span><span id="L-805"><a href="#L-805"><span class="linenos"> 805</span></a><span class="sd">        The scan area settings for the reduced area.</span>
</span><span id="L-806"><a href="#L-806"><span class="linenos"> 806</span></a><span class="sd">    delay_s : float, optional</span>
</span><span id="L-807"><a href="#L-807"><span class="linenos"> 807</span></a><span class="sd">        The delay in seconds to wait after each operation (default is 0.1).</span>
</span><span id="L-808"><a href="#L-808"><span class="linenos"> 808</span></a>
</span><span id="L-809"><a href="#L-809"><span class="linenos"> 809</span></a><span class="sd">    Returns</span>
</span><span id="L-810"><a href="#L-810"><span class="linenos"> 810</span></a><span class="sd">    -------</span>
</span><span id="L-811"><a href="#L-811"><span class="linenos"> 811</span></a><span class="sd">    bool</span>
</span><span id="L-812"><a href="#L-812"><span class="linenos"> 812</span></a><span class="sd">        True if the auto contrast-brightness is completed successfully, False otherwise.</span>
</span><span id="L-813"><a href="#L-813"><span class="linenos"> 813</span></a>
</span><span id="L-814"><a href="#L-814"><span class="linenos"> 814</span></a><span class="sd">    Raises</span>
</span><span id="L-815"><a href="#L-815"><span class="linenos"> 815</span></a><span class="sd">    ------</span>
</span><span id="L-816"><a href="#L-816"><span class="linenos"> 816</span></a><span class="sd">    SystemError</span>
</span><span id="L-817"><a href="#L-817"><span class="linenos"> 817</span></a><span class="sd">        If unable to set the scan mode to reduced area or full frame.</span>
</span><span id="L-818"><a href="#L-818"><span class="linenos"> 818</span></a>
</span><span id="L-819"><a href="#L-819"><span class="linenos"> 819</span></a><span class="sd">    Examples</span>
</span><span id="L-820"><a href="#L-820"><span class="linenos"> 820</span></a><span class="sd">    --------</span>
</span><span id="L-821"><a href="#L-821"><span class="linenos"> 821</span></a><span class="sd">    &gt;&gt;&gt; import pytribeam.types as tbt</span>
</span><span id="L-822"><a href="#L-822"><span class="linenos"> 822</span></a><span class="sd">    &gt;&gt;&gt; microscope = tbt.Microscope()</span>
</span><span id="L-823"><a href="#L-823"><span class="linenos"> 823</span></a><span class="sd">    &gt;&gt;&gt; microscope.connect(&quot;localhost&quot;)</span>
</span><span id="L-824"><a href="#L-824"><span class="linenos"> 824</span></a><span class="sd">    Client connecting to [localhost:7520]...</span>
</span><span id="L-825"><a href="#L-825"><span class="linenos"> 825</span></a><span class="sd">    Client connected to [localhost:7520]</span>
</span><span id="L-826"><a href="#L-826"><span class="linenos"> 826</span></a><span class="sd">    &gt;&gt;&gt; beam = tbt.ElectronBeam(settings=None)</span>
</span><span id="L-827"><a href="#L-827"><span class="linenos"> 827</span></a><span class="sd">    &gt;&gt;&gt; auto_cb_settings = tbt.ScanArea(left=0.1, top=0.1, width=0.8, height=0.8)</span>
</span><span id="L-828"><a href="#L-828"><span class="linenos"> 828</span></a><span class="sd">    &gt;&gt;&gt; success = detector_auto_cb(microscope, beam, auto_cb_settings)</span>
</span><span id="L-829"><a href="#L-829"><span class="linenos"> 829</span></a><span class="sd">    &gt;&gt;&gt; print(success)</span>
</span><span id="L-830"><a href="#L-830"><span class="linenos"> 830</span></a><span class="sd">    True</span>
</span><span id="L-831"><a href="#L-831"><span class="linenos"> 831</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-832"><a href="#L-832"><span class="linenos"> 832</span></a>    <span class="n">selected_beam</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">beam_type</span><span class="p">(</span><span class="n">beam</span><span class="p">,</span> <span class="n">microscope</span><span class="p">)</span>
</span><span id="L-833"><a href="#L-833"><span class="linenos"> 833</span></a>    <span class="n">selected_beam</span><span class="o">.</span><span class="n">scanning</span><span class="o">.</span><span class="n">mode</span><span class="o">.</span><span class="n">set_reduced_area</span><span class="p">(</span>
</span><span id="L-834"><a href="#L-834"><span class="linenos"> 834</span></a>        <span class="n">left</span><span class="o">=</span><span class="n">settings</span><span class="o">.</span><span class="n">left</span><span class="p">,</span>
</span><span id="L-835"><a href="#L-835"><span class="linenos"> 835</span></a>        <span class="n">top</span><span class="o">=</span><span class="n">settings</span><span class="o">.</span><span class="n">top</span><span class="p">,</span>
</span><span id="L-836"><a href="#L-836"><span class="linenos"> 836</span></a>        <span class="n">width</span><span class="o">=</span><span class="n">settings</span><span class="o">.</span><span class="n">width</span><span class="p">,</span>
</span><span id="L-837"><a href="#L-837"><span class="linenos"> 837</span></a>        <span class="n">height</span><span class="o">=</span><span class="n">settings</span><span class="o">.</span><span class="n">height</span><span class="p">,</span>
</span><span id="L-838"><a href="#L-838"><span class="linenos"> 838</span></a>    <span class="p">)</span>
</span><span id="L-839"><a href="#L-839"><span class="linenos"> 839</span></a>    <span class="n">scan_mode</span> <span class="o">=</span> <span class="n">selected_beam</span><span class="o">.</span><span class="n">scanning</span><span class="o">.</span><span class="n">mode</span><span class="o">.</span><span class="n">value</span>
</span><span id="L-840"><a href="#L-840"><span class="linenos"> 840</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">scan_mode</span> <span class="o">==</span> <span class="n">tbt</span><span class="o">.</span><span class="n">ScanMode</span><span class="o">.</span><span class="n">REDUCED_AREA</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>
</span><span id="L-841"><a href="#L-841"><span class="linenos"> 841</span></a>        <span class="k">raise</span> <span class="ne">SystemError</span><span class="p">(</span>
</span><span id="L-842"><a href="#L-842"><span class="linenos"> 842</span></a>            <span class="sa">f</span><span class="s2">&quot;Unable to set imaging to reduced area before auto contrast-brightness. Current scan mode is </span><span class="si">{</span><span class="n">scan_mode</span><span class="si">}</span><span class="s2">.&quot;</span>
</span><span id="L-843"><a href="#L-843"><span class="linenos"> 843</span></a>        <span class="p">)</span>
</span><span id="L-844"><a href="#L-844"><span class="linenos"> 844</span></a>    <span class="n">microscope</span><span class="o">.</span><span class="n">auto_functions</span><span class="o">.</span><span class="n">run_auto_cb</span><span class="p">()</span>
</span><span id="L-845"><a href="#L-845"><span class="linenos"> 845</span></a>    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">delay_s</span><span class="p">)</span>
</span><span id="L-846"><a href="#L-846"><span class="linenos"> 846</span></a>    <span class="n">selected_beam</span><span class="o">.</span><span class="n">scanning</span><span class="o">.</span><span class="n">mode</span><span class="o">.</span><span class="n">set_full_frame</span><span class="p">()</span>
</span><span id="L-847"><a href="#L-847"><span class="linenos"> 847</span></a>    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">delay_s</span><span class="p">)</span>
</span><span id="L-848"><a href="#L-848"><span class="linenos"> 848</span></a>
</span><span id="L-849"><a href="#L-849"><span class="linenos"> 849</span></a>    <span class="n">new_scan_mode</span> <span class="o">=</span> <span class="n">selected_beam</span><span class="o">.</span><span class="n">scanning</span><span class="o">.</span><span class="n">mode</span><span class="o">.</span><span class="n">value</span>
</span><span id="L-850"><a href="#L-850"><span class="linenos"> 850</span></a>    <span class="k">if</span> <span class="n">new_scan_mode</span> <span class="o">!=</span> <span class="n">tbt</span><span class="o">.</span><span class="n">ScanMode</span><span class="o">.</span><span class="n">FULL_FRAME</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>
</span><span id="L-851"><a href="#L-851"><span class="linenos"> 851</span></a>        <span class="k">raise</span> <span class="ne">SystemError</span><span class="p">(</span>
</span><span id="L-852"><a href="#L-852"><span class="linenos"> 852</span></a>            <span class="sa">f</span><span class="s2">&quot;Unable to set imaging back to full frame after auto contrast-brightness. Current scan mode is </span><span class="si">{</span><span class="n">new_scan_mode</span><span class="si">}</span><span class="s2">.&quot;</span>
</span><span id="L-853"><a href="#L-853"><span class="linenos"> 853</span></a>        <span class="p">)</span>
</span><span id="L-854"><a href="#L-854"><span class="linenos"> 854</span></a>    <span class="k">return</span> <span class="kc">True</span>
</span><span id="L-855"><a href="#L-855"><span class="linenos"> 855</span></a>
</span><span id="L-856"><a href="#L-856"><span class="linenos"> 856</span></a>
</span><span id="L-857"><a href="#L-857"><span class="linenos"> 857</span></a><span class="k">def</span> <span class="nf">detector_brightness</span><span class="p">(</span>
</span><span id="L-858"><a href="#L-858"><span class="linenos"> 858</span></a>    <span class="n">microscope</span><span class="p">:</span> <span class="n">tbt</span><span class="o">.</span><span class="n">Microscope</span><span class="p">,</span>
</span><span id="L-859"><a href="#L-859"><span class="linenos"> 859</span></a>    <span class="n">brightness</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="L-860"><a href="#L-860"><span class="linenos"> 860</span></a>    <span class="n">delay_s</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span>
</span><span id="L-861"><a href="#L-861"><span class="linenos"> 861</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-862"><a href="#L-862"><span class="linenos"> 862</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-863"><a href="#L-863"><span class="linenos"> 863</span></a><span class="sd">    Sets the detector brightness with input from 0 to 1.</span>
</span><span id="L-864"><a href="#L-864"><span class="linenos"> 864</span></a>
</span><span id="L-865"><a href="#L-865"><span class="linenos"> 865</span></a><span class="sd">    This function sets the brightness for the detector on the microscope and waits for the specified delay.</span>
</span><span id="L-866"><a href="#L-866"><span class="linenos"> 866</span></a>
</span><span id="L-867"><a href="#L-867"><span class="linenos"> 867</span></a><span class="sd">    Parameters</span>
</span><span id="L-868"><a href="#L-868"><span class="linenos"> 868</span></a><span class="sd">    ----------</span>
</span><span id="L-869"><a href="#L-869"><span class="linenos"> 869</span></a><span class="sd">    microscope : tbt.Microscope</span>
</span><span id="L-870"><a href="#L-870"><span class="linenos"> 870</span></a><span class="sd">        The microscope object to configure.</span>
</span><span id="L-871"><a href="#L-871"><span class="linenos"> 871</span></a><span class="sd">    brightness : float</span>
</span><span id="L-872"><a href="#L-872"><span class="linenos"> 872</span></a><span class="sd">        The desired brightness value (from 0 to 1).</span>
</span><span id="L-873"><a href="#L-873"><span class="linenos"> 873</span></a><span class="sd">    delay_s : float, optional</span>
</span><span id="L-874"><a href="#L-874"><span class="linenos"> 874</span></a><span class="sd">        The delay in seconds to wait after adjusting the brightness (default is 0.1).</span>
</span><span id="L-875"><a href="#L-875"><span class="linenos"> 875</span></a>
</span><span id="L-876"><a href="#L-876"><span class="linenos"> 876</span></a><span class="sd">    Returns</span>
</span><span id="L-877"><a href="#L-877"><span class="linenos"> 877</span></a><span class="sd">    -------</span>
</span><span id="L-878"><a href="#L-878"><span class="linenos"> 878</span></a><span class="sd">    bool</span>
</span><span id="L-879"><a href="#L-879"><span class="linenos"> 879</span></a><span class="sd">        True if the brightness is set successfully, False otherwise.</span>
</span><span id="L-880"><a href="#L-880"><span class="linenos"> 880</span></a>
</span><span id="L-881"><a href="#L-881"><span class="linenos"> 881</span></a><span class="sd">    Raises</span>
</span><span id="L-882"><a href="#L-882"><span class="linenos"> 882</span></a><span class="sd">    ------</span>
</span><span id="L-883"><a href="#L-883"><span class="linenos"> 883</span></a><span class="sd">    ValueError</span>
</span><span id="L-884"><a href="#L-884"><span class="linenos"> 884</span></a><span class="sd">        If the brightness cannot be adjusted correctly.</span>
</span><span id="L-885"><a href="#L-885"><span class="linenos"> 885</span></a>
</span><span id="L-886"><a href="#L-886"><span class="linenos"> 886</span></a><span class="sd">    Examples</span>
</span><span id="L-887"><a href="#L-887"><span class="linenos"> 887</span></a><span class="sd">    --------</span>
</span><span id="L-888"><a href="#L-888"><span class="linenos"> 888</span></a><span class="sd">    &gt;&gt;&gt; import pytribeam.types as tbt</span>
</span><span id="L-889"><a href="#L-889"><span class="linenos"> 889</span></a><span class="sd">    &gt;&gt;&gt; microscope = tbt.Microscope()</span>
</span><span id="L-890"><a href="#L-890"><span class="linenos"> 890</span></a><span class="sd">    &gt;&gt;&gt; microscope.connect(&quot;localhost&quot;)</span>
</span><span id="L-891"><a href="#L-891"><span class="linenos"> 891</span></a><span class="sd">    Client connecting to [localhost:7520]...</span>
</span><span id="L-892"><a href="#L-892"><span class="linenos"> 892</span></a><span class="sd">    Client connected to [localhost:7520]</span>
</span><span id="L-893"><a href="#L-893"><span class="linenos"> 893</span></a><span class="sd">    &gt;&gt;&gt; success = detector_brightness(microscope, brightness=0.5)</span>
</span><span id="L-894"><a href="#L-894"><span class="linenos"> 894</span></a><span class="sd">    &gt;&gt;&gt; print(success)</span>
</span><span id="L-895"><a href="#L-895"><span class="linenos"> 895</span></a><span class="sd">    True</span>
</span><span id="L-896"><a href="#L-896"><span class="linenos"> 896</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-897"><a href="#L-897"><span class="linenos"> 897</span></a>    <span class="n">microscope</span><span class="o">.</span><span class="n">detector</span><span class="o">.</span><span class="n">brightness</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">brightness</span>
</span><span id="L-898"><a href="#L-898"><span class="linenos"> 898</span></a>    <span class="n">current_detector</span> <span class="o">=</span> <span class="n">microscope</span><span class="o">.</span><span class="n">detector</span><span class="o">.</span><span class="n">type</span><span class="o">.</span><span class="n">value</span>
</span><span id="L-899"><a href="#L-899"><span class="linenos"> 899</span></a>    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">delay_s</span><span class="p">)</span>
</span><span id="L-900"><a href="#L-900"><span class="linenos"> 900</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">math</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span>
</span><span id="L-901"><a href="#L-901"><span class="linenos"> 901</span></a>        <span class="n">microscope</span><span class="o">.</span><span class="n">detector</span><span class="o">.</span><span class="n">brightness</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
</span><span id="L-902"><a href="#L-902"><span class="linenos"> 902</span></a>        <span class="n">brightness</span><span class="p">,</span>
</span><span id="L-903"><a href="#L-903"><span class="linenos"> 903</span></a>        <span class="n">abs_tol</span><span class="o">=</span><span class="n">cs</span><span class="o">.</span><span class="n">Constants</span><span class="o">.</span><span class="n">contrast_brightness_tolerance</span><span class="p">,</span>
</span><span id="L-904"><a href="#L-904"><span class="linenos"> 904</span></a>    <span class="p">):</span>
</span><span id="L-905"><a href="#L-905"><span class="linenos"> 905</span></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="L-906"><a href="#L-906"><span class="linenos"> 906</span></a>            <span class="sa">f</span><span class="s2">&quot;&quot;&quot;Could not correctly adjust detector brightness,</span>
</span><span id="L-907"><a href="#L-907"><span class="linenos"> 907</span></a><span class="s2">            requested </span><span class="si">{</span><span class="n">brightness</span><span class="si">}</span><span class="s2"> on </span><span class="si">{</span><span class="n">current_detector</span><span class="si">}</span><span class="s2"> detector, </span>
</span><span id="L-908"><a href="#L-908"><span class="linenos"> 908</span></a><span class="s2">            current brightness is </span><span class="si">{</span><span class="n">microscope</span><span class="o">.</span><span class="n">detector</span><span class="o">.</span><span class="n">brightness</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;&quot;&quot;</span>
</span><span id="L-909"><a href="#L-909"><span class="linenos"> 909</span></a>        <span class="p">)</span>
</span><span id="L-910"><a href="#L-910"><span class="linenos"> 910</span></a>    <span class="k">return</span> <span class="kc">True</span>
</span><span id="L-911"><a href="#L-911"><span class="linenos"> 911</span></a>
</span><span id="L-912"><a href="#L-912"><span class="linenos"> 912</span></a>
</span><span id="L-913"><a href="#L-913"><span class="linenos"> 913</span></a><span class="k">def</span> <span class="nf">detector_contrast</span><span class="p">(</span>
</span><span id="L-914"><a href="#L-914"><span class="linenos"> 914</span></a>    <span class="n">microscope</span><span class="p">:</span> <span class="n">tbt</span><span class="o">.</span><span class="n">Microscope</span><span class="p">,</span>
</span><span id="L-915"><a href="#L-915"><span class="linenos"> 915</span></a>    <span class="n">contrast</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="L-916"><a href="#L-916"><span class="linenos"> 916</span></a>    <span class="n">delay_s</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span>
</span><span id="L-917"><a href="#L-917"><span class="linenos"> 917</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-918"><a href="#L-918"><span class="linenos"> 918</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-919"><a href="#L-919"><span class="linenos"> 919</span></a><span class="sd">    Sets the detector contrast with input from 0 to 1.</span>
</span><span id="L-920"><a href="#L-920"><span class="linenos"> 920</span></a>
</span><span id="L-921"><a href="#L-921"><span class="linenos"> 921</span></a><span class="sd">    This function sets the contrast for the detector on the microscope and waits for the specified delay.</span>
</span><span id="L-922"><a href="#L-922"><span class="linenos"> 922</span></a>
</span><span id="L-923"><a href="#L-923"><span class="linenos"> 923</span></a><span class="sd">    Parameters</span>
</span><span id="L-924"><a href="#L-924"><span class="linenos"> 924</span></a><span class="sd">    ----------</span>
</span><span id="L-925"><a href="#L-925"><span class="linenos"> 925</span></a><span class="sd">    microscope : tbt.Microscope</span>
</span><span id="L-926"><a href="#L-926"><span class="linenos"> 926</span></a><span class="sd">        The microscope object to configure.</span>
</span><span id="L-927"><a href="#L-927"><span class="linenos"> 927</span></a><span class="sd">    contrast : float</span>
</span><span id="L-928"><a href="#L-928"><span class="linenos"> 928</span></a><span class="sd">        The desired contrast value (from 0 to 1).</span>
</span><span id="L-929"><a href="#L-929"><span class="linenos"> 929</span></a><span class="sd">    delay_s : float, optional</span>
</span><span id="L-930"><a href="#L-930"><span class="linenos"> 930</span></a><span class="sd">        The delay in seconds to wait after adjusting the contrast (default is 0.1).</span>
</span><span id="L-931"><a href="#L-931"><span class="linenos"> 931</span></a>
</span><span id="L-932"><a href="#L-932"><span class="linenos"> 932</span></a><span class="sd">    Returns</span>
</span><span id="L-933"><a href="#L-933"><span class="linenos"> 933</span></a><span class="sd">    -------</span>
</span><span id="L-934"><a href="#L-934"><span class="linenos"> 934</span></a><span class="sd">    bool</span>
</span><span id="L-935"><a href="#L-935"><span class="linenos"> 935</span></a><span class="sd">        True if the contrast is set successfully, False otherwise.</span>
</span><span id="L-936"><a href="#L-936"><span class="linenos"> 936</span></a>
</span><span id="L-937"><a href="#L-937"><span class="linenos"> 937</span></a><span class="sd">    Raises</span>
</span><span id="L-938"><a href="#L-938"><span class="linenos"> 938</span></a><span class="sd">    ------</span>
</span><span id="L-939"><a href="#L-939"><span class="linenos"> 939</span></a><span class="sd">    ValueError</span>
</span><span id="L-940"><a href="#L-940"><span class="linenos"> 940</span></a><span class="sd">        If the contrast cannot be adjusted correctly.</span>
</span><span id="L-941"><a href="#L-941"><span class="linenos"> 941</span></a>
</span><span id="L-942"><a href="#L-942"><span class="linenos"> 942</span></a><span class="sd">    Examples</span>
</span><span id="L-943"><a href="#L-943"><span class="linenos"> 943</span></a><span class="sd">    --------</span>
</span><span id="L-944"><a href="#L-944"><span class="linenos"> 944</span></a><span class="sd">    &gt;&gt;&gt; import pytribeam.types as tbt</span>
</span><span id="L-945"><a href="#L-945"><span class="linenos"> 945</span></a><span class="sd">    &gt;&gt;&gt; microscope = tbt.Microscope()</span>
</span><span id="L-946"><a href="#L-946"><span class="linenos"> 946</span></a><span class="sd">    &gt;&gt;&gt; microscope.connect(&quot;localhost&quot;)</span>
</span><span id="L-947"><a href="#L-947"><span class="linenos"> 947</span></a><span class="sd">    Client connecting to [localhost:7520]...</span>
</span><span id="L-948"><a href="#L-948"><span class="linenos"> 948</span></a><span class="sd">    Client connected to [localhost:7520]</span>
</span><span id="L-949"><a href="#L-949"><span class="linenos"> 949</span></a><span class="sd">    &gt;&gt;&gt; success = detector_contrast(microscope, contrast=0.5)</span>
</span><span id="L-950"><a href="#L-950"><span class="linenos"> 950</span></a><span class="sd">    &gt;&gt;&gt; print(success)</span>
</span><span id="L-951"><a href="#L-951"><span class="linenos"> 951</span></a><span class="sd">    True</span>
</span><span id="L-952"><a href="#L-952"><span class="linenos"> 952</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-953"><a href="#L-953"><span class="linenos"> 953</span></a>    <span class="n">microscope</span><span class="o">.</span><span class="n">detector</span><span class="o">.</span><span class="n">contrast</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">contrast</span>
</span><span id="L-954"><a href="#L-954"><span class="linenos"> 954</span></a>    <span class="n">current_detector</span> <span class="o">=</span> <span class="n">microscope</span><span class="o">.</span><span class="n">detector</span><span class="o">.</span><span class="n">type</span><span class="o">.</span><span class="n">value</span>
</span><span id="L-955"><a href="#L-955"><span class="linenos"> 955</span></a>    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">delay_s</span><span class="p">)</span>
</span><span id="L-956"><a href="#L-956"><span class="linenos"> 956</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">math</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span>
</span><span id="L-957"><a href="#L-957"><span class="linenos"> 957</span></a>        <span class="n">microscope</span><span class="o">.</span><span class="n">detector</span><span class="o">.</span><span class="n">contrast</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
</span><span id="L-958"><a href="#L-958"><span class="linenos"> 958</span></a>        <span class="n">contrast</span><span class="p">,</span>
</span><span id="L-959"><a href="#L-959"><span class="linenos"> 959</span></a>        <span class="n">abs_tol</span><span class="o">=</span><span class="n">cs</span><span class="o">.</span><span class="n">Constants</span><span class="o">.</span><span class="n">contrast_brightness_tolerance</span><span class="p">,</span>
</span><span id="L-960"><a href="#L-960"><span class="linenos"> 960</span></a>    <span class="p">):</span>
</span><span id="L-961"><a href="#L-961"><span class="linenos"> 961</span></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="L-962"><a href="#L-962"><span class="linenos"> 962</span></a>            <span class="sa">f</span><span class="s2">&quot;&quot;&quot;Could not correctly adjust detector contrast,</span>
</span><span id="L-963"><a href="#L-963"><span class="linenos"> 963</span></a><span class="s2">            requested </span><span class="si">{</span><span class="n">contrast</span><span class="si">}</span><span class="s2"> on </span><span class="si">{</span><span class="n">current_detector</span><span class="si">}</span><span class="s2"> detector, </span>
</span><span id="L-964"><a href="#L-964"><span class="linenos"> 964</span></a><span class="s2">            current contrast is </span><span class="si">{</span><span class="n">microscope</span><span class="o">.</span><span class="n">detector</span><span class="o">.</span><span class="n">contrast</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;&quot;&quot;</span>
</span><span id="L-965"><a href="#L-965"><span class="linenos"> 965</span></a>        <span class="p">)</span>
</span><span id="L-966"><a href="#L-966"><span class="linenos"> 966</span></a>    <span class="k">return</span> <span class="kc">True</span>
</span><span id="L-967"><a href="#L-967"><span class="linenos"> 967</span></a>
</span><span id="L-968"><a href="#L-968"><span class="linenos"> 968</span></a>
</span><span id="L-969"><a href="#L-969"><span class="linenos"> 969</span></a><span class="k">def</span> <span class="nf">detector_cb</span><span class="p">(</span>
</span><span id="L-970"><a href="#L-970"><span class="linenos"> 970</span></a>    <span class="n">microscope</span><span class="p">:</span> <span class="n">tbt</span><span class="o">.</span><span class="n">Microscope</span><span class="p">,</span>
</span><span id="L-971"><a href="#L-971"><span class="linenos"> 971</span></a>    <span class="n">detector_settings</span><span class="p">:</span> <span class="n">tbt</span><span class="o">.</span><span class="n">Detector</span><span class="p">,</span>
</span><span id="L-972"><a href="#L-972"><span class="linenos"> 972</span></a>    <span class="n">beam</span><span class="p">:</span> <span class="n">tbt</span><span class="o">.</span><span class="n">Beam</span><span class="p">,</span>
</span><span id="L-973"><a href="#L-973"><span class="linenos"> 973</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-974"><a href="#L-974"><span class="linenos"> 974</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-975"><a href="#L-975"><span class="linenos"> 975</span></a><span class="sd">    Sets detector contrast and brightness.</span>
</span><span id="L-976"><a href="#L-976"><span class="linenos"> 976</span></a>
</span><span id="L-977"><a href="#L-977"><span class="linenos"> 977</span></a><span class="sd">    This function sets the contrast and brightness for the detector on the microscope.</span>
</span><span id="L-978"><a href="#L-978"><span class="linenos"> 978</span></a><span class="sd">    It also runs the auto contrast-brightness function if specified in the detector settings.</span>
</span><span id="L-979"><a href="#L-979"><span class="linenos"> 979</span></a><span class="sd">    Supports initial settings of contrast and brightness with fixed values before auto adjustment.</span>
</span><span id="L-980"><a href="#L-980"><span class="linenos"> 980</span></a>
</span><span id="L-981"><a href="#L-981"><span class="linenos"> 981</span></a><span class="sd">    Parameters</span>
</span><span id="L-982"><a href="#L-982"><span class="linenos"> 982</span></a><span class="sd">    ----------</span>
</span><span id="L-983"><a href="#L-983"><span class="linenos"> 983</span></a><span class="sd">    microscope : tbt.Microscope</span>
</span><span id="L-984"><a href="#L-984"><span class="linenos"> 984</span></a><span class="sd">        The microscope object to configure.</span>
</span><span id="L-985"><a href="#L-985"><span class="linenos"> 985</span></a><span class="sd">    detector_settings : tbt.Detector</span>
</span><span id="L-986"><a href="#L-986"><span class="linenos"> 986</span></a><span class="sd">        The detector settings, including contrast, brightness, and auto contrast-brightness settings.</span>
</span><span id="L-987"><a href="#L-987"><span class="linenos"> 987</span></a><span class="sd">    beam : tbt.Beam</span>
</span><span id="L-988"><a href="#L-988"><span class="linenos"> 988</span></a><span class="sd">        The beam type to configure.</span>
</span><span id="L-989"><a href="#L-989"><span class="linenos"> 989</span></a>
</span><span id="L-990"><a href="#L-990"><span class="linenos"> 990</span></a><span class="sd">    Returns</span>
</span><span id="L-991"><a href="#L-991"><span class="linenos"> 991</span></a><span class="sd">    -------</span>
</span><span id="L-992"><a href="#L-992"><span class="linenos"> 992</span></a><span class="sd">    bool</span>
</span><span id="L-993"><a href="#L-993"><span class="linenos"> 993</span></a><span class="sd">        True if the contrast and brightness are set successfully, False otherwise.</span>
</span><span id="L-994"><a href="#L-994"><span class="linenos"> 994</span></a>
</span><span id="L-995"><a href="#L-995"><span class="linenos"> 995</span></a><span class="sd">    Examples</span>
</span><span id="L-996"><a href="#L-996"><span class="linenos"> 996</span></a><span class="sd">    --------</span>
</span><span id="L-997"><a href="#L-997"><span class="linenos"> 997</span></a><span class="sd">    &gt;&gt;&gt; import pytribeam.types as tbt</span>
</span><span id="L-998"><a href="#L-998"><span class="linenos"> 998</span></a><span class="sd">    &gt;&gt;&gt; microscope = tbt.Microscope()</span>
</span><span id="L-999"><a href="#L-999"><span class="linenos"> 999</span></a><span class="sd">    &gt;&gt;&gt; microscope.connect(&quot;localhost&quot;)</span>
</span><span id="L-1000"><a href="#L-1000"><span class="linenos">1000</span></a><span class="sd">    Client connecting to [localhost:7520]...</span>
</span><span id="L-1001"><a href="#L-1001"><span class="linenos">1001</span></a><span class="sd">    Client connected to [localhost:7520]</span>
</span><span id="L-1002"><a href="#L-1002"><span class="linenos">1002</span></a><span class="sd">    &gt;&gt;&gt; beam = tbt.ElectronBeam(settings=None)</span>
</span><span id="L-1003"><a href="#L-1003"><span class="linenos">1003</span></a><span class="sd">    &gt;&gt;&gt; detector_settings = tbt.Detector(contrast=None, brightness=None, auto_cb_settings=tbt.ScanArea(left=0.1, top=0.1, width=0.8, height=0.8))</span>
</span><span id="L-1004"><a href="#L-1004"><span class="linenos">1004</span></a><span class="sd">    &gt;&gt;&gt; success = detector_cb(microscope, detector_settings, beam)</span>
</span><span id="L-1005"><a href="#L-1005"><span class="linenos">1005</span></a><span class="sd">    &gt;&gt;&gt; print(success)</span>
</span><span id="L-1006"><a href="#L-1006"><span class="linenos">1006</span></a><span class="sd">    True</span>
</span><span id="L-1007"><a href="#L-1007"><span class="linenos">1007</span></a>
</span><span id="L-1008"><a href="#L-1008"><span class="linenos">1008</span></a><span class="sd">    &gt;&gt;&gt; detector_settings = tbt.Detector(contrast=0.2, brightness=0.3, auto_cb_settings=None)</span>
</span><span id="L-1009"><a href="#L-1009"><span class="linenos">1009</span></a><span class="sd">    &gt;&gt;&gt; success = detector_cb(microscope, detector_settings, beam)</span>
</span><span id="L-1010"><a href="#L-1010"><span class="linenos">1010</span></a><span class="sd">    &gt;&gt;&gt; print(success)</span>
</span><span id="L-1011"><a href="#L-1011"><span class="linenos">1011</span></a><span class="sd">    True</span>
</span><span id="L-1012"><a href="#L-1012"><span class="linenos">1012</span></a><span class="sd">    &gt;&gt;&gt; beam_brightness = microscope.detector.brightness.value</span>
</span><span id="L-1013"><a href="#L-1013"><span class="linenos">1013</span></a><span class="sd">    &gt;&gt;&gt; print(beam_brightness)</span>
</span><span id="L-1014"><a href="#L-1014"><span class="linenos">1014</span></a><span class="sd">    0.3</span>
</span><span id="L-1015"><a href="#L-1015"><span class="linenos">1015</span></a><span class="sd">    &gt;&gt;&gt; beam_contrast = microscope.detector.contrast.value</span>
</span><span id="L-1016"><a href="#L-1016"><span class="linenos">1016</span></a><span class="sd">    &gt;&gt;&gt; print(beam_contrast)</span>
</span><span id="L-1017"><a href="#L-1017"><span class="linenos">1017</span></a><span class="sd">    0.2</span>
</span><span id="L-1018"><a href="#L-1018"><span class="linenos">1018</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1019"><a href="#L-1019"><span class="linenos">1019</span></a>    <span class="c1">### cannot ensure detector is the active one, will overwrite mode settings, so following line is not used</span>
</span><span id="L-1020"><a href="#L-1020"><span class="linenos">1020</span></a>    <span class="c1"># microscope.detector.type.value = detector_settings.type.value</span>
</span><span id="L-1021"><a href="#L-1021"><span class="linenos">1021</span></a>    <span class="n">contrast</span> <span class="o">=</span> <span class="n">detector_settings</span><span class="o">.</span><span class="n">contrast</span>
</span><span id="L-1022"><a href="#L-1022"><span class="linenos">1022</span></a>    <span class="n">brightness</span> <span class="o">=</span> <span class="n">detector_settings</span><span class="o">.</span><span class="n">brightness</span>
</span><span id="L-1023"><a href="#L-1023"><span class="linenos">1023</span></a>    <span class="k">if</span> <span class="n">contrast</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1024"><a href="#L-1024"><span class="linenos">1024</span></a>        <span class="n">detector_contrast</span><span class="p">(</span><span class="n">microscope</span><span class="o">=</span><span class="n">microscope</span><span class="p">,</span> <span class="n">contrast</span><span class="o">=</span><span class="n">contrast</span><span class="p">)</span>
</span><span id="L-1025"><a href="#L-1025"><span class="linenos">1025</span></a>    <span class="k">if</span> <span class="n">brightness</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1026"><a href="#L-1026"><span class="linenos">1026</span></a>        <span class="n">detector_brightness</span><span class="p">(</span><span class="n">microscope</span><span class="o">=</span><span class="n">microscope</span><span class="p">,</span> <span class="n">brightness</span><span class="o">=</span><span class="n">brightness</span><span class="p">)</span>
</span><span id="L-1027"><a href="#L-1027"><span class="linenos">1027</span></a>
</span><span id="L-1028"><a href="#L-1028"><span class="linenos">1028</span></a>    <span class="n">null_scan</span> <span class="o">=</span> <span class="n">tbt</span><span class="o">.</span><span class="n">ScanArea</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</span><span id="L-1029"><a href="#L-1029"><span class="linenos">1029</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">null_scan</span> <span class="o">==</span> <span class="n">detector_settings</span><span class="o">.</span><span class="n">auto_cb_settings</span><span class="p">:</span>
</span><span id="L-1030"><a href="#L-1030"><span class="linenos">1030</span></a>        <span class="n">detector_auto_cb</span><span class="p">(</span>
</span><span id="L-1031"><a href="#L-1031"><span class="linenos">1031</span></a>            <span class="n">microscope</span><span class="o">=</span><span class="n">microscope</span><span class="p">,</span>
</span><span id="L-1032"><a href="#L-1032"><span class="linenos">1032</span></a>            <span class="n">settings</span><span class="o">=</span><span class="n">detector_settings</span><span class="o">.</span><span class="n">auto_cb_settings</span><span class="p">,</span>
</span><span id="L-1033"><a href="#L-1033"><span class="linenos">1033</span></a>            <span class="n">beam</span><span class="o">=</span><span class="n">beam</span><span class="p">,</span>
</span><span id="L-1034"><a href="#L-1034"><span class="linenos">1034</span></a>        <span class="p">)</span>
</span><span id="L-1035"><a href="#L-1035"><span class="linenos">1035</span></a>    <span class="k">return</span> <span class="kc">True</span>
</span><span id="L-1036"><a href="#L-1036"><span class="linenos">1036</span></a>
</span><span id="L-1037"><a href="#L-1037"><span class="linenos">1037</span></a>
</span><span id="L-1038"><a href="#L-1038"><span class="linenos">1038</span></a><span class="k">def</span> <span class="nf">detector_mode</span><span class="p">(</span>
</span><span id="L-1039"><a href="#L-1039"><span class="linenos">1039</span></a>    <span class="n">microscope</span><span class="p">:</span> <span class="n">tbt</span><span class="o">.</span><span class="n">Microscope</span><span class="p">,</span>
</span><span id="L-1040"><a href="#L-1040"><span class="linenos">1040</span></a>    <span class="n">detector_mode</span><span class="p">:</span> <span class="n">tbt</span><span class="o">.</span><span class="n">DetectorMode</span><span class="p">,</span>
</span><span id="L-1041"><a href="#L-1041"><span class="linenos">1041</span></a>    <span class="n">delay_s</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span>
</span><span id="L-1042"><a href="#L-1042"><span class="linenos">1042</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-1043"><a href="#L-1043"><span class="linenos">1043</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1044"><a href="#L-1044"><span class="linenos">1044</span></a><span class="sd">    Sets the detector mode.</span>
</span><span id="L-1045"><a href="#L-1045"><span class="linenos">1045</span></a>
</span><span id="L-1046"><a href="#L-1046"><span class="linenos">1046</span></a><span class="sd">    This function sets the mode for the detector on the microscope and waits for the specified delay.</span>
</span><span id="L-1047"><a href="#L-1047"><span class="linenos">1047</span></a>
</span><span id="L-1048"><a href="#L-1048"><span class="linenos">1048</span></a><span class="sd">    Parameters</span>
</span><span id="L-1049"><a href="#L-1049"><span class="linenos">1049</span></a><span class="sd">    ----------</span>
</span><span id="L-1050"><a href="#L-1050"><span class="linenos">1050</span></a><span class="sd">    microscope : tbt.Microscope</span>
</span><span id="L-1051"><a href="#L-1051"><span class="linenos">1051</span></a><span class="sd">        The microscope object to configure.</span>
</span><span id="L-1052"><a href="#L-1052"><span class="linenos">1052</span></a><span class="sd">    detector_mode : tbt.DetectorMode</span>
</span><span id="L-1053"><a href="#L-1053"><span class="linenos">1053</span></a><span class="sd">        The desired detector mode.</span>
</span><span id="L-1054"><a href="#L-1054"><span class="linenos">1054</span></a><span class="sd">    delay_s : float, optional</span>
</span><span id="L-1055"><a href="#L-1055"><span class="linenos">1055</span></a><span class="sd">        The delay in seconds to wait after setting the detector mode (default is 0.1).</span>
</span><span id="L-1056"><a href="#L-1056"><span class="linenos">1056</span></a>
</span><span id="L-1057"><a href="#L-1057"><span class="linenos">1057</span></a><span class="sd">    Returns</span>
</span><span id="L-1058"><a href="#L-1058"><span class="linenos">1058</span></a><span class="sd">    -------</span>
</span><span id="L-1059"><a href="#L-1059"><span class="linenos">1059</span></a><span class="sd">    bool</span>
</span><span id="L-1060"><a href="#L-1060"><span class="linenos">1060</span></a><span class="sd">        True if the detector mode is set successfully, False otherwise.</span>
</span><span id="L-1061"><a href="#L-1061"><span class="linenos">1061</span></a>
</span><span id="L-1062"><a href="#L-1062"><span class="linenos">1062</span></a><span class="sd">    Raises</span>
</span><span id="L-1063"><a href="#L-1063"><span class="linenos">1063</span></a><span class="sd">    ------</span>
</span><span id="L-1064"><a href="#L-1064"><span class="linenos">1064</span></a><span class="sd">    ValueError</span>
</span><span id="L-1065"><a href="#L-1065"><span class="linenos">1065</span></a><span class="sd">        If the detector mode cannot be set correctly.</span>
</span><span id="L-1066"><a href="#L-1066"><span class="linenos">1066</span></a>
</span><span id="L-1067"><a href="#L-1067"><span class="linenos">1067</span></a><span class="sd">    Examples</span>
</span><span id="L-1068"><a href="#L-1068"><span class="linenos">1068</span></a><span class="sd">    --------</span>
</span><span id="L-1069"><a href="#L-1069"><span class="linenos">1069</span></a><span class="sd">    &gt;&gt;&gt; import pytribeam.types as tbt</span>
</span><span id="L-1070"><a href="#L-1070"><span class="linenos">1070</span></a><span class="sd">    &gt;&gt;&gt; microscope = tbt.Microscope()</span>
</span><span id="L-1071"><a href="#L-1071"><span class="linenos">1071</span></a><span class="sd">    &gt;&gt;&gt; microscope.connect(&quot;localhost&quot;)</span>
</span><span id="L-1072"><a href="#L-1072"><span class="linenos">1072</span></a><span class="sd">    Client connecting to [localhost:7520]...</span>
</span><span id="L-1073"><a href="#L-1073"><span class="linenos">1073</span></a><span class="sd">    Client connected to [localhost:7520]</span>
</span><span id="L-1074"><a href="#L-1074"><span class="linenos">1074</span></a><span class="sd">    &gt;&gt;&gt; mode = tbt.DetectorMode.SECONDARY_ELECTRONS</span>
</span><span id="L-1075"><a href="#L-1075"><span class="linenos">1075</span></a><span class="sd">    &gt;&gt;&gt; success = detector_mode(microscope, mode)</span>
</span><span id="L-1076"><a href="#L-1076"><span class="linenos">1076</span></a><span class="sd">    &gt;&gt;&gt; print(success)</span>
</span><span id="L-1077"><a href="#L-1077"><span class="linenos">1077</span></a><span class="sd">    True</span>
</span><span id="L-1078"><a href="#L-1078"><span class="linenos">1078</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1079"><a href="#L-1079"><span class="linenos">1079</span></a>    <span class="n">microscope</span><span class="o">.</span><span class="n">detector</span><span class="o">.</span><span class="n">mode</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">detector_mode</span><span class="o">.</span><span class="n">value</span>
</span><span id="L-1080"><a href="#L-1080"><span class="linenos">1080</span></a>    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">delay_s</span><span class="p">)</span>
</span><span id="L-1081"><a href="#L-1081"><span class="linenos">1081</span></a>    <span class="k">if</span> <span class="n">microscope</span><span class="o">.</span><span class="n">detector</span><span class="o">.</span><span class="n">mode</span><span class="o">.</span><span class="n">value</span> <span class="o">!=</span> <span class="n">detector_mode</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>
</span><span id="L-1082"><a href="#L-1082"><span class="linenos">1082</span></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="L-1083"><a href="#L-1083"><span class="linenos">1083</span></a>            <span class="sa">f</span><span class="s2">&quot;&quot;&quot;Could not correctly set detector mode,</span>
</span><span id="L-1084"><a href="#L-1084"><span class="linenos">1084</span></a><span class="s2">            requested </span><span class="si">{</span><span class="n">detector_mode</span><span class="si">}</span><span class="s2">, current mode is</span>
</span><span id="L-1085"><a href="#L-1085"><span class="linenos">1085</span></a><span class="s2">            </span><span class="si">{</span><span class="n">microscope</span><span class="o">.</span><span class="n">detector</span><span class="o">.</span><span class="n">mode</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;&quot;&quot;</span>
</span><span id="L-1086"><a href="#L-1086"><span class="linenos">1086</span></a>        <span class="p">)</span>
</span><span id="L-1087"><a href="#L-1087"><span class="linenos">1087</span></a>    <span class="k">return</span> <span class="kc">True</span>
</span><span id="L-1088"><a href="#L-1088"><span class="linenos">1088</span></a>
</span><span id="L-1089"><a href="#L-1089"><span class="linenos">1089</span></a>
</span><span id="L-1090"><a href="#L-1090"><span class="linenos">1090</span></a><span class="k">def</span> <span class="nf">detector_type</span><span class="p">(</span>
</span><span id="L-1091"><a href="#L-1091"><span class="linenos">1091</span></a>    <span class="n">microscope</span><span class="p">:</span> <span class="n">tbt</span><span class="o">.</span><span class="n">Microscope</span><span class="p">,</span>
</span><span id="L-1092"><a href="#L-1092"><span class="linenos">1092</span></a>    <span class="n">detector</span><span class="p">:</span> <span class="n">tbt</span><span class="o">.</span><span class="n">DetectorType</span><span class="p">,</span>
</span><span id="L-1093"><a href="#L-1093"><span class="linenos">1093</span></a>    <span class="n">delay_s</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span>
</span><span id="L-1094"><a href="#L-1094"><span class="linenos">1094</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-1095"><a href="#L-1095"><span class="linenos">1095</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1096"><a href="#L-1096"><span class="linenos">1096</span></a><span class="sd">    Sets the detector type.</span>
</span><span id="L-1097"><a href="#L-1097"><span class="linenos">1097</span></a>
</span><span id="L-1098"><a href="#L-1098"><span class="linenos">1098</span></a><span class="sd">    This function sets the type for the detector on the microscope and waits for the specified delay.</span>
</span><span id="L-1099"><a href="#L-1099"><span class="linenos">1099</span></a>
</span><span id="L-1100"><a href="#L-1100"><span class="linenos">1100</span></a><span class="sd">    Parameters</span>
</span><span id="L-1101"><a href="#L-1101"><span class="linenos">1101</span></a><span class="sd">    ----------</span>
</span><span id="L-1102"><a href="#L-1102"><span class="linenos">1102</span></a><span class="sd">    microscope : tbt.Microscope</span>
</span><span id="L-1103"><a href="#L-1103"><span class="linenos">1103</span></a><span class="sd">        The microscope object to configure.</span>
</span><span id="L-1104"><a href="#L-1104"><span class="linenos">1104</span></a><span class="sd">    detector : tbt.DetectorType</span>
</span><span id="L-1105"><a href="#L-1105"><span class="linenos">1105</span></a><span class="sd">        The desired detector type.</span>
</span><span id="L-1106"><a href="#L-1106"><span class="linenos">1106</span></a><span class="sd">    delay_s : float, optional</span>
</span><span id="L-1107"><a href="#L-1107"><span class="linenos">1107</span></a><span class="sd">        The delay in seconds to wait after setting the detector type (default is 0.1).</span>
</span><span id="L-1108"><a href="#L-1108"><span class="linenos">1108</span></a>
</span><span id="L-1109"><a href="#L-1109"><span class="linenos">1109</span></a><span class="sd">    Returns</span>
</span><span id="L-1110"><a href="#L-1110"><span class="linenos">1110</span></a><span class="sd">    -------</span>
</span><span id="L-1111"><a href="#L-1111"><span class="linenos">1111</span></a><span class="sd">    bool</span>
</span><span id="L-1112"><a href="#L-1112"><span class="linenos">1112</span></a><span class="sd">        True if the detector type is set successfully, False otherwise.</span>
</span><span id="L-1113"><a href="#L-1113"><span class="linenos">1113</span></a>
</span><span id="L-1114"><a href="#L-1114"><span class="linenos">1114</span></a><span class="sd">    Raises</span>
</span><span id="L-1115"><a href="#L-1115"><span class="linenos">1115</span></a><span class="sd">    ------</span>
</span><span id="L-1116"><a href="#L-1116"><span class="linenos">1116</span></a><span class="sd">    ValueError</span>
</span><span id="L-1117"><a href="#L-1117"><span class="linenos">1117</span></a><span class="sd">        If the detector type cannot be set correctly.</span>
</span><span id="L-1118"><a href="#L-1118"><span class="linenos">1118</span></a>
</span><span id="L-1119"><a href="#L-1119"><span class="linenos">1119</span></a><span class="sd">    Examples</span>
</span><span id="L-1120"><a href="#L-1120"><span class="linenos">1120</span></a><span class="sd">    --------</span>
</span><span id="L-1121"><a href="#L-1121"><span class="linenos">1121</span></a><span class="sd">    &gt;&gt;&gt; import pytribeam.types as tbt</span>
</span><span id="L-1122"><a href="#L-1122"><span class="linenos">1122</span></a><span class="sd">    &gt;&gt;&gt; microscope = tbt.Microscope()</span>
</span><span id="L-1123"><a href="#L-1123"><span class="linenos">1123</span></a><span class="sd">    &gt;&gt;&gt; microscope.connect(&quot;localhost&quot;)</span>
</span><span id="L-1124"><a href="#L-1124"><span class="linenos">1124</span></a><span class="sd">    Client connecting to [localhost:7520]...</span>
</span><span id="L-1125"><a href="#L-1125"><span class="linenos">1125</span></a><span class="sd">    Client connected to [localhost:7520]</span>
</span><span id="L-1126"><a href="#L-1126"><span class="linenos">1126</span></a><span class="sd">    &gt;&gt;&gt; detector = tbt.DetectorType.ETD</span>
</span><span id="L-1127"><a href="#L-1127"><span class="linenos">1127</span></a><span class="sd">    &gt;&gt;&gt; success = detector_type(microscope, detector)</span>
</span><span id="L-1128"><a href="#L-1128"><span class="linenos">1128</span></a><span class="sd">    &gt;&gt;&gt; print(success)</span>
</span><span id="L-1129"><a href="#L-1129"><span class="linenos">1129</span></a><span class="sd">    True</span>
</span><span id="L-1130"><a href="#L-1130"><span class="linenos">1130</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1131"><a href="#L-1131"><span class="linenos">1131</span></a>    <span class="n">microscope</span><span class="o">.</span><span class="n">detector</span><span class="o">.</span><span class="n">type</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">detector</span><span class="o">.</span><span class="n">value</span>
</span><span id="L-1132"><a href="#L-1132"><span class="linenos">1132</span></a>    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">delay_s</span><span class="p">)</span>
</span><span id="L-1133"><a href="#L-1133"><span class="linenos">1133</span></a>    <span class="k">if</span> <span class="n">microscope</span><span class="o">.</span><span class="n">detector</span><span class="o">.</span><span class="n">type</span><span class="o">.</span><span class="n">value</span> <span class="o">!=</span> <span class="n">detector</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>
</span><span id="L-1134"><a href="#L-1134"><span class="linenos">1134</span></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="L-1135"><a href="#L-1135"><span class="linenos">1135</span></a>            <span class="sa">f</span><span class="s2">&quot;&quot;&quot;Could not correctly set detector type,</span>
</span><span id="L-1136"><a href="#L-1136"><span class="linenos">1136</span></a><span class="s2">            requested </span><span class="si">{</span><span class="n">detector</span><span class="si">}</span><span class="s2">, current detector is</span>
</span><span id="L-1137"><a href="#L-1137"><span class="linenos">1137</span></a><span class="s2">            </span><span class="si">{</span><span class="n">microscope</span><span class="o">.</span><span class="n">detector</span><span class="o">.</span><span class="n">type</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;&quot;&quot;</span>
</span><span id="L-1138"><a href="#L-1138"><span class="linenos">1138</span></a>        <span class="p">)</span>
</span><span id="L-1139"><a href="#L-1139"><span class="linenos">1139</span></a>    <span class="k">return</span> <span class="kc">True</span>
</span><span id="L-1140"><a href="#L-1140"><span class="linenos">1140</span></a>
</span><span id="L-1141"><a href="#L-1141"><span class="linenos">1141</span></a>
</span><span id="L-1142"><a href="#L-1142"><span class="linenos">1142</span></a><span class="k">def</span> <span class="nf">grab_custom_resolution_frame</span><span class="p">(</span>
</span><span id="L-1143"><a href="#L-1143"><span class="linenos">1143</span></a>    <span class="n">img_settings</span><span class="p">:</span> <span class="n">tbt</span><span class="o">.</span><span class="n">ImageSettings</span><span class="p">,</span>
</span><span id="L-1144"><a href="#L-1144"><span class="linenos">1144</span></a>    <span class="n">save_path</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span>
</span><span id="L-1145"><a href="#L-1145"><span class="linenos">1145</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-1146"><a href="#L-1146"><span class="linenos">1146</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1147"><a href="#L-1147"><span class="linenos">1147</span></a><span class="sd">    Method for single frame imaging used with custom resolutions.</span>
</span><span id="L-1148"><a href="#L-1148"><span class="linenos">1148</span></a>
</span><span id="L-1149"><a href="#L-1149"><span class="linenos">1149</span></a><span class="sd">    This function captures a single frame image using custom resolutions and saves it to the specified path.</span>
</span><span id="L-1150"><a href="#L-1150"><span class="linenos">1150</span></a>
</span><span id="L-1151"><a href="#L-1151"><span class="linenos">1151</span></a><span class="sd">    Parameters</span>
</span><span id="L-1152"><a href="#L-1152"><span class="linenos">1152</span></a><span class="sd">    ----------</span>
</span><span id="L-1153"><a href="#L-1153"><span class="linenos">1153</span></a><span class="sd">    img_settings : tbt.ImageSettings</span>
</span><span id="L-1154"><a href="#L-1154"><span class="linenos">1154</span></a><span class="sd">        The image settings, including the microscope and scan resolution.</span>
</span><span id="L-1155"><a href="#L-1155"><span class="linenos">1155</span></a><span class="sd">    save_path : Path</span>
</span><span id="L-1156"><a href="#L-1156"><span class="linenos">1156</span></a><span class="sd">        The path to save the captured image.</span>
</span><span id="L-1157"><a href="#L-1157"><span class="linenos">1157</span></a>
</span><span id="L-1158"><a href="#L-1158"><span class="linenos">1158</span></a><span class="sd">    Returns</span>
</span><span id="L-1159"><a href="#L-1159"><span class="linenos">1159</span></a><span class="sd">    -------</span>
</span><span id="L-1160"><a href="#L-1160"><span class="linenos">1160</span></a><span class="sd">    bool</span>
</span><span id="L-1161"><a href="#L-1161"><span class="linenos">1161</span></a><span class="sd">        True if the image is captured and saved successfully, False otherwise.</span>
</span><span id="L-1162"><a href="#L-1162"><span class="linenos">1162</span></a>
</span><span id="L-1163"><a href="#L-1163"><span class="linenos">1163</span></a><span class="sd">    Examples</span>
</span><span id="L-1164"><a href="#L-1164"><span class="linenos">1164</span></a><span class="sd">    --------</span>
</span><span id="L-1165"><a href="#L-1165"><span class="linenos">1165</span></a><span class="sd">    &gt;&gt;&gt; import pytribeam.types as tbt</span>
</span><span id="L-1166"><a href="#L-1166"><span class="linenos">1166</span></a><span class="sd">    &gt;&gt;&gt; from pathlib import Path</span>
</span><span id="L-1167"><a href="#L-1167"><span class="linenos">1167</span></a><span class="sd">    &gt;&gt;&gt; microscope = tbt.Microscope()</span>
</span><span id="L-1168"><a href="#L-1168"><span class="linenos">1168</span></a><span class="sd">    &gt;&gt;&gt; microscope.connect(&quot;localhost&quot;)</span>
</span><span id="L-1169"><a href="#L-1169"><span class="linenos">1169</span></a><span class="sd">    Client connecting to [localhost:7520]...</span>
</span><span id="L-1170"><a href="#L-1170"><span class="linenos">1170</span></a><span class="sd">    Client connected to [localhost:7520]</span>
</span><span id="L-1171"><a href="#L-1171"><span class="linenos">1171</span></a><span class="sd">    &gt;&gt;&gt; img_settings = tbt.ImageSettings(</span>
</span><span id="L-1172"><a href="#L-1172"><span class="linenos">1172</span></a><span class="sd">    ...     microscope=microscope,</span>
</span><span id="L-1173"><a href="#L-1173"><span class="linenos">1173</span></a><span class="sd">    ...     beam=tbt.ElectronBeam(settings=None),</span>
</span><span id="L-1174"><a href="#L-1174"><span class="linenos">1174</span></a><span class="sd">    ...     detector=tbt.Detector(),</span>
</span><span id="L-1175"><a href="#L-1175"><span class="linenos">1175</span></a><span class="sd">    ...     scan=tbt.Scan(resolution=tbt.Resolution(width=1024, height=768)),</span>
</span><span id="L-1176"><a href="#L-1176"><span class="linenos">1176</span></a><span class="sd">    ...     bit_depth=tbt.ColorDepth.BITS_8,</span>
</span><span id="L-1177"><a href="#L-1177"><span class="linenos">1177</span></a><span class="sd">    ... )</span>
</span><span id="L-1178"><a href="#L-1178"><span class="linenos">1178</span></a><span class="sd">    &gt;&gt;&gt; save_path = Path(&quot;/path/to/save/image.tif&quot;)</span>
</span><span id="L-1179"><a href="#L-1179"><span class="linenos">1179</span></a><span class="sd">    &gt;&gt;&gt; success = grab_custom_resolution_frame(img_settings, save_path)</span>
</span><span id="L-1180"><a href="#L-1180"><span class="linenos">1180</span></a><span class="sd">    &gt;&gt;&gt; print(success)</span>
</span><span id="L-1181"><a href="#L-1181"><span class="linenos">1181</span></a><span class="sd">    True</span>
</span><span id="L-1182"><a href="#L-1182"><span class="linenos">1182</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1183"><a href="#L-1183"><span class="linenos">1183</span></a>    <span class="n">microscope</span> <span class="o">=</span> <span class="n">img_settings</span><span class="o">.</span><span class="n">microscope</span>
</span><span id="L-1184"><a href="#L-1184"><span class="linenos">1184</span></a>    <span class="n">resolution</span> <span class="o">=</span> <span class="n">img_settings</span><span class="o">.</span><span class="n">scan</span><span class="o">.</span><span class="n">resolution</span>
</span><span id="L-1185"><a href="#L-1185"><span class="linenos">1185</span></a>    <span class="n">microscope</span><span class="o">.</span><span class="n">imaging</span><span class="o">.</span><span class="n">grab_frame_to_disk</span><span class="p">(</span>
</span><span id="L-1186"><a href="#L-1186"><span class="linenos">1186</span></a>        <span class="n">save_path</span><span class="o">.</span><span class="n">absolute</span><span class="p">()</span><span class="o">.</span><span class="n">as_posix</span><span class="p">(),</span>
</span><span id="L-1187"><a href="#L-1187"><span class="linenos">1187</span></a>        <span class="n">file_format</span><span class="o">=</span><span class="n">tbt</span><span class="o">.</span><span class="n">ImageFileFormat</span><span class="o">.</span><span class="n">TIFF</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
</span><span id="L-1188"><a href="#L-1188"><span class="linenos">1188</span></a>        <span class="n">settings</span><span class="o">=</span><span class="n">tbt</span><span class="o">.</span><span class="n">GrabFrameSettings</span><span class="p">(</span>
</span><span id="L-1189"><a href="#L-1189"><span class="linenos">1189</span></a>            <span class="n">resolution</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">resolution</span><span class="o">.</span><span class="n">width</span><span class="si">}</span><span class="s2">x</span><span class="si">{</span><span class="n">resolution</span><span class="o">.</span><span class="n">height</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="L-1190"><a href="#L-1190"><span class="linenos">1190</span></a>        <span class="p">),</span>
</span><span id="L-1191"><a href="#L-1191"><span class="linenos">1191</span></a>    <span class="p">)</span>
</span><span id="L-1192"><a href="#L-1192"><span class="linenos">1192</span></a>    <span class="k">return</span> <span class="kc">True</span>
</span><span id="L-1193"><a href="#L-1193"><span class="linenos">1193</span></a>
</span><span id="L-1194"><a href="#L-1194"><span class="linenos">1194</span></a>
</span><span id="L-1195"><a href="#L-1195"><span class="linenos">1195</span></a><span class="k">def</span> <span class="nf">grab_preset_resolution_frame</span><span class="p">(</span>
</span><span id="L-1196"><a href="#L-1196"><span class="linenos">1196</span></a>    <span class="n">img_settings</span><span class="p">:</span> <span class="n">tbt</span><span class="o">.</span><span class="n">ImageSettings</span><span class="p">,</span>
</span><span id="L-1197"><a href="#L-1197"><span class="linenos">1197</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">tbt</span><span class="o">.</span><span class="n">AdornedImage</span><span class="p">:</span>
</span><span id="L-1198"><a href="#L-1198"><span class="linenos">1198</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1199"><a href="#L-1199"><span class="linenos">1199</span></a><span class="sd">    Method for single frame imaging used with preset resolutions.</span>
</span><span id="L-1200"><a href="#L-1200"><span class="linenos">1200</span></a>
</span><span id="L-1201"><a href="#L-1201"><span class="linenos">1201</span></a><span class="sd">    This function captures a single frame image using preset resolutions.</span>
</span><span id="L-1202"><a href="#L-1202"><span class="linenos">1202</span></a>
</span><span id="L-1203"><a href="#L-1203"><span class="linenos">1203</span></a><span class="sd">    Parameters</span>
</span><span id="L-1204"><a href="#L-1204"><span class="linenos">1204</span></a><span class="sd">    ----------</span>
</span><span id="L-1205"><a href="#L-1205"><span class="linenos">1205</span></a><span class="sd">    img_settings : tbt.ImageSettings</span>
</span><span id="L-1206"><a href="#L-1206"><span class="linenos">1206</span></a><span class="sd">        The image settings, including the microscope, beam, detector, and scan resolution.</span>
</span><span id="L-1207"><a href="#L-1207"><span class="linenos">1207</span></a>
</span><span id="L-1208"><a href="#L-1208"><span class="linenos">1208</span></a><span class="sd">    Returns</span>
</span><span id="L-1209"><a href="#L-1209"><span class="linenos">1209</span></a><span class="sd">    -------</span>
</span><span id="L-1210"><a href="#L-1210"><span class="linenos">1210</span></a><span class="sd">    tbt.AdornedImage</span>
</span><span id="L-1211"><a href="#L-1211"><span class="linenos">1211</span></a><span class="sd">        The captured image.</span>
</span><span id="L-1212"><a href="#L-1212"><span class="linenos">1212</span></a>
</span><span id="L-1213"><a href="#L-1213"><span class="linenos">1213</span></a><span class="sd">    Examples</span>
</span><span id="L-1214"><a href="#L-1214"><span class="linenos">1214</span></a><span class="sd">    --------</span>
</span><span id="L-1215"><a href="#L-1215"><span class="linenos">1215</span></a><span class="sd">    &gt;&gt;&gt; import pytribeam.types as tbt</span>
</span><span id="L-1216"><a href="#L-1216"><span class="linenos">1216</span></a><span class="sd">    &gt;&gt;&gt; microscope = tbt.Microscope()</span>
</span><span id="L-1217"><a href="#L-1217"><span class="linenos">1217</span></a><span class="sd">    &gt;&gt;&gt; microscope.connect(&quot;localhost&quot;)</span>
</span><span id="L-1218"><a href="#L-1218"><span class="linenos">1218</span></a><span class="sd">    Client connecting to [localhost:7520]...</span>
</span><span id="L-1219"><a href="#L-1219"><span class="linenos">1219</span></a><span class="sd">    Client connected to [localhost:7520]</span>
</span><span id="L-1220"><a href="#L-1220"><span class="linenos">1220</span></a><span class="sd">    &gt;&gt;&gt; img_settings = tbt.ImageSettings(</span>
</span><span id="L-1221"><a href="#L-1221"><span class="linenos">1221</span></a><span class="sd">    ...     microscope=microscope,</span>
</span><span id="L-1222"><a href="#L-1222"><span class="linenos">1222</span></a><span class="sd">    ...     beam=tbt.ElectronBeam(settings=None),</span>
</span><span id="L-1223"><a href="#L-1223"><span class="linenos">1223</span></a><span class="sd">    ...     detector=tbt.Detector(),</span>
</span><span id="L-1224"><a href="#L-1224"><span class="linenos">1224</span></a><span class="sd">    ...     scan=tbt.Scan(resolution=tbt.PresetResolution.PRESET_768X512),</span>
</span><span id="L-1225"><a href="#L-1225"><span class="linenos">1225</span></a><span class="sd">    ...     bit_depth=tbt.ColorDepth.BITS_8,</span>
</span><span id="L-1226"><a href="#L-1226"><span class="linenos">1226</span></a><span class="sd">    ... )</span>
</span><span id="L-1227"><a href="#L-1227"><span class="linenos">1227</span></a><span class="sd">    &gt;&gt;&gt; image = grab_preset_resolution_frame(img_settings)</span>
</span><span id="L-1228"><a href="#L-1228"><span class="linenos">1228</span></a><span class="sd">    &gt;&gt;&gt; print(image)</span>
</span><span id="L-1229"><a href="#L-1229"><span class="linenos">1229</span></a><span class="sd">    AdornedImage(width=768, height=512, bit_depth=8)</span>
</span><span id="L-1230"><a href="#L-1230"><span class="linenos">1230</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1231"><a href="#L-1231"><span class="linenos">1231</span></a>    <span class="n">beam</span> <span class="o">=</span> <span class="n">img_settings</span><span class="o">.</span><span class="n">beam</span>
</span><span id="L-1232"><a href="#L-1232"><span class="linenos">1232</span></a>    <span class="n">microscope</span> <span class="o">=</span> <span class="n">img_settings</span><span class="o">.</span><span class="n">microscope</span>
</span><span id="L-1233"><a href="#L-1233"><span class="linenos">1233</span></a>    <span class="n">beam_scan_resolution</span><span class="p">(</span>
</span><span id="L-1234"><a href="#L-1234"><span class="linenos">1234</span></a>        <span class="n">beam</span><span class="o">=</span><span class="n">beam</span><span class="p">,</span>
</span><span id="L-1235"><a href="#L-1235"><span class="linenos">1235</span></a>        <span class="n">microscope</span><span class="o">=</span><span class="n">microscope</span><span class="p">,</span>
</span><span id="L-1236"><a href="#L-1236"><span class="linenos">1236</span></a>        <span class="n">resolution</span><span class="o">=</span><span class="n">img_settings</span><span class="o">.</span><span class="n">scan</span><span class="o">.</span><span class="n">resolution</span><span class="p">,</span>
</span><span id="L-1237"><a href="#L-1237"><span class="linenos">1237</span></a>    <span class="p">)</span>
</span><span id="L-1238"><a href="#L-1238"><span class="linenos">1238</span></a>    <span class="k">return</span> <span class="n">microscope</span><span class="o">.</span><span class="n">imaging</span><span class="o">.</span><span class="n">grab_frame</span><span class="p">(</span>
</span><span id="L-1239"><a href="#L-1239"><span class="linenos">1239</span></a>        <span class="n">tbt</span><span class="o">.</span><span class="n">GrabFrameSettings</span><span class="p">(</span><span class="n">bit_depth</span><span class="o">=</span><span class="n">img_settings</span><span class="o">.</span><span class="n">bit_depth</span><span class="p">)</span>
</span><span id="L-1240"><a href="#L-1240"><span class="linenos">1240</span></a>    <span class="p">)</span>
</span><span id="L-1241"><a href="#L-1241"><span class="linenos">1241</span></a>
</span><span id="L-1242"><a href="#L-1242"><span class="linenos">1242</span></a>
</span><span id="L-1243"><a href="#L-1243"><span class="linenos">1243</span></a><span class="k">def</span> <span class="nf">imaging_detector</span><span class="p">(</span><span class="n">img_settings</span><span class="p">:</span> <span class="n">tbt</span><span class="o">.</span><span class="n">ImageSettings</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-1244"><a href="#L-1244"><span class="linenos">1244</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1245"><a href="#L-1245"><span class="linenos">1245</span></a><span class="sd">    Prepares the detector and inserts it if applicable.</span>
</span><span id="L-1246"><a href="#L-1246"><span class="linenos">1246</span></a>
</span><span id="L-1247"><a href="#L-1247"><span class="linenos">1247</span></a><span class="sd">    This function sets the detector type, inserts the detector if necessary, sets the detector mode,</span>
</span><span id="L-1248"><a href="#L-1248"><span class="linenos">1248</span></a><span class="sd">    and adjusts the contrast and brightness settings. It is important to set detector mode settings</span>
</span><span id="L-1249"><a href="#L-1249"><span class="linenos">1249</span></a><span class="sd">    right before contrast and brightness as any subsequent calls to a detector type can overwrite the mode.</span>
</span><span id="L-1250"><a href="#L-1250"><span class="linenos">1250</span></a>
</span><span id="L-1251"><a href="#L-1251"><span class="linenos">1251</span></a><span class="sd">    Parameters</span>
</span><span id="L-1252"><a href="#L-1252"><span class="linenos">1252</span></a><span class="sd">    ----------</span>
</span><span id="L-1253"><a href="#L-1253"><span class="linenos">1253</span></a><span class="sd">    img_settings : tbt.ImageSettings</span>
</span><span id="L-1254"><a href="#L-1254"><span class="linenos">1254</span></a><span class="sd">        The image settings, including the microscope, beam, and detector settings.</span>
</span><span id="L-1255"><a href="#L-1255"><span class="linenos">1255</span></a>
</span><span id="L-1256"><a href="#L-1256"><span class="linenos">1256</span></a><span class="sd">    Returns</span>
</span><span id="L-1257"><a href="#L-1257"><span class="linenos">1257</span></a><span class="sd">    -------</span>
</span><span id="L-1258"><a href="#L-1258"><span class="linenos">1258</span></a><span class="sd">    bool</span>
</span><span id="L-1259"><a href="#L-1259"><span class="linenos">1259</span></a><span class="sd">        True if the detector is prepared successfully, False otherwise.</span>
</span><span id="L-1260"><a href="#L-1260"><span class="linenos">1260</span></a>
</span><span id="L-1261"><a href="#L-1261"><span class="linenos">1261</span></a><span class="sd">    Examples</span>
</span><span id="L-1262"><a href="#L-1262"><span class="linenos">1262</span></a><span class="sd">    --------</span>
</span><span id="L-1263"><a href="#L-1263"><span class="linenos">1263</span></a><span class="sd">    &gt;&gt;&gt; import pytribeam.types as tbt</span>
</span><span id="L-1264"><a href="#L-1264"><span class="linenos">1264</span></a><span class="sd">    &gt;&gt;&gt; microscope = tbt.Microscope()</span>
</span><span id="L-1265"><a href="#L-1265"><span class="linenos">1265</span></a><span class="sd">    &gt;&gt;&gt; microscope.connect(&quot;localhost&quot;)</span>
</span><span id="L-1266"><a href="#L-1266"><span class="linenos">1266</span></a><span class="sd">    Client connecting to [localhost:7520]...</span>
</span><span id="L-1267"><a href="#L-1267"><span class="linenos">1267</span></a><span class="sd">    Client connected to [localhost:7520]</span>
</span><span id="L-1268"><a href="#L-1268"><span class="linenos">1268</span></a><span class="sd">    &gt;&gt;&gt; img_settings = tbt.ImageSettings(</span>
</span><span id="L-1269"><a href="#L-1269"><span class="linenos">1269</span></a><span class="sd">    ...     microscope=microscope,</span>
</span><span id="L-1270"><a href="#L-1270"><span class="linenos">1270</span></a><span class="sd">    ...     beam=tbt.ElectronBeam(settings=None),</span>
</span><span id="L-1271"><a href="#L-1271"><span class="linenos">1271</span></a><span class="sd">    ...     detector=tbt.Detector(</span>
</span><span id="L-1272"><a href="#L-1272"><span class="linenos">1272</span></a><span class="sd">    ...         type=tbt.DetectorType.ETD,</span>
</span><span id="L-1273"><a href="#L-1273"><span class="linenos">1273</span></a><span class="sd">    ...         mode=tbt.DetectorMode.SECONDARY_ELECTRONS,</span>
</span><span id="L-1274"><a href="#L-1274"><span class="linenos">1274</span></a><span class="sd">    ...         brightness=0.4,</span>
</span><span id="L-1275"><a href="#L-1275"><span class="linenos">1275</span></a><span class="sd">    ...         contrast=0.2,</span>
</span><span id="L-1276"><a href="#L-1276"><span class="linenos">1276</span></a><span class="sd">    ...     ),</span>
</span><span id="L-1277"><a href="#L-1277"><span class="linenos">1277</span></a><span class="sd">    ...     scan=tbt.Scan(resolution=tbt.PresetResolution.PRESET_768X512),</span>
</span><span id="L-1278"><a href="#L-1278"><span class="linenos">1278</span></a><span class="sd">    ...     bit_depth=tbt.ColorDepth.BITS_8,</span>
</span><span id="L-1279"><a href="#L-1279"><span class="linenos">1279</span></a><span class="sd">    ... )</span>
</span><span id="L-1280"><a href="#L-1280"><span class="linenos">1280</span></a><span class="sd">    &gt;&gt;&gt; success = imaging_detector(img_settings)</span>
</span><span id="L-1281"><a href="#L-1281"><span class="linenos">1281</span></a><span class="sd">    &gt;&gt;&gt; print(success)</span>
</span><span id="L-1282"><a href="#L-1282"><span class="linenos">1282</span></a><span class="sd">    True</span>
</span><span id="L-1283"><a href="#L-1283"><span class="linenos">1283</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1284"><a href="#L-1284"><span class="linenos">1284</span></a>    <span class="n">microscope</span> <span class="o">=</span> <span class="n">img_settings</span><span class="o">.</span><span class="n">microscope</span>
</span><span id="L-1285"><a href="#L-1285"><span class="linenos">1285</span></a>    <span class="n">detector</span> <span class="o">=</span> <span class="n">img_settings</span><span class="o">.</span><span class="n">detector</span><span class="o">.</span><span class="n">type</span>
</span><span id="L-1286"><a href="#L-1286"><span class="linenos">1286</span></a>    <span class="n">detector_type</span><span class="p">(</span>
</span><span id="L-1287"><a href="#L-1287"><span class="linenos">1287</span></a>        <span class="n">microscope</span><span class="o">=</span><span class="n">microscope</span><span class="p">,</span>
</span><span id="L-1288"><a href="#L-1288"><span class="linenos">1288</span></a>        <span class="n">detector</span><span class="o">=</span><span class="n">detector</span><span class="p">,</span>
</span><span id="L-1289"><a href="#L-1289"><span class="linenos">1289</span></a>    <span class="p">)</span>
</span><span id="L-1290"><a href="#L-1290"><span class="linenos">1290</span></a>    <span class="n">detector_state</span> <span class="o">=</span> <span class="n">devices</span><span class="o">.</span><span class="n">detector_state</span><span class="p">(</span>
</span><span id="L-1291"><a href="#L-1291"><span class="linenos">1291</span></a>        <span class="n">microscope</span><span class="o">=</span><span class="n">microscope</span><span class="p">,</span>
</span><span id="L-1292"><a href="#L-1292"><span class="linenos">1292</span></a>        <span class="n">detector</span><span class="o">=</span><span class="n">detector</span><span class="p">,</span>
</span><span id="L-1293"><a href="#L-1293"><span class="linenos">1293</span></a>    <span class="p">)</span>
</span><span id="L-1294"><a href="#L-1294"><span class="linenos">1294</span></a>    <span class="k">if</span> <span class="n">detector_state</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="L-1295"><a href="#L-1295"><span class="linenos">1295</span></a>        <span class="n">devices</span><span class="o">.</span><span class="n">insert_detector</span><span class="p">(</span>
</span><span id="L-1296"><a href="#L-1296"><span class="linenos">1296</span></a>            <span class="n">microscope</span><span class="o">=</span><span class="n">microscope</span><span class="p">,</span>
</span><span id="L-1297"><a href="#L-1297"><span class="linenos">1297</span></a>            <span class="n">detector</span><span class="o">=</span><span class="n">detector</span><span class="p">,</span>
</span><span id="L-1298"><a href="#L-1298"><span class="linenos">1298</span></a>        <span class="p">)</span>
</span><span id="L-1299"><a href="#L-1299"><span class="linenos">1299</span></a>    <span class="n">detector_mode</span><span class="p">(</span>
</span><span id="L-1300"><a href="#L-1300"><span class="linenos">1300</span></a>        <span class="n">microscope</span><span class="o">=</span><span class="n">microscope</span><span class="p">,</span>
</span><span id="L-1301"><a href="#L-1301"><span class="linenos">1301</span></a>        <span class="n">detector_mode</span><span class="o">=</span><span class="n">img_settings</span><span class="o">.</span><span class="n">detector</span><span class="o">.</span><span class="n">mode</span><span class="p">,</span>
</span><span id="L-1302"><a href="#L-1302"><span class="linenos">1302</span></a>    <span class="p">)</span>
</span><span id="L-1303"><a href="#L-1303"><span class="linenos">1303</span></a>    <span class="n">detector_cb</span><span class="p">(</span>
</span><span id="L-1304"><a href="#L-1304"><span class="linenos">1304</span></a>        <span class="n">microscope</span><span class="o">=</span><span class="n">microscope</span><span class="p">,</span>
</span><span id="L-1305"><a href="#L-1305"><span class="linenos">1305</span></a>        <span class="n">detector_settings</span><span class="o">=</span><span class="n">img_settings</span><span class="o">.</span><span class="n">detector</span><span class="p">,</span>
</span><span id="L-1306"><a href="#L-1306"><span class="linenos">1306</span></a>        <span class="n">beam</span><span class="o">=</span><span class="n">img_settings</span><span class="o">.</span><span class="n">beam</span><span class="p">,</span>
</span><span id="L-1307"><a href="#L-1307"><span class="linenos">1307</span></a>    <span class="p">)</span>
</span><span id="L-1308"><a href="#L-1308"><span class="linenos">1308</span></a>    <span class="k">return</span> <span class="kc">True</span>
</span><span id="L-1309"><a href="#L-1309"><span class="linenos">1309</span></a>
</span><span id="L-1310"><a href="#L-1310"><span class="linenos">1310</span></a>
</span><span id="L-1311"><a href="#L-1311"><span class="linenos">1311</span></a><span class="k">def</span> <span class="nf">imaging_device</span><span class="p">(</span>
</span><span id="L-1312"><a href="#L-1312"><span class="linenos">1312</span></a>    <span class="n">microscope</span><span class="p">:</span> <span class="n">tbt</span><span class="o">.</span><span class="n">Microscope</span><span class="p">,</span>
</span><span id="L-1313"><a href="#L-1313"><span class="linenos">1313</span></a>    <span class="n">beam</span><span class="p">:</span> <span class="n">tbt</span><span class="o">.</span><span class="n">Beam</span><span class="p">,</span>
</span><span id="L-1314"><a href="#L-1314"><span class="linenos">1314</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-1315"><a href="#L-1315"><span class="linenos">1315</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1316"><a href="#L-1316"><span class="linenos">1316</span></a><span class="sd">    Prepares the imaging beam, viewing quad, and the beam voltage and current.</span>
</span><span id="L-1317"><a href="#L-1317"><span class="linenos">1317</span></a>
</span><span id="L-1318"><a href="#L-1318"><span class="linenos">1318</span></a><span class="sd">    This function sets the beam device, ensures the beam is ready, sets the beam voltage and current,</span>
</span><span id="L-1319"><a href="#L-1319"><span class="linenos">1319</span></a><span class="sd">    and applies angular correction if the beam type is electron.</span>
</span><span id="L-1320"><a href="#L-1320"><span class="linenos">1320</span></a>
</span><span id="L-1321"><a href="#L-1321"><span class="linenos">1321</span></a><span class="sd">    Parameters</span>
</span><span id="L-1322"><a href="#L-1322"><span class="linenos">1322</span></a><span class="sd">    ----------</span>
</span><span id="L-1323"><a href="#L-1323"><span class="linenos">1323</span></a><span class="sd">    microscope : tbt.Microscope</span>
</span><span id="L-1324"><a href="#L-1324"><span class="linenos">1324</span></a><span class="sd">        The microscope object to configure.</span>
</span><span id="L-1325"><a href="#L-1325"><span class="linenos">1325</span></a><span class="sd">    beam : tbt.Beam</span>
</span><span id="L-1326"><a href="#L-1326"><span class="linenos">1326</span></a><span class="sd">        The beam type to configure, including its settings.</span>
</span><span id="L-1327"><a href="#L-1327"><span class="linenos">1327</span></a>
</span><span id="L-1328"><a href="#L-1328"><span class="linenos">1328</span></a><span class="sd">    Returns</span>
</span><span id="L-1329"><a href="#L-1329"><span class="linenos">1329</span></a><span class="sd">    -------</span>
</span><span id="L-1330"><a href="#L-1330"><span class="linenos">1330</span></a><span class="sd">    bool</span>
</span><span id="L-1331"><a href="#L-1331"><span class="linenos">1331</span></a><span class="sd">        True if the imaging device is prepared successfully, False otherwise.</span>
</span><span id="L-1332"><a href="#L-1332"><span class="linenos">1332</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1333"><a href="#L-1333"><span class="linenos">1333</span></a>    <span class="n">set_beam_device</span><span class="p">(</span><span class="n">microscope</span><span class="o">=</span><span class="n">microscope</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">beam</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
</span><span id="L-1334"><a href="#L-1334"><span class="linenos">1334</span></a>    <span class="n">beam_ready</span><span class="p">(</span><span class="n">beam</span><span class="o">=</span><span class="n">beam</span><span class="p">,</span> <span class="n">microscope</span><span class="o">=</span><span class="n">microscope</span><span class="p">)</span>
</span><span id="L-1335"><a href="#L-1335"><span class="linenos">1335</span></a>    <span class="n">beam_voltage</span><span class="p">(</span>
</span><span id="L-1336"><a href="#L-1336"><span class="linenos">1336</span></a>        <span class="n">beam</span><span class="o">=</span><span class="n">beam</span><span class="p">,</span>
</span><span id="L-1337"><a href="#L-1337"><span class="linenos">1337</span></a>        <span class="n">microscope</span><span class="o">=</span><span class="n">microscope</span><span class="p">,</span>
</span><span id="L-1338"><a href="#L-1338"><span class="linenos">1338</span></a>        <span class="n">voltage_kv</span><span class="o">=</span><span class="n">beam</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">voltage_kv</span><span class="p">,</span>
</span><span id="L-1339"><a href="#L-1339"><span class="linenos">1339</span></a>        <span class="n">voltage_tol_kv</span><span class="o">=</span><span class="n">beam</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">voltage_tol_kv</span><span class="p">,</span>
</span><span id="L-1340"><a href="#L-1340"><span class="linenos">1340</span></a>    <span class="p">)</span>
</span><span id="L-1341"><a href="#L-1341"><span class="linenos">1341</span></a>    <span class="n">beam_current</span><span class="p">(</span>
</span><span id="L-1342"><a href="#L-1342"><span class="linenos">1342</span></a>        <span class="n">beam</span><span class="o">=</span><span class="n">beam</span><span class="p">,</span>
</span><span id="L-1343"><a href="#L-1343"><span class="linenos">1343</span></a>        <span class="n">microscope</span><span class="o">=</span><span class="n">microscope</span><span class="p">,</span>
</span><span id="L-1344"><a href="#L-1344"><span class="linenos">1344</span></a>        <span class="n">current_na</span><span class="o">=</span><span class="n">beam</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">current_na</span><span class="p">,</span>
</span><span id="L-1345"><a href="#L-1345"><span class="linenos">1345</span></a>        <span class="n">current_tol_na</span><span class="o">=</span><span class="n">beam</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">current_tol_na</span><span class="p">,</span>
</span><span id="L-1346"><a href="#L-1346"><span class="linenos">1346</span></a>    <span class="p">)</span>
</span><span id="L-1347"><a href="#L-1347"><span class="linenos">1347</span></a>    <span class="k">if</span> <span class="n">beam</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">tbt</span><span class="o">.</span><span class="n">BeamType</span><span class="o">.</span><span class="n">ELECTRON</span><span class="p">:</span>
</span><span id="L-1348"><a href="#L-1348"><span class="linenos">1348</span></a>        <span class="n">beam_angular_correction</span><span class="p">(</span>
</span><span id="L-1349"><a href="#L-1349"><span class="linenos">1349</span></a>            <span class="n">microscope</span><span class="o">=</span><span class="n">microscope</span><span class="p">,</span>
</span><span id="L-1350"><a href="#L-1350"><span class="linenos">1350</span></a>            <span class="n">dynamic_focus</span><span class="o">=</span><span class="n">beam</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">dynamic_focus</span><span class="p">,</span>
</span><span id="L-1351"><a href="#L-1351"><span class="linenos">1351</span></a>            <span class="n">tilt_correction</span><span class="o">=</span><span class="n">beam</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">tilt_correction</span><span class="p">,</span>
</span><span id="L-1352"><a href="#L-1352"><span class="linenos">1352</span></a>        <span class="p">)</span>
</span><span id="L-1353"><a href="#L-1353"><span class="linenos">1353</span></a>    <span class="k">return</span> <span class="kc">True</span>
</span><span id="L-1354"><a href="#L-1354"><span class="linenos">1354</span></a>
</span><span id="L-1355"><a href="#L-1355"><span class="linenos">1355</span></a>
</span><span id="L-1356"><a href="#L-1356"><span class="linenos">1356</span></a><span class="k">def</span> <span class="nf">imaging_scan</span><span class="p">(</span><span class="n">img_settings</span><span class="p">:</span> <span class="n">tbt</span><span class="o">.</span><span class="n">ImageSettings</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-1357"><a href="#L-1357"><span class="linenos">1357</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1358"><a href="#L-1358"><span class="linenos">1358</span></a><span class="sd">    Sets all scan settings except for the resolution.</span>
</span><span id="L-1359"><a href="#L-1359"><span class="linenos">1359</span></a>
</span><span id="L-1360"><a href="#L-1360"><span class="linenos">1360</span></a><span class="sd">    This function configures the scan settings for the specified image settings, including</span>
</span><span id="L-1361"><a href="#L-1361"><span class="linenos">1361</span></a><span class="sd">    setting the scan mode to full frame, scan rotation, working distance, horizontal field width,</span>
</span><span id="L-1362"><a href="#L-1362"><span class="linenos">1362</span></a><span class="sd">    and dwell time.</span>
</span><span id="L-1363"><a href="#L-1363"><span class="linenos">1363</span></a>
</span><span id="L-1364"><a href="#L-1364"><span class="linenos">1364</span></a><span class="sd">    Parameters</span>
</span><span id="L-1365"><a href="#L-1365"><span class="linenos">1365</span></a><span class="sd">    ----------</span>
</span><span id="L-1366"><a href="#L-1366"><span class="linenos">1366</span></a><span class="sd">    img_settings : tbt.ImageSettings</span>
</span><span id="L-1367"><a href="#L-1367"><span class="linenos">1367</span></a><span class="sd">        The image settings, including the microscope, beam, and scan settings.</span>
</span><span id="L-1368"><a href="#L-1368"><span class="linenos">1368</span></a>
</span><span id="L-1369"><a href="#L-1369"><span class="linenos">1369</span></a><span class="sd">    Returns</span>
</span><span id="L-1370"><a href="#L-1370"><span class="linenos">1370</span></a><span class="sd">    -------</span>
</span><span id="L-1371"><a href="#L-1371"><span class="linenos">1371</span></a><span class="sd">    bool</span>
</span><span id="L-1372"><a href="#L-1372"><span class="linenos">1372</span></a><span class="sd">        True if the scan settings are configured successfully, False otherwise.</span>
</span><span id="L-1373"><a href="#L-1373"><span class="linenos">1373</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1374"><a href="#L-1374"><span class="linenos">1374</span></a>    <span class="n">microscope</span> <span class="o">=</span> <span class="n">img_settings</span><span class="o">.</span><span class="n">microscope</span>
</span><span id="L-1375"><a href="#L-1375"><span class="linenos">1375</span></a>    <span class="n">beam</span> <span class="o">=</span> <span class="n">img_settings</span><span class="o">.</span><span class="n">beam</span>
</span><span id="L-1376"><a href="#L-1376"><span class="linenos">1376</span></a>    <span class="n">beam_scan_full_frame</span><span class="p">(</span>
</span><span id="L-1377"><a href="#L-1377"><span class="linenos">1377</span></a>        <span class="n">beam</span><span class="o">=</span><span class="n">beam</span><span class="p">,</span>
</span><span id="L-1378"><a href="#L-1378"><span class="linenos">1378</span></a>        <span class="n">microscope</span><span class="o">=</span><span class="n">microscope</span><span class="p">,</span>
</span><span id="L-1379"><a href="#L-1379"><span class="linenos">1379</span></a>    <span class="p">)</span>
</span><span id="L-1380"><a href="#L-1380"><span class="linenos">1380</span></a>    <span class="n">beam_scan_rotation</span><span class="p">(</span>
</span><span id="L-1381"><a href="#L-1381"><span class="linenos">1381</span></a>        <span class="n">beam</span><span class="o">=</span><span class="n">beam</span><span class="p">,</span> <span class="n">microscope</span><span class="o">=</span><span class="n">microscope</span><span class="p">,</span> <span class="n">rotation_deg</span><span class="o">=</span><span class="n">img_settings</span><span class="o">.</span><span class="n">scan</span><span class="o">.</span><span class="n">rotation_deg</span>
</span><span id="L-1382"><a href="#L-1382"><span class="linenos">1382</span></a>    <span class="p">)</span>
</span><span id="L-1383"><a href="#L-1383"><span class="linenos">1383</span></a>    <span class="n">beam_working_distance</span><span class="p">(</span>
</span><span id="L-1384"><a href="#L-1384"><span class="linenos">1384</span></a>        <span class="n">beam</span><span class="o">=</span><span class="n">beam</span><span class="p">,</span>
</span><span id="L-1385"><a href="#L-1385"><span class="linenos">1385</span></a>        <span class="n">microscope</span><span class="o">=</span><span class="n">microscope</span><span class="p">,</span>
</span><span id="L-1386"><a href="#L-1386"><span class="linenos">1386</span></a>        <span class="n">wd_mm</span><span class="o">=</span><span class="n">img_settings</span><span class="o">.</span><span class="n">beam</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">working_dist_mm</span><span class="p">,</span>
</span><span id="L-1387"><a href="#L-1387"><span class="linenos">1387</span></a>    <span class="p">)</span>
</span><span id="L-1388"><a href="#L-1388"><span class="linenos">1388</span></a>    <span class="n">beam_hfw</span><span class="p">(</span><span class="n">beam</span><span class="o">=</span><span class="n">beam</span><span class="p">,</span> <span class="n">microscope</span><span class="o">=</span><span class="n">microscope</span><span class="p">,</span> <span class="n">hfw_mm</span><span class="o">=</span><span class="n">img_settings</span><span class="o">.</span><span class="n">beam</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">hfw_mm</span><span class="p">)</span>
</span><span id="L-1389"><a href="#L-1389"><span class="linenos">1389</span></a>    <span class="n">beam_dwell_time</span><span class="p">(</span>
</span><span id="L-1390"><a href="#L-1390"><span class="linenos">1390</span></a>        <span class="n">beam</span><span class="o">=</span><span class="n">beam</span><span class="p">,</span> <span class="n">microscope</span><span class="o">=</span><span class="n">microscope</span><span class="p">,</span> <span class="n">dwell_us</span><span class="o">=</span><span class="n">img_settings</span><span class="o">.</span><span class="n">scan</span><span class="o">.</span><span class="n">dwell_time_us</span>
</span><span id="L-1391"><a href="#L-1391"><span class="linenos">1391</span></a>    <span class="p">)</span>
</span><span id="L-1392"><a href="#L-1392"><span class="linenos">1392</span></a>    <span class="k">return</span> <span class="kc">True</span>
</span><span id="L-1393"><a href="#L-1393"><span class="linenos">1393</span></a>
</span><span id="L-1394"><a href="#L-1394"><span class="linenos">1394</span></a>
</span><span id="L-1395"><a href="#L-1395"><span class="linenos">1395</span></a><span class="k">def</span> <span class="nf">prepare_imaging</span><span class="p">(</span><span class="n">img_settings</span><span class="p">:</span> <span class="n">tbt</span><span class="o">.</span><span class="n">ImageSettings</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-1396"><a href="#L-1396"><span class="linenos">1396</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1397"><a href="#L-1397"><span class="linenos">1397</span></a><span class="sd">    Prepares various imaging settings.</span>
</span><span id="L-1398"><a href="#L-1398"><span class="linenos">1398</span></a>
</span><span id="L-1399"><a href="#L-1399"><span class="linenos">1399</span></a><span class="sd">    This function prepares the imaging device, scan settings, and detector settings</span>
</span><span id="L-1400"><a href="#L-1400"><span class="linenos">1400</span></a><span class="sd">    based on the specified image settings.</span>
</span><span id="L-1401"><a href="#L-1401"><span class="linenos">1401</span></a>
</span><span id="L-1402"><a href="#L-1402"><span class="linenos">1402</span></a><span class="sd">    Parameters</span>
</span><span id="L-1403"><a href="#L-1403"><span class="linenos">1403</span></a><span class="sd">    ----------</span>
</span><span id="L-1404"><a href="#L-1404"><span class="linenos">1404</span></a><span class="sd">    img_settings : tbt.ImageSettings</span>
</span><span id="L-1405"><a href="#L-1405"><span class="linenos">1405</span></a><span class="sd">        The image settings, including the microscope, beam, scan, and detector settings.</span>
</span><span id="L-1406"><a href="#L-1406"><span class="linenos">1406</span></a>
</span><span id="L-1407"><a href="#L-1407"><span class="linenos">1407</span></a><span class="sd">    Returns</span>
</span><span id="L-1408"><a href="#L-1408"><span class="linenos">1408</span></a><span class="sd">    -------</span>
</span><span id="L-1409"><a href="#L-1409"><span class="linenos">1409</span></a><span class="sd">    bool</span>
</span><span id="L-1410"><a href="#L-1410"><span class="linenos">1410</span></a><span class="sd">        True if the imaging settings are prepared successfully, False otherwise.</span>
</span><span id="L-1411"><a href="#L-1411"><span class="linenos">1411</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1412"><a href="#L-1412"><span class="linenos">1412</span></a>    <span class="n">imaging_device</span><span class="p">(</span><span class="n">microscope</span><span class="o">=</span><span class="n">img_settings</span><span class="o">.</span><span class="n">microscope</span><span class="p">,</span> <span class="n">beam</span><span class="o">=</span><span class="n">img_settings</span><span class="o">.</span><span class="n">beam</span><span class="p">)</span>
</span><span id="L-1413"><a href="#L-1413"><span class="linenos">1413</span></a>    <span class="n">imaging_scan</span><span class="p">(</span><span class="n">img_settings</span><span class="o">=</span><span class="n">img_settings</span><span class="p">)</span>
</span><span id="L-1414"><a href="#L-1414"><span class="linenos">1414</span></a>    <span class="n">imaging_detector</span><span class="p">(</span><span class="n">img_settings</span><span class="o">=</span><span class="n">img_settings</span><span class="p">)</span>
</span><span id="L-1415"><a href="#L-1415"><span class="linenos">1415</span></a>    <span class="k">return</span> <span class="kc">True</span>
</span><span id="L-1416"><a href="#L-1416"><span class="linenos">1416</span></a>
</span><span id="L-1417"><a href="#L-1417"><span class="linenos">1417</span></a>
</span><span id="L-1418"><a href="#L-1418"><span class="linenos">1418</span></a><span class="k">def</span> <span class="nf">set_view</span><span class="p">(</span>
</span><span id="L-1419"><a href="#L-1419"><span class="linenos">1419</span></a>    <span class="n">microscope</span><span class="p">:</span> <span class="n">tbt</span><span class="o">.</span><span class="n">Microscope</span><span class="p">,</span>
</span><span id="L-1420"><a href="#L-1420"><span class="linenos">1420</span></a>    <span class="n">quad</span><span class="p">:</span> <span class="n">tbt</span><span class="o">.</span><span class="n">ViewQuad</span><span class="p">,</span>
</span><span id="L-1421"><a href="#L-1421"><span class="linenos">1421</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-1422"><a href="#L-1422"><span class="linenos">1422</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1423"><a href="#L-1423"><span class="linenos">1423</span></a><span class="sd">    Sets the active view to the specified quad.</span>
</span><span id="L-1424"><a href="#L-1424"><span class="linenos">1424</span></a>
</span><span id="L-1425"><a href="#L-1425"><span class="linenos">1425</span></a><span class="sd">    This function sets the active imaging view to the specified quad on the microscope.</span>
</span><span id="L-1426"><a href="#L-1426"><span class="linenos">1426</span></a>
</span><span id="L-1427"><a href="#L-1427"><span class="linenos">1427</span></a><span class="sd">    Parameters</span>
</span><span id="L-1428"><a href="#L-1428"><span class="linenos">1428</span></a><span class="sd">    ----------</span>
</span><span id="L-1429"><a href="#L-1429"><span class="linenos">1429</span></a><span class="sd">    microscope : tbt.Microscope</span>
</span><span id="L-1430"><a href="#L-1430"><span class="linenos">1430</span></a><span class="sd">        The microscope object to configure.</span>
</span><span id="L-1431"><a href="#L-1431"><span class="linenos">1431</span></a><span class="sd">    quad : tbt.ViewQuad</span>
</span><span id="L-1432"><a href="#L-1432"><span class="linenos">1432</span></a><span class="sd">        The imaging view to select:</span>
</span><span id="L-1433"><a href="#L-1433"><span class="linenos">1433</span></a><span class="sd">        - 1 is upper left</span>
</span><span id="L-1434"><a href="#L-1434"><span class="linenos">1434</span></a><span class="sd">        - 2 is upper right</span>
</span><span id="L-1435"><a href="#L-1435"><span class="linenos">1435</span></a><span class="sd">        - 3 is lower left</span>
</span><span id="L-1436"><a href="#L-1436"><span class="linenos">1436</span></a><span class="sd">        - 4 is lower right</span>
</span><span id="L-1437"><a href="#L-1437"><span class="linenos">1437</span></a>
</span><span id="L-1438"><a href="#L-1438"><span class="linenos">1438</span></a><span class="sd">    Returns</span>
</span><span id="L-1439"><a href="#L-1439"><span class="linenos">1439</span></a><span class="sd">    -------</span>
</span><span id="L-1440"><a href="#L-1440"><span class="linenos">1440</span></a><span class="sd">    bool</span>
</span><span id="L-1441"><a href="#L-1441"><span class="linenos">1441</span></a><span class="sd">        True if the active view is set successfully, False otherwise.</span>
</span><span id="L-1442"><a href="#L-1442"><span class="linenos">1442</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1443"><a href="#L-1443"><span class="linenos">1443</span></a>    <span class="n">microscope</span><span class="o">.</span><span class="n">imaging</span><span class="o">.</span><span class="n">set_active_view</span><span class="p">(</span><span class="n">quad</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</span><span id="L-1444"><a href="#L-1444"><span class="linenos">1444</span></a>
</span><span id="L-1445"><a href="#L-1445"><span class="linenos">1445</span></a>
</span><span id="L-1446"><a href="#L-1446"><span class="linenos">1446</span></a><span class="k">def</span> <span class="nf">set_beam_device</span><span class="p">(</span>
</span><span id="L-1447"><a href="#L-1447"><span class="linenos">1447</span></a>    <span class="n">microscope</span><span class="p">:</span> <span class="n">tbt</span><span class="o">.</span><span class="n">Microscope</span><span class="p">,</span>
</span><span id="L-1448"><a href="#L-1448"><span class="linenos">1448</span></a>    <span class="n">device</span><span class="p">:</span> <span class="n">tbt</span><span class="o">.</span><span class="n">Device</span><span class="p">,</span>
</span><span id="L-1449"><a href="#L-1449"><span class="linenos">1449</span></a>    <span class="n">delay_s</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span>
</span><span id="L-1450"><a href="#L-1450"><span class="linenos">1450</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-1451"><a href="#L-1451"><span class="linenos">1451</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1452"><a href="#L-1452"><span class="linenos">1452</span></a><span class="sd">    Sets the active imaging device.</span>
</span><span id="L-1453"><a href="#L-1453"><span class="linenos">1453</span></a>
</span><span id="L-1454"><a href="#L-1454"><span class="linenos">1454</span></a><span class="sd">    This function sets the active imaging device on the microscope and waits for the specified delay.</span>
</span><span id="L-1455"><a href="#L-1455"><span class="linenos">1455</span></a>
</span><span id="L-1456"><a href="#L-1456"><span class="linenos">1456</span></a><span class="sd">    Parameters</span>
</span><span id="L-1457"><a href="#L-1457"><span class="linenos">1457</span></a><span class="sd">    ----------</span>
</span><span id="L-1458"><a href="#L-1458"><span class="linenos">1458</span></a><span class="sd">    microscope : tbt.Microscope</span>
</span><span id="L-1459"><a href="#L-1459"><span class="linenos">1459</span></a><span class="sd">        The microscope object to configure.</span>
</span><span id="L-1460"><a href="#L-1460"><span class="linenos">1460</span></a><span class="sd">    device : tbt.Device</span>
</span><span id="L-1461"><a href="#L-1461"><span class="linenos">1461</span></a><span class="sd">        The desired imaging device.</span>
</span><span id="L-1462"><a href="#L-1462"><span class="linenos">1462</span></a><span class="sd">    delay_s : float, optional</span>
</span><span id="L-1463"><a href="#L-1463"><span class="linenos">1463</span></a><span class="sd">        The delay in seconds to wait after setting the device (default is 0.1).</span>
</span><span id="L-1464"><a href="#L-1464"><span class="linenos">1464</span></a>
</span><span id="L-1465"><a href="#L-1465"><span class="linenos">1465</span></a><span class="sd">    Returns</span>
</span><span id="L-1466"><a href="#L-1466"><span class="linenos">1466</span></a><span class="sd">    -------</span>
</span><span id="L-1467"><a href="#L-1467"><span class="linenos">1467</span></a><span class="sd">    bool</span>
</span><span id="L-1468"><a href="#L-1468"><span class="linenos">1468</span></a><span class="sd">        True if the active device is set successfully, False otherwise.</span>
</span><span id="L-1469"><a href="#L-1469"><span class="linenos">1469</span></a>
</span><span id="L-1470"><a href="#L-1470"><span class="linenos">1470</span></a><span class="sd">    Raises</span>
</span><span id="L-1471"><a href="#L-1471"><span class="linenos">1471</span></a><span class="sd">    ------</span>
</span><span id="L-1472"><a href="#L-1472"><span class="linenos">1472</span></a><span class="sd">    ValueError</span>
</span><span id="L-1473"><a href="#L-1473"><span class="linenos">1473</span></a><span class="sd">        If the active device cannot be set correctly.</span>
</span><span id="L-1474"><a href="#L-1474"><span class="linenos">1474</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1475"><a href="#L-1475"><span class="linenos">1475</span></a>    <span class="n">microscope</span><span class="o">.</span><span class="n">imaging</span><span class="o">.</span><span class="n">set_active_device</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
</span><span id="L-1476"><a href="#L-1476"><span class="linenos">1476</span></a>    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">delay_s</span><span class="p">)</span>
</span><span id="L-1477"><a href="#L-1477"><span class="linenos">1477</span></a>    <span class="n">curr_device</span> <span class="o">=</span> <span class="n">tbt</span><span class="o">.</span><span class="n">Device</span><span class="p">(</span><span class="n">microscope</span><span class="o">.</span><span class="n">imaging</span><span class="o">.</span><span class="n">get_active_device</span><span class="p">())</span>
</span><span id="L-1478"><a href="#L-1478"><span class="linenos">1478</span></a>    <span class="k">if</span> <span class="n">curr_device</span> <span class="o">!=</span> <span class="n">device</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>
</span><span id="L-1479"><a href="#L-1479"><span class="linenos">1479</span></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="L-1480"><a href="#L-1480"><span class="linenos">1480</span></a>            <span class="sa">f</span><span class="s2">&quot;&quot;&quot;Could not set active device,</span>
</span><span id="L-1481"><a href="#L-1481"><span class="linenos">1481</span></a><span class="s2">            requested device </span><span class="si">{</span><span class="n">device</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2"> but current device is </span><span class="si">{</span><span class="n">curr_device</span><span class="si">}</span><span class="s2">.</span>
</span><span id="L-1482"><a href="#L-1482"><span class="linenos">1482</span></a><span class="s2">            Device list:</span>
</span><span id="L-1483"><a href="#L-1483"><span class="linenos">1483</span></a><span class="s2">                </span><span class="si">{</span><span class="n">tbt</span><span class="o">.</span><span class="n">Device</span><span class="o">.</span><span class="n">ELECTRON_BEAM</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2">: Electron Beam</span>
</span><span id="L-1484"><a href="#L-1484"><span class="linenos">1484</span></a><span class="s2">                </span><span class="si">{</span><span class="n">tbt</span><span class="o">.</span><span class="n">Device</span><span class="o">.</span><span class="n">ION_BEAM</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2">: Ion Beam</span>
</span><span id="L-1485"><a href="#L-1485"><span class="linenos">1485</span></a><span class="s2">                </span><span class="si">{</span><span class="n">tbt</span><span class="o">.</span><span class="n">Device</span><span class="o">.</span><span class="n">CCD_CAMERA</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2">: CCD Camera</span>
</span><span id="L-1486"><a href="#L-1486"><span class="linenos">1486</span></a><span class="s2">                </span><span class="si">{</span><span class="n">tbt</span><span class="o">.</span><span class="n">Device</span><span class="o">.</span><span class="n">IR_CAMERA</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2">: IR Camera</span>
</span><span id="L-1487"><a href="#L-1487"><span class="linenos">1487</span></a><span class="s2">                </span><span class="si">{</span><span class="n">tbt</span><span class="o">.</span><span class="n">Device</span><span class="o">.</span><span class="n">NAV_CAM</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2">: Nav Cam&quot;&quot;&quot;</span>
</span><span id="L-1488"><a href="#L-1488"><span class="linenos">1488</span></a>        <span class="p">)</span>
</span><span id="L-1489"><a href="#L-1489"><span class="linenos">1489</span></a>    <span class="k">return</span> <span class="kc">True</span>
</span><span id="L-1490"><a href="#L-1490"><span class="linenos">1490</span></a>
</span><span id="L-1491"><a href="#L-1491"><span class="linenos">1491</span></a>
</span><span id="L-1492"><a href="#L-1492"><span class="linenos">1492</span></a><span class="c1">#################</span>
</span><span id="L-1493"><a href="#L-1493"><span class="linenos">1493</span></a>
</span><span id="L-1494"><a href="#L-1494"><span class="linenos">1494</span></a>
</span><span id="L-1495"><a href="#L-1495"><span class="linenos">1495</span></a><span class="k">def</span> <span class="nf">collect_single_image</span><span class="p">(</span>
</span><span id="L-1496"><a href="#L-1496"><span class="linenos">1496</span></a>    <span class="n">save_path</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span>
</span><span id="L-1497"><a href="#L-1497"><span class="linenos">1497</span></a>    <span class="n">img_settings</span><span class="p">:</span> <span class="n">tbt</span><span class="o">.</span><span class="n">ImageSettings</span><span class="p">,</span>
</span><span id="L-1498"><a href="#L-1498"><span class="linenos">1498</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-1499"><a href="#L-1499"><span class="linenos">1499</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1500"><a href="#L-1500"><span class="linenos">1500</span></a><span class="sd">    Collects a single frame image with defined image settings.</span>
</span><span id="L-1501"><a href="#L-1501"><span class="linenos">1501</span></a>
</span><span id="L-1502"><a href="#L-1502"><span class="linenos">1502</span></a><span class="sd">    This function prepares the imaging settings, sets the view, and captures a single frame image.</span>
</span><span id="L-1503"><a href="#L-1503"><span class="linenos">1503</span></a><span class="sd">    It saves the image to the specified path. If a non-preset resolution is requested, the image</span>
</span><span id="L-1504"><a href="#L-1504"><span class="linenos">1504</span></a><span class="sd">    will be saved at 8-bit color depth.</span>
</span><span id="L-1505"><a href="#L-1505"><span class="linenos">1505</span></a>
</span><span id="L-1506"><a href="#L-1506"><span class="linenos">1506</span></a><span class="sd">    Parameters</span>
</span><span id="L-1507"><a href="#L-1507"><span class="linenos">1507</span></a><span class="sd">    ----------</span>
</span><span id="L-1508"><a href="#L-1508"><span class="linenos">1508</span></a><span class="sd">    save_path : Path</span>
</span><span id="L-1509"><a href="#L-1509"><span class="linenos">1509</span></a><span class="sd">        The path to save the captured image.</span>
</span><span id="L-1510"><a href="#L-1510"><span class="linenos">1510</span></a><span class="sd">    img_settings : tbt.ImageSettings</span>
</span><span id="L-1511"><a href="#L-1511"><span class="linenos">1511</span></a><span class="sd">        The image settings, including the microscope, beam, scan, and detector settings.</span>
</span><span id="L-1512"><a href="#L-1512"><span class="linenos">1512</span></a>
</span><span id="L-1513"><a href="#L-1513"><span class="linenos">1513</span></a><span class="sd">    Returns</span>
</span><span id="L-1514"><a href="#L-1514"><span class="linenos">1514</span></a><span class="sd">    -------</span>
</span><span id="L-1515"><a href="#L-1515"><span class="linenos">1515</span></a><span class="sd">    bool</span>
</span><span id="L-1516"><a href="#L-1516"><span class="linenos">1516</span></a><span class="sd">        True if the image is captured and saved successfully, False otherwise.</span>
</span><span id="L-1517"><a href="#L-1517"><span class="linenos">1517</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1518"><a href="#L-1518"><span class="linenos">1518</span></a>    <span class="n">beam</span> <span class="o">=</span> <span class="n">img_settings</span><span class="o">.</span><span class="n">beam</span>
</span><span id="L-1519"><a href="#L-1519"><span class="linenos">1519</span></a>    <span class="n">microscope</span> <span class="o">=</span> <span class="n">img_settings</span><span class="o">.</span><span class="n">microscope</span>
</span><span id="L-1520"><a href="#L-1520"><span class="linenos">1520</span></a>    <span class="n">set_view</span><span class="p">(</span><span class="n">microscope</span><span class="o">=</span><span class="n">microscope</span><span class="p">,</span> <span class="n">quad</span><span class="o">=</span><span class="n">beam</span><span class="o">.</span><span class="n">default_view</span><span class="p">)</span>
</span><span id="L-1521"><a href="#L-1521"><span class="linenos">1521</span></a>    <span class="n">prepare_imaging</span><span class="p">(</span><span class="n">img_settings</span><span class="o">=</span><span class="n">img_settings</span><span class="p">)</span>
</span><span id="L-1522"><a href="#L-1522"><span class="linenos">1522</span></a>
</span><span id="L-1523"><a href="#L-1523"><span class="linenos">1523</span></a>    <span class="n">resolution</span> <span class="o">=</span> <span class="n">img_settings</span><span class="o">.</span><span class="n">scan</span><span class="o">.</span><span class="n">resolution</span>
</span><span id="L-1524"><a href="#L-1524"><span class="linenos">1524</span></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">resolution</span><span class="p">,</span> <span class="n">tbt</span><span class="o">.</span><span class="n">PresetResolution</span><span class="p">):</span>
</span><span id="L-1525"><a href="#L-1525"><span class="linenos">1525</span></a>        <span class="n">img</span> <span class="o">=</span> <span class="n">grab_preset_resolution_frame</span><span class="p">(</span><span class="n">img_settings</span><span class="o">=</span><span class="n">img_settings</span><span class="p">)</span>
</span><span id="L-1526"><a href="#L-1526"><span class="linenos">1526</span></a>        <span class="n">img</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">save_path</span><span class="p">))</span>
</span><span id="L-1527"><a href="#L-1527"><span class="linenos">1527</span></a>        <span class="k">return</span> <span class="kc">True</span>
</span><span id="L-1528"><a href="#L-1528"><span class="linenos">1528</span></a>    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
</span><span id="L-1529"><a href="#L-1529"><span class="linenos">1529</span></a>        <span class="sa">f</span><span class="s1">&#39;Warning, non-preset resolution of &quot;</span><span class="si">{</span><span class="n">img_settings</span><span class="o">.</span><span class="n">scan</span><span class="o">.</span><span class="n">resolution</span><span class="si">}</span><span class="s1">&quot; requested. Image will automatically be saved at 8-bit color depth&#39;</span>
</span><span id="L-1530"><a href="#L-1530"><span class="linenos">1530</span></a>    <span class="p">)</span>
</span><span id="L-1531"><a href="#L-1531"><span class="linenos">1531</span></a>    <span class="k">if</span> <span class="n">img_settings</span><span class="o">.</span><span class="n">bit_depth</span> <span class="o">!=</span> <span class="n">tbt</span><span class="o">.</span><span class="n">ColorDepth</span><span class="o">.</span><span class="n">BITS_8</span><span class="p">:</span>
</span><span id="L-1532"><a href="#L-1532"><span class="linenos">1532</span></a>        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
</span><span id="L-1533"><a href="#L-1533"><span class="linenos">1533</span></a>            <span class="sa">f</span><span class="s2">&quot;Warning, non-preset resolution necessitates images be stored at 8-bit color depth, requested bit-depth of </span><span class="si">{</span><span class="n">img_settings</span><span class="o">.</span><span class="n">bit_depth</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2"> will be ignored.&quot;</span>
</span><span id="L-1534"><a href="#L-1534"><span class="linenos">1534</span></a>        <span class="p">)</span>
</span><span id="L-1535"><a href="#L-1535"><span class="linenos">1535</span></a>    <span class="n">grab_custom_resolution_frame</span><span class="p">(</span>
</span><span id="L-1536"><a href="#L-1536"><span class="linenos">1536</span></a>        <span class="n">img_settings</span><span class="o">=</span><span class="n">img_settings</span><span class="p">,</span>
</span><span id="L-1537"><a href="#L-1537"><span class="linenos">1537</span></a>        <span class="n">save_path</span><span class="o">=</span><span class="n">save_path</span><span class="p">,</span>
</span><span id="L-1538"><a href="#L-1538"><span class="linenos">1538</span></a>    <span class="p">)</span>
</span><span id="L-1539"><a href="#L-1539"><span class="linenos">1539</span></a>    <span class="k">return</span> <span class="kc">True</span>
</span><span id="L-1540"><a href="#L-1540"><span class="linenos">1540</span></a>
</span><span id="L-1541"><a href="#L-1541"><span class="linenos">1541</span></a>
</span><span id="L-1542"><a href="#L-1542"><span class="linenos">1542</span></a><span class="k">def</span> <span class="nf">collect_multiple_images</span><span class="p">(</span>
</span><span id="L-1543"><a href="#L-1543"><span class="linenos">1543</span></a>    <span class="n">multiple_img_settings</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">tbt</span><span class="o">.</span><span class="n">ImageSettings</span><span class="p">],</span> <span class="n">num_frames</span><span class="p">:</span> <span class="nb">int</span>
</span><span id="L-1544"><a href="#L-1544"><span class="linenos">1544</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">tbt</span><span class="o">.</span><span class="n">AdornedImage</span><span class="p">]:</span>
</span><span id="L-1545"><a href="#L-1545"><span class="linenos">1545</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1546"><a href="#L-1546"><span class="linenos">1546</span></a><span class="sd">    Sets up scanning for multiple frames.</span>
</span><span id="L-1547"><a href="#L-1547"><span class="linenos">1547</span></a>
</span><span id="L-1548"><a href="#L-1548"><span class="linenos">1548</span></a><span class="sd">    This function is best used for collecting multiple segments on a single detector simultaneously.</span>
</span><span id="L-1549"><a href="#L-1549"><span class="linenos">1549</span></a><span class="sd">    It is limited to preset resolutions only.</span>
</span><span id="L-1550"><a href="#L-1550"><span class="linenos">1550</span></a>
</span><span id="L-1551"><a href="#L-1551"><span class="linenos">1551</span></a><span class="sd">    Parameters</span>
</span><span id="L-1552"><a href="#L-1552"><span class="linenos">1552</span></a><span class="sd">    ----------</span>
</span><span id="L-1553"><a href="#L-1553"><span class="linenos">1553</span></a><span class="sd">    multiple_img_settings : List[tbt.ImageSettings]</span>
</span><span id="L-1554"><a href="#L-1554"><span class="linenos">1554</span></a><span class="sd">        The list of image settings for each frame, including the microscope, beam, scan, and detector settings.</span>
</span><span id="L-1555"><a href="#L-1555"><span class="linenos">1555</span></a><span class="sd">    num_frames : int</span>
</span><span id="L-1556"><a href="#L-1556"><span class="linenos">1556</span></a><span class="sd">        The number of frames to collect.</span>
</span><span id="L-1557"><a href="#L-1557"><span class="linenos">1557</span></a>
</span><span id="L-1558"><a href="#L-1558"><span class="linenos">1558</span></a><span class="sd">    Returns</span>
</span><span id="L-1559"><a href="#L-1559"><span class="linenos">1559</span></a><span class="sd">    -------</span>
</span><span id="L-1560"><a href="#L-1560"><span class="linenos">1560</span></a><span class="sd">    List[tbt.AdornedImage]</span>
</span><span id="L-1561"><a href="#L-1561"><span class="linenos">1561</span></a><span class="sd">        The list of captured images.</span>
</span><span id="L-1562"><a href="#L-1562"><span class="linenos">1562</span></a>
</span><span id="L-1563"><a href="#L-1563"><span class="linenos">1563</span></a><span class="sd">    Raises</span>
</span><span id="L-1564"><a href="#L-1564"><span class="linenos">1564</span></a><span class="sd">    ------</span>
</span><span id="L-1565"><a href="#L-1565"><span class="linenos">1565</span></a><span class="sd">    ValueError</span>
</span><span id="L-1566"><a href="#L-1566"><span class="linenos">1566</span></a><span class="sd">        If a non-preset resolution is requested for simultaneous multiple frame imaging.</span>
</span><span id="L-1567"><a href="#L-1567"><span class="linenos">1567</span></a>
</span><span id="L-1568"><a href="#L-1568"><span class="linenos">1568</span></a><span class="sd">    Notes</span>
</span><span id="L-1569"><a href="#L-1569"><span class="linenos">1569</span></a><span class="sd">    -----</span>
</span><span id="L-1570"><a href="#L-1570"><span class="linenos">1570</span></a><span class="sd">    This method has not yet been tested.</span>
</span><span id="L-1571"><a href="#L-1571"><span class="linenos">1571</span></a>
</span><span id="L-1572"><a href="#L-1572"><span class="linenos">1572</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1573"><a href="#L-1573"><span class="linenos">1573</span></a>    <span class="c1"># TODO test this</span>
</span><span id="L-1574"><a href="#L-1574"><span class="linenos">1574</span></a>    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;Method not yet tested&quot;</span><span class="p">)</span>
</span><span id="L-1575"><a href="#L-1575"><span class="linenos">1575</span></a>    <span class="n">views</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="L-1576"><a href="#L-1576"><span class="linenos">1576</span></a>    <span class="k">for</span> <span class="n">quad</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">num_frames</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
</span><span id="L-1577"><a href="#L-1577"><span class="linenos">1577</span></a>        <span class="n">img_settings</span> <span class="o">=</span> <span class="n">multiple_img_settings</span><span class="p">[</span><span class="n">quad</span><span class="p">]</span>
</span><span id="L-1578"><a href="#L-1578"><span class="linenos">1578</span></a>        <span class="n">resolution</span> <span class="o">=</span> <span class="n">img_settings</span><span class="o">.</span><span class="n">scan</span><span class="o">.</span><span class="n">resolution</span>
</span><span id="L-1579"><a href="#L-1579"><span class="linenos">1579</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">resolution</span><span class="p">,</span> <span class="n">tbt</span><span class="o">.</span><span class="n">PresetResolution</span><span class="p">):</span>
</span><span id="L-1580"><a href="#L-1580"><span class="linenos">1580</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="L-1581"><a href="#L-1581"><span class="linenos">1581</span></a>                <span class="sa">f</span><span class="s1">&#39;Only preset resolutions allowed for simultaneous multiple frame imaging, but resolution of &quot;</span><span class="si">{</span><span class="n">resolution</span><span class="o">.</span><span class="n">width</span><span class="si">}</span><span class="s1">x</span><span class="si">{</span><span class="n">resolution</span><span class="o">.</span><span class="n">height</span><span class="si">}</span><span class="s1">&quot; was requested.&#39;</span>
</span><span id="L-1582"><a href="#L-1582"><span class="linenos">1582</span></a>            <span class="p">)</span>
</span><span id="L-1583"><a href="#L-1583"><span class="linenos">1583</span></a>
</span><span id="L-1584"><a href="#L-1584"><span class="linenos">1584</span></a>        <span class="n">microscope</span> <span class="o">=</span> <span class="n">img_settings</span><span class="o">.</span><span class="n">microscope</span>
</span><span id="L-1585"><a href="#L-1585"><span class="linenos">1585</span></a>        <span class="n">beam</span> <span class="o">=</span> <span class="n">img_settings</span><span class="o">.</span><span class="n">beam</span>
</span><span id="L-1586"><a href="#L-1586"><span class="linenos">1586</span></a>        <span class="n">views</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">quad</span><span class="p">)</span>
</span><span id="L-1587"><a href="#L-1587"><span class="linenos">1587</span></a>        <span class="n">set_view</span><span class="p">(</span><span class="n">microscope</span><span class="o">=</span><span class="n">microscope</span><span class="p">,</span> <span class="n">quad</span><span class="o">=</span><span class="n">quad</span><span class="p">)</span>
</span><span id="L-1588"><a href="#L-1588"><span class="linenos">1588</span></a>        <span class="n">prepare_imaging</span><span class="p">(</span><span class="n">microscope</span><span class="o">=</span><span class="n">microscope</span><span class="p">,</span> <span class="n">beam</span><span class="o">=</span><span class="n">beam</span><span class="p">,</span> <span class="n">img_settings</span><span class="o">=</span><span class="n">img_settings</span><span class="p">)</span>
</span><span id="L-1589"><a href="#L-1589"><span class="linenos">1589</span></a>    <span class="n">frames</span> <span class="o">=</span> <span class="n">microscope</span><span class="o">.</span><span class="n">imaging</span><span class="o">.</span><span class="n">grab_multiple_frames</span><span class="p">(</span>
</span><span id="L-1590"><a href="#L-1590"><span class="linenos">1590</span></a>        <span class="n">tbt</span><span class="o">.</span><span class="n">GrabFrameSettings</span><span class="p">(</span><span class="n">bit_depth</span><span class="o">=</span><span class="n">img_settings</span><span class="o">.</span><span class="n">bit_depth</span><span class="p">,</span> <span class="n">views</span><span class="o">=</span><span class="n">views</span><span class="p">)</span>
</span><span id="L-1591"><a href="#L-1591"><span class="linenos">1591</span></a>    <span class="p">)</span>
</span><span id="L-1592"><a href="#L-1592"><span class="linenos">1592</span></a>    <span class="k">return</span> <span class="n">frames</span>
</span><span id="L-1593"><a href="#L-1593"><span class="linenos">1593</span></a>
</span><span id="L-1594"><a href="#L-1594"><span class="linenos">1594</span></a>
</span><span id="L-1595"><a href="#L-1595"><span class="linenos">1595</span></a><span class="c1"># TODO</span>
</span><span id="L-1596"><a href="#L-1596"><span class="linenos">1596</span></a><span class="c1"># def image_method(dict):</span>
</span><span id="L-1597"><a href="#L-1597"><span class="linenos">1597</span></a><span class="c1">#     &quot;&quot;&quot;determine imaging method and return associated function&quot;&quot;&quot;</span>
</span><span id="L-1598"><a href="#L-1598"><span class="linenos">1598</span></a><span class="c1">#     pass</span>
</span><span id="L-1599"><a href="#L-1599"><span class="linenos">1599</span></a>
</span><span id="L-1600"><a href="#L-1600"><span class="linenos">1600</span></a><span class="c1"># TODO</span>
</span><span id="L-1601"><a href="#L-1601"><span class="linenos">1601</span></a><span class="c1"># def collect_tiling_image():</span>
</span><span id="L-1602"><a href="#L-1602"><span class="linenos">1602</span></a><span class="c1">#     for loop</span>
</span><span id="L-1603"><a href="#L-1603"><span class="linenos">1603</span></a><span class="c1">#         collect_standard_image</span>
</span><span id="L-1604"><a href="#L-1604"><span class="linenos">1604</span></a><span class="c1">#         #stage move</span>
</span><span id="L-1605"><a href="#L-1605"><span class="linenos">1605</span></a>
</span><span id="L-1606"><a href="#L-1606"><span class="linenos">1606</span></a>
</span><span id="L-1607"><a href="#L-1607"><span class="linenos">1607</span></a><span class="c1"># TODO add more complex imaging behavior, determine method in this function</span>
</span><span id="L-1608"><a href="#L-1608"><span class="linenos">1608</span></a><span class="k">def</span> <span class="nf">image_operation</span><span class="p">(</span>
</span><span id="L-1609"><a href="#L-1609"><span class="linenos">1609</span></a>    <span class="n">step</span><span class="p">:</span> <span class="n">tbt</span><span class="o">.</span><span class="n">Step</span><span class="p">,</span>
</span><span id="L-1610"><a href="#L-1610"><span class="linenos">1610</span></a>    <span class="n">image_settings</span><span class="p">:</span> <span class="n">tbt</span><span class="o">.</span><span class="n">ImageSettings</span><span class="p">,</span>
</span><span id="L-1611"><a href="#L-1611"><span class="linenos">1611</span></a>    <span class="n">general_settings</span><span class="p">:</span> <span class="n">tbt</span><span class="o">.</span><span class="n">GeneralSettings</span><span class="p">,</span>
</span><span id="L-1612"><a href="#L-1612"><span class="linenos">1612</span></a>    <span class="n">slice_number</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="L-1613"><a href="#L-1613"><span class="linenos">1613</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="L-1614"><a href="#L-1614"><span class="linenos">1614</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="L-1615"><a href="#L-1615"><span class="linenos">1615</span></a><span class="sd">    Performs an image operation based on the specified settings.</span>
</span><span id="L-1616"><a href="#L-1616"><span class="linenos">1616</span></a>
</span><span id="L-1617"><a href="#L-1617"><span class="linenos">1617</span></a><span class="sd">    This function collects an image, saves it to the specified directory, and turns off tilt correction and dynamic focus.</span>
</span><span id="L-1618"><a href="#L-1618"><span class="linenos">1618</span></a>
</span><span id="L-1619"><a href="#L-1619"><span class="linenos">1619</span></a><span class="sd">    Parameters</span>
</span><span id="L-1620"><a href="#L-1620"><span class="linenos">1620</span></a><span class="sd">    ----------</span>
</span><span id="L-1621"><a href="#L-1621"><span class="linenos">1621</span></a><span class="sd">    step : tbt.Step</span>
</span><span id="L-1622"><a href="#L-1622"><span class="linenos">1622</span></a><span class="sd">        The step information, including the name of the step.</span>
</span><span id="L-1623"><a href="#L-1623"><span class="linenos">1623</span></a><span class="sd">    image_settings : tbt.ImageSettings</span>
</span><span id="L-1624"><a href="#L-1624"><span class="linenos">1624</span></a><span class="sd">        The image settings, including the microscope, beam, scan, and detector settings.</span>
</span><span id="L-1625"><a href="#L-1625"><span class="linenos">1625</span></a><span class="sd">    general_settings : tbt.GeneralSettings</span>
</span><span id="L-1626"><a href="#L-1626"><span class="linenos">1626</span></a><span class="sd">        The general settings, including the experimental directory.</span>
</span><span id="L-1627"><a href="#L-1627"><span class="linenos">1627</span></a><span class="sd">    slice_number : int</span>
</span><span id="L-1628"><a href="#L-1628"><span class="linenos">1628</span></a><span class="sd">        The slice number for naming the saved image file.</span>
</span><span id="L-1629"><a href="#L-1629"><span class="linenos">1629</span></a>
</span><span id="L-1630"><a href="#L-1630"><span class="linenos">1630</span></a><span class="sd">    Returns</span>
</span><span id="L-1631"><a href="#L-1631"><span class="linenos">1631</span></a><span class="sd">    -------</span>
</span><span id="L-1632"><a href="#L-1632"><span class="linenos">1632</span></a><span class="sd">    bool</span>
</span><span id="L-1633"><a href="#L-1633"><span class="linenos">1633</span></a><span class="sd">        True if the image operation is performed successfully, False otherwise.</span>
</span><span id="L-1634"><a href="#L-1634"><span class="linenos">1634</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="L-1635"><a href="#L-1635"><span class="linenos">1635</span></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">Collecting image&quot;</span><span class="p">)</span>
</span><span id="L-1636"><a href="#L-1636"><span class="linenos">1636</span></a>    <span class="c1"># create folder in same directory as experimental directory</span>
</span><span id="L-1637"><a href="#L-1637"><span class="linenos">1637</span></a>    <span class="n">image_directory</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">general_settings</span><span class="o">.</span><span class="n">exp_dir</span><span class="p">)</span><span class="o">.</span><span class="n">joinpath</span><span class="p">(</span><span class="n">step</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span id="L-1638"><a href="#L-1638"><span class="linenos">1638</span></a>    <span class="n">image_directory</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="L-1639"><a href="#L-1639"><span class="linenos">1639</span></a>
</span><span id="L-1640"><a href="#L-1640"><span class="linenos">1640</span></a>    <span class="c1"># TODO</span>
</span><span id="L-1641"><a href="#L-1641"><span class="linenos">1641</span></a>    <span class="c1"># determine_image_method()</span>
</span><span id="L-1642"><a href="#L-1642"><span class="linenos">1642</span></a>    <span class="c1"># collect_multiple_images()</span>
</span><span id="L-1643"><a href="#L-1643"><span class="linenos">1643</span></a>
</span><span id="L-1644"><a href="#L-1644"><span class="linenos">1644</span></a>    <span class="c1"># single image process:</span>
</span><span id="L-1645"><a href="#L-1645"><span class="linenos">1645</span></a>    <span class="n">save_path</span> <span class="o">=</span> <span class="n">image_directory</span><span class="o">.</span><span class="n">joinpath</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">slice_number</span><span class="si">:</span><span class="s2">04</span><span class="si">}</span><span class="s2">.tif&quot;</span><span class="p">)</span>
</span><span id="L-1646"><a href="#L-1646"><span class="linenos">1646</span></a>    <span class="n">collect_single_image</span><span class="p">(</span><span class="n">save_path</span><span class="o">=</span><span class="n">save_path</span><span class="p">,</span> <span class="n">img_settings</span><span class="o">=</span><span class="n">image_settings</span><span class="p">)</span>
</span><span id="L-1647"><a href="#L-1647"><span class="linenos">1647</span></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">Image saved to </span><span class="si">{</span><span class="n">save_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="L-1648"><a href="#L-1648"><span class="linenos">1648</span></a>
</span><span id="L-1649"><a href="#L-1649"><span class="linenos">1649</span></a>    <span class="c1"># turn off tilt correction and dynamic focus</span>
</span><span id="L-1650"><a href="#L-1650"><span class="linenos">1650</span></a>    <span class="n">beam_angular_correction</span><span class="p">(</span>
</span><span id="L-1651"><a href="#L-1651"><span class="linenos">1651</span></a>        <span class="n">microscope</span><span class="o">=</span><span class="n">image_settings</span><span class="o">.</span><span class="n">microscope</span><span class="p">,</span>
</span><span id="L-1652"><a href="#L-1652"><span class="linenos">1652</span></a>        <span class="n">dynamic_focus</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="L-1653"><a href="#L-1653"><span class="linenos">1653</span></a>        <span class="n">tilt_correction</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="L-1654"><a href="#L-1654"><span class="linenos">1654</span></a>    <span class="p">)</span>
</span><span id="L-1655"><a href="#L-1655"><span class="linenos">1655</span></a>
</span><span id="L-1656"><a href="#L-1656"><span class="linenos">1656</span></a>    <span class="k">return</span> <span class="kc">True</span>
</span></pre></div>


            </section>
                <section id="beam_angular_correction">
                            <input id="beam_angular_correction-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">beam_angular_correction</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">microscope</span><span class="p">:</span> <span class="n"><a href="types.html#Microscope">pytribeam.types.Microscope</a></span>,</span><span class="param">	<span class="n">dynamic_focus</span><span class="p">:</span> <span class="nb">bool</span>,</span><span class="param">	<span class="n">tilt_correction</span><span class="p">:</span> <span class="nb">bool</span>,</span><span class="param">	<span class="n">delay_s</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.5</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <label class="view-source-button" for="beam_angular_correction-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#beam_angular_correction"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="beam_angular_correction-110"><a href="#beam_angular_correction-110"><span class="linenos">110</span></a><span class="k">def</span> <span class="nf">beam_angular_correction</span><span class="p">(</span>
</span><span id="beam_angular_correction-111"><a href="#beam_angular_correction-111"><span class="linenos">111</span></a>    <span class="n">microscope</span><span class="p">:</span> <span class="n">tbt</span><span class="o">.</span><span class="n">Microscope</span><span class="p">,</span>
</span><span id="beam_angular_correction-112"><a href="#beam_angular_correction-112"><span class="linenos">112</span></a>    <span class="n">dynamic_focus</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
</span><span id="beam_angular_correction-113"><a href="#beam_angular_correction-113"><span class="linenos">113</span></a>    <span class="n">tilt_correction</span><span class="p">:</span> <span class="nb">bool</span><span class="p">,</span>
</span><span id="beam_angular_correction-114"><a href="#beam_angular_correction-114"><span class="linenos">114</span></a>    <span class="c1"># correction_angle_deg: float = None,</span>
</span><span id="beam_angular_correction-115"><a href="#beam_angular_correction-115"><span class="linenos">115</span></a>    <span class="n">delay_s</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.5</span><span class="p">,</span>
</span><span id="beam_angular_correction-116"><a href="#beam_angular_correction-116"><span class="linenos">116</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="beam_angular_correction-117"><a href="#beam_angular_correction-117"><span class="linenos">117</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="beam_angular_correction-118"><a href="#beam_angular_correction-118"><span class="linenos">118</span></a><span class="sd">    Uses auto mode to set tilt correction and dynamic focus.</span>
</span><span id="beam_angular_correction-119"><a href="#beam_angular_correction-119"><span class="linenos">119</span></a>
</span><span id="beam_angular_correction-120"><a href="#beam_angular_correction-120"><span class="linenos">120</span></a><span class="sd">    This function configures the electron beam&#39;s angular correction mode to automatic,</span>
</span><span id="beam_angular_correction-121"><a href="#beam_angular_correction-121"><span class="linenos">121</span></a><span class="sd">    sets the scan rotation to zero, and enables or disables dynamic focus and tilt correction</span>
</span><span id="beam_angular_correction-122"><a href="#beam_angular_correction-122"><span class="linenos">122</span></a><span class="sd">    based on the provided parameters.</span>
</span><span id="beam_angular_correction-123"><a href="#beam_angular_correction-123"><span class="linenos">123</span></a>
</span><span id="beam_angular_correction-124"><a href="#beam_angular_correction-124"><span class="linenos">124</span></a><span class="sd">    Parameters</span>
</span><span id="beam_angular_correction-125"><a href="#beam_angular_correction-125"><span class="linenos">125</span></a><span class="sd">    ----------</span>
</span><span id="beam_angular_correction-126"><a href="#beam_angular_correction-126"><span class="linenos">126</span></a><span class="sd">    microscope : tbt.Microscope</span>
</span><span id="beam_angular_correction-127"><a href="#beam_angular_correction-127"><span class="linenos">127</span></a><span class="sd">        The microscope object to configure.</span>
</span><span id="beam_angular_correction-128"><a href="#beam_angular_correction-128"><span class="linenos">128</span></a><span class="sd">    dynamic_focus : bool</span>
</span><span id="beam_angular_correction-129"><a href="#beam_angular_correction-129"><span class="linenos">129</span></a><span class="sd">        If True, dynamic focus will be turned on. If False, dynamic focus will be turned off.</span>
</span><span id="beam_angular_correction-130"><a href="#beam_angular_correction-130"><span class="linenos">130</span></a><span class="sd">    tilt_correction : bool</span>
</span><span id="beam_angular_correction-131"><a href="#beam_angular_correction-131"><span class="linenos">131</span></a><span class="sd">        If True, tilt correction will be turned on. If False, tilt correction will be turned off.</span>
</span><span id="beam_angular_correction-132"><a href="#beam_angular_correction-132"><span class="linenos">132</span></a><span class="sd">    delay_s : float, optional</span>
</span><span id="beam_angular_correction-133"><a href="#beam_angular_correction-133"><span class="linenos">133</span></a><span class="sd">        The delay in seconds to wait after turning dynamic focus or tilt correction on or off (default is 0.5).</span>
</span><span id="beam_angular_correction-134"><a href="#beam_angular_correction-134"><span class="linenos">134</span></a>
</span><span id="beam_angular_correction-135"><a href="#beam_angular_correction-135"><span class="linenos">135</span></a><span class="sd">    Returns</span>
</span><span id="beam_angular_correction-136"><a href="#beam_angular_correction-136"><span class="linenos">136</span></a><span class="sd">    -------</span>
</span><span id="beam_angular_correction-137"><a href="#beam_angular_correction-137"><span class="linenos">137</span></a><span class="sd">    bool</span>
</span><span id="beam_angular_correction-138"><a href="#beam_angular_correction-138"><span class="linenos">138</span></a><span class="sd">        True if the configuration is successful, False otherwise.</span>
</span><span id="beam_angular_correction-139"><a href="#beam_angular_correction-139"><span class="linenos">139</span></a>
</span><span id="beam_angular_correction-140"><a href="#beam_angular_correction-140"><span class="linenos">140</span></a><span class="sd">    Raises</span>
</span><span id="beam_angular_correction-141"><a href="#beam_angular_correction-141"><span class="linenos">141</span></a><span class="sd">    ------</span>
</span><span id="beam_angular_correction-142"><a href="#beam_angular_correction-142"><span class="linenos">142</span></a><span class="sd">    SystemError</span>
</span><span id="beam_angular_correction-143"><a href="#beam_angular_correction-143"><span class="linenos">143</span></a><span class="sd">        If unable to turn dynamic focus or tilt correction on or off.</span>
</span><span id="beam_angular_correction-144"><a href="#beam_angular_correction-144"><span class="linenos">144</span></a>
</span><span id="beam_angular_correction-145"><a href="#beam_angular_correction-145"><span class="linenos">145</span></a><span class="sd">    Examples</span>
</span><span id="beam_angular_correction-146"><a href="#beam_angular_correction-146"><span class="linenos">146</span></a><span class="sd">    --------</span>
</span><span id="beam_angular_correction-147"><a href="#beam_angular_correction-147"><span class="linenos">147</span></a><span class="sd">    &gt;&gt;&gt; import pytribeam.types as tbt</span>
</span><span id="beam_angular_correction-148"><a href="#beam_angular_correction-148"><span class="linenos">148</span></a><span class="sd">    &gt;&gt;&gt; microscope = tbt.Microscope()</span>
</span><span id="beam_angular_correction-149"><a href="#beam_angular_correction-149"><span class="linenos">149</span></a><span class="sd">    &gt;&gt;&gt; microscope.connect(&quot;localhost&quot;)</span>
</span><span id="beam_angular_correction-150"><a href="#beam_angular_correction-150"><span class="linenos">150</span></a><span class="sd">    Client connecting to [localhost:7520]...</span>
</span><span id="beam_angular_correction-151"><a href="#beam_angular_correction-151"><span class="linenos">151</span></a><span class="sd">    Client connected to [localhost:7520]</span>
</span><span id="beam_angular_correction-152"><a href="#beam_angular_correction-152"><span class="linenos">152</span></a><span class="sd">    &gt;&gt;&gt; success = beam_angular_correction(microscope, dynamic_focus=True, tilt_correction=False)</span>
</span><span id="beam_angular_correction-153"><a href="#beam_angular_correction-153"><span class="linenos">153</span></a><span class="sd">    &gt;&gt;&gt; print(success)</span>
</span><span id="beam_angular_correction-154"><a href="#beam_angular_correction-154"><span class="linenos">154</span></a><span class="sd">    True</span>
</span><span id="beam_angular_correction-155"><a href="#beam_angular_correction-155"><span class="linenos">155</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="beam_angular_correction-156"><a href="#beam_angular_correction-156"><span class="linenos">156</span></a>    <span class="n">angular_correction</span> <span class="o">=</span> <span class="n">microscope</span><span class="o">.</span><span class="n">beams</span><span class="o">.</span><span class="n">electron_beam</span><span class="o">.</span><span class="n">angular_correction</span>
</span><span id="beam_angular_correction-157"><a href="#beam_angular_correction-157"><span class="linenos">157</span></a>    <span class="n">angular_correction</span><span class="o">.</span><span class="n">mode</span> <span class="o">=</span> <span class="n">tbt</span><span class="o">.</span><span class="n">AngularCorrectionMode</span><span class="o">.</span><span class="n">AUTOMATIC</span>
</span><span id="beam_angular_correction-158"><a href="#beam_angular_correction-158"><span class="linenos">158</span></a>    <span class="c1"># scan rotation must be zero for auto mode</span>
</span><span id="beam_angular_correction-159"><a href="#beam_angular_correction-159"><span class="linenos">159</span></a>    <span class="n">microscope</span><span class="o">.</span><span class="n">beams</span><span class="o">.</span><span class="n">electron_beam</span><span class="o">.</span><span class="n">scanning</span><span class="o">.</span><span class="n">rotation</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="mf">0.0</span>
</span><span id="beam_angular_correction-160"><a href="#beam_angular_correction-160"><span class="linenos">160</span></a>
</span><span id="beam_angular_correction-161"><a href="#beam_angular_correction-161"><span class="linenos">161</span></a>    <span class="c1"># manual adjustment not implemented yet, only works at zero scan rotation</span>
</span><span id="beam_angular_correction-162"><a href="#beam_angular_correction-162"><span class="linenos">162</span></a>    <span class="c1"># if correction_angle_deg is not None:</span>
</span><span id="beam_angular_correction-163"><a href="#beam_angular_correction-163"><span class="linenos">163</span></a>    <span class="c1">#     angular_correction.mode = tbt.AngularCorrectionMode.MANUAL</span>
</span><span id="beam_angular_correction-164"><a href="#beam_angular_correction-164"><span class="linenos">164</span></a>    <span class="k">if</span> <span class="n">dynamic_focus</span><span class="p">:</span>
</span><span id="beam_angular_correction-165"><a href="#beam_angular_correction-165"><span class="linenos">165</span></a>        <span class="n">angular_correction</span><span class="o">.</span><span class="n">dynamic_focus</span><span class="o">.</span><span class="n">turn_on</span><span class="p">()</span>
</span><span id="beam_angular_correction-166"><a href="#beam_angular_correction-166"><span class="linenos">166</span></a>        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">delay_s</span><span class="p">)</span>
</span><span id="beam_angular_correction-167"><a href="#beam_angular_correction-167"><span class="linenos">167</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">angular_correction</span><span class="o">.</span><span class="n">dynamic_focus</span><span class="o">.</span><span class="n">is_on</span><span class="p">:</span>
</span><span id="beam_angular_correction-168"><a href="#beam_angular_correction-168"><span class="linenos">168</span></a>            <span class="k">raise</span> <span class="ne">SystemError</span><span class="p">(</span><span class="s2">&quot;Unable to turn dynamic focus on.&quot;</span><span class="p">)</span>
</span><span id="beam_angular_correction-169"><a href="#beam_angular_correction-169"><span class="linenos">169</span></a>    <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">dynamic_focus</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">dynamic_focus</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="beam_angular_correction-170"><a href="#beam_angular_correction-170"><span class="linenos">170</span></a>        <span class="n">angular_correction</span><span class="o">.</span><span class="n">dynamic_focus</span><span class="o">.</span><span class="n">turn_off</span><span class="p">()</span>
</span><span id="beam_angular_correction-171"><a href="#beam_angular_correction-171"><span class="linenos">171</span></a>        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">delay_s</span><span class="p">)</span>
</span><span id="beam_angular_correction-172"><a href="#beam_angular_correction-172"><span class="linenos">172</span></a>        <span class="k">if</span> <span class="n">angular_correction</span><span class="o">.</span><span class="n">dynamic_focus</span><span class="o">.</span><span class="n">is_on</span><span class="p">:</span>
</span><span id="beam_angular_correction-173"><a href="#beam_angular_correction-173"><span class="linenos">173</span></a>            <span class="k">raise</span> <span class="ne">SystemError</span><span class="p">(</span><span class="s2">&quot;Unable to turn dynamic focus off.&quot;</span><span class="p">)</span>
</span><span id="beam_angular_correction-174"><a href="#beam_angular_correction-174"><span class="linenos">174</span></a>
</span><span id="beam_angular_correction-175"><a href="#beam_angular_correction-175"><span class="linenos">175</span></a>    <span class="k">if</span> <span class="n">tilt_correction</span><span class="p">:</span>
</span><span id="beam_angular_correction-176"><a href="#beam_angular_correction-176"><span class="linenos">176</span></a>        <span class="n">angular_correction</span><span class="o">.</span><span class="n">tilt_correction</span><span class="o">.</span><span class="n">turn_on</span><span class="p">()</span>
</span><span id="beam_angular_correction-177"><a href="#beam_angular_correction-177"><span class="linenos">177</span></a>        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">delay_s</span><span class="p">)</span>
</span><span id="beam_angular_correction-178"><a href="#beam_angular_correction-178"><span class="linenos">178</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">angular_correction</span><span class="o">.</span><span class="n">tilt_correction</span><span class="o">.</span><span class="n">is_on</span><span class="p">:</span>
</span><span id="beam_angular_correction-179"><a href="#beam_angular_correction-179"><span class="linenos">179</span></a>            <span class="k">raise</span> <span class="ne">SystemError</span><span class="p">(</span><span class="s2">&quot;Unable to turn tilt correction on.&quot;</span><span class="p">)</span>
</span><span id="beam_angular_correction-180"><a href="#beam_angular_correction-180"><span class="linenos">180</span></a>    <span class="k">if</span> <span class="p">(</span><span class="ow">not</span> <span class="n">tilt_correction</span><span class="p">)</span> <span class="ow">or</span> <span class="p">(</span><span class="n">tilt_correction</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">):</span>
</span><span id="beam_angular_correction-181"><a href="#beam_angular_correction-181"><span class="linenos">181</span></a>        <span class="n">angular_correction</span><span class="o">.</span><span class="n">tilt_correction</span><span class="o">.</span><span class="n">turn_off</span><span class="p">()</span>
</span><span id="beam_angular_correction-182"><a href="#beam_angular_correction-182"><span class="linenos">182</span></a>        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">delay_s</span><span class="p">)</span>
</span><span id="beam_angular_correction-183"><a href="#beam_angular_correction-183"><span class="linenos">183</span></a>        <span class="k">if</span> <span class="n">angular_correction</span><span class="o">.</span><span class="n">tilt_correction</span><span class="o">.</span><span class="n">is_on</span><span class="p">:</span>
</span><span id="beam_angular_correction-184"><a href="#beam_angular_correction-184"><span class="linenos">184</span></a>            <span class="k">raise</span> <span class="ne">SystemError</span><span class="p">(</span><span class="s2">&quot;Unable to turn tilt correction off.&quot;</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Uses auto mode to set tilt correction and dynamic focus.</p>

<p>This function configures the electron beam's angular correction mode to automatic,
sets the scan rotation to zero, and enables or disables dynamic focus and tilt correction
based on the provided parameters.</p>

<h2 id="parameters">Parameters</h2>

<p>microscope : tbt.Microscope
    The microscope object to configure.
dynamic_focus : bool
    If True, dynamic focus will be turned on. If False, dynamic focus will be turned off.
tilt_correction : bool
    If True, tilt correction will be turned on. If False, tilt correction will be turned off.
delay_s : float, optional
    The delay in seconds to wait after turning dynamic focus or tilt correction on or off (default is 0.5).</p>

<h2 id="returns">Returns</h2>

<p>bool
    True if the configuration is successful, False otherwise.</p>

<h2 id="raises">Raises</h2>

<p>SystemError
    If unable to turn dynamic focus or tilt correction on or off.</p>

<h2 id="examples">Examples</h2>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn"><a href="types.html">pytribeam.types</a></span> <span class="k">as</span> <span class="nn">tbt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">microscope</span> <span class="o">=</span> <span class="n">tbt</span><span class="o">.</span><span class="n">Microscope</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">microscope</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;localhost&quot;</span><span class="p">)</span>
<span class="go">Client connecting to [localhost:7520]...</span>
<span class="go">Client connected to [localhost:7520]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">success</span> <span class="o">=</span> <span class="n">beam_angular_correction</span><span class="p">(</span><span class="n">microscope</span><span class="p">,</span> <span class="n">dynamic_focus</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">tilt_correction</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">success</span><span class="p">)</span>
<span class="go">True</span>
</code></pre>
</div>
</div>


                </section>
                <section id="beam_current">
                            <input id="beam_current-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">beam_current</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">beam</span><span class="p">:</span> <span class="n"><a href="types.html#Beam">pytribeam.types.Beam</a></span>,</span><span class="param">	<span class="n">microscope</span><span class="p">:</span> <span class="n"><a href="types.html#Microscope">pytribeam.types.Microscope</a></span>,</span><span class="param">	<span class="n">current_na</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">current_tol_na</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">delay_s</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">5.0</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <label class="view-source-button" for="beam_current-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#beam_current"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="beam_current-187"><a href="#beam_current-187"><span class="linenos">187</span></a><span class="k">def</span> <span class="nf">beam_current</span><span class="p">(</span>
</span><span id="beam_current-188"><a href="#beam_current-188"><span class="linenos">188</span></a>    <span class="n">beam</span><span class="p">:</span> <span class="n">tbt</span><span class="o">.</span><span class="n">Beam</span><span class="p">,</span>
</span><span id="beam_current-189"><a href="#beam_current-189"><span class="linenos">189</span></a>    <span class="n">microscope</span><span class="p">:</span> <span class="n">tbt</span><span class="o">.</span><span class="n">Microscope</span><span class="p">,</span>
</span><span id="beam_current-190"><a href="#beam_current-190"><span class="linenos">190</span></a>    <span class="n">current_na</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="beam_current-191"><a href="#beam_current-191"><span class="linenos">191</span></a>    <span class="n">current_tol_na</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="beam_current-192"><a href="#beam_current-192"><span class="linenos">192</span></a>    <span class="n">delay_s</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">5.0</span><span class="p">,</span>
</span><span id="beam_current-193"><a href="#beam_current-193"><span class="linenos">193</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="beam_current-194"><a href="#beam_current-194"><span class="linenos">194</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="beam_current-195"><a href="#beam_current-195"><span class="linenos">195</span></a><span class="sd">    Sets the current for the selected beam type, with inputs in units of nanoamps.</span>
</span><span id="beam_current-196"><a href="#beam_current-196"><span class="linenos">196</span></a>
</span><span id="beam_current-197"><a href="#beam_current-197"><span class="linenos">197</span></a><span class="sd">    This function sets the beam current for the specified beam type on the microscope.</span>
</span><span id="beam_current-198"><a href="#beam_current-198"><span class="linenos">198</span></a><span class="sd">    If the current difference exceeds the tolerance, it adjusts the beam current and</span>
</span><span id="beam_current-199"><a href="#beam_current-199"><span class="linenos">199</span></a><span class="sd">    waits for the specified delay.</span>
</span><span id="beam_current-200"><a href="#beam_current-200"><span class="linenos">200</span></a>
</span><span id="beam_current-201"><a href="#beam_current-201"><span class="linenos">201</span></a><span class="sd">    Parameters</span>
</span><span id="beam_current-202"><a href="#beam_current-202"><span class="linenos">202</span></a><span class="sd">    ----------</span>
</span><span id="beam_current-203"><a href="#beam_current-203"><span class="linenos">203</span></a><span class="sd">    beam : tbt.Beam</span>
</span><span id="beam_current-204"><a href="#beam_current-204"><span class="linenos">204</span></a><span class="sd">        The beam type to configure.</span>
</span><span id="beam_current-205"><a href="#beam_current-205"><span class="linenos">205</span></a><span class="sd">    microscope : tbt.Microscope</span>
</span><span id="beam_current-206"><a href="#beam_current-206"><span class="linenos">206</span></a><span class="sd">        The microscope object to configure.</span>
</span><span id="beam_current-207"><a href="#beam_current-207"><span class="linenos">207</span></a><span class="sd">    current_na : float</span>
</span><span id="beam_current-208"><a href="#beam_current-208"><span class="linenos">208</span></a><span class="sd">        The desired beam current in nanoamps.</span>
</span><span id="beam_current-209"><a href="#beam_current-209"><span class="linenos">209</span></a><span class="sd">    current_tol_na : float</span>
</span><span id="beam_current-210"><a href="#beam_current-210"><span class="linenos">210</span></a><span class="sd">        The tolerance for the beam current in nanoamps.</span>
</span><span id="beam_current-211"><a href="#beam_current-211"><span class="linenos">211</span></a><span class="sd">    delay_s : float, optional</span>
</span><span id="beam_current-212"><a href="#beam_current-212"><span class="linenos">212</span></a><span class="sd">        The delay in seconds to wait after adjusting the beam current (default is 5.0).</span>
</span><span id="beam_current-213"><a href="#beam_current-213"><span class="linenos">213</span></a>
</span><span id="beam_current-214"><a href="#beam_current-214"><span class="linenos">214</span></a><span class="sd">    Returns</span>
</span><span id="beam_current-215"><a href="#beam_current-215"><span class="linenos">215</span></a><span class="sd">    -------</span>
</span><span id="beam_current-216"><a href="#beam_current-216"><span class="linenos">216</span></a><span class="sd">    bool</span>
</span><span id="beam_current-217"><a href="#beam_current-217"><span class="linenos">217</span></a><span class="sd">        True if the beam current is set successfully, False otherwise.</span>
</span><span id="beam_current-218"><a href="#beam_current-218"><span class="linenos">218</span></a>
</span><span id="beam_current-219"><a href="#beam_current-219"><span class="linenos">219</span></a><span class="sd">    Raises</span>
</span><span id="beam_current-220"><a href="#beam_current-220"><span class="linenos">220</span></a><span class="sd">    ------</span>
</span><span id="beam_current-221"><a href="#beam_current-221"><span class="linenos">221</span></a><span class="sd">    ValueError</span>
</span><span id="beam_current-222"><a href="#beam_current-222"><span class="linenos">222</span></a><span class="sd">        If the beam current cannot be adjusted within the specified tolerance.</span>
</span><span id="beam_current-223"><a href="#beam_current-223"><span class="linenos">223</span></a>
</span><span id="beam_current-224"><a href="#beam_current-224"><span class="linenos">224</span></a><span class="sd">    Examples</span>
</span><span id="beam_current-225"><a href="#beam_current-225"><span class="linenos">225</span></a><span class="sd">    --------</span>
</span><span id="beam_current-226"><a href="#beam_current-226"><span class="linenos">226</span></a><span class="sd">    &gt;&gt;&gt; import pytribeam.types as tbt</span>
</span><span id="beam_current-227"><a href="#beam_current-227"><span class="linenos">227</span></a><span class="sd">    &gt;&gt;&gt; microscope = tbt.Microscope()</span>
</span><span id="beam_current-228"><a href="#beam_current-228"><span class="linenos">228</span></a><span class="sd">    &gt;&gt;&gt; microscope.connect(&quot;localhost&quot;)</span>
</span><span id="beam_current-229"><a href="#beam_current-229"><span class="linenos">229</span></a><span class="sd">    Client connecting to [localhost:7520]...</span>
</span><span id="beam_current-230"><a href="#beam_current-230"><span class="linenos">230</span></a><span class="sd">    Client connected to [localhost:7520]</span>
</span><span id="beam_current-231"><a href="#beam_current-231"><span class="linenos">231</span></a><span class="sd">    &gt;&gt;&gt; beam = tbt.ElectronBeam(settings=None)</span>
</span><span id="beam_current-232"><a href="#beam_current-232"><span class="linenos">232</span></a><span class="sd">    &gt;&gt;&gt; success = beam_current(beam, microscope, current_na=1.0, current_tol_na=0.1)</span>
</span><span id="beam_current-233"><a href="#beam_current-233"><span class="linenos">233</span></a><span class="sd">    &gt;&gt;&gt; print(success)</span>
</span><span id="beam_current-234"><a href="#beam_current-234"><span class="linenos">234</span></a><span class="sd">    True</span>
</span><span id="beam_current-235"><a href="#beam_current-235"><span class="linenos">235</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="beam_current-236"><a href="#beam_current-236"><span class="linenos">236</span></a>    <span class="n">selected_beam</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">beam_type</span><span class="p">(</span><span class="n">beam</span><span class="p">,</span> <span class="n">microscope</span><span class="p">)</span>
</span><span id="beam_current-237"><a href="#beam_current-237"><span class="linenos">237</span></a>
</span><span id="beam_current-238"><a href="#beam_current-238"><span class="linenos">238</span></a>    <span class="n">exisiting_current_a</span> <span class="o">=</span> <span class="n">selected_beam</span><span class="o">.</span><span class="n">beam_current</span><span class="o">.</span><span class="n">value</span>  <span class="c1"># amps</span>
</span><span id="beam_current-239"><a href="#beam_current-239"><span class="linenos">239</span></a>    <span class="n">delta_current_na</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span>
</span><span id="beam_current-240"><a href="#beam_current-240"><span class="linenos">240</span></a>        <span class="n">exisiting_current_a</span> <span class="o">*</span> <span class="n">cs</span><span class="o">.</span><span class="n">Conversions</span><span class="o">.</span><span class="n">A_TO_NA</span> <span class="o">-</span> <span class="n">current_na</span>
</span><span id="beam_current-241"><a href="#beam_current-241"><span class="linenos">241</span></a>    <span class="p">)</span>  <span class="c1"># nanoamps</span>
</span><span id="beam_current-242"><a href="#beam_current-242"><span class="linenos">242</span></a>    <span class="k">if</span> <span class="n">delta_current_na</span> <span class="o">&gt;</span> <span class="n">current_tol_na</span><span class="p">:</span>
</span><span id="beam_current-243"><a href="#beam_current-243"><span class="linenos">243</span></a>        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
</span><span id="beam_current-244"><a href="#beam_current-244"><span class="linenos">244</span></a>            <span class="s2">&quot;Requested beam current is not the current setting, imaging conditions may be non-ideal.&quot;</span>
</span><span id="beam_current-245"><a href="#beam_current-245"><span class="linenos">245</span></a>        <span class="p">)</span>
</span><span id="beam_current-246"><a href="#beam_current-246"><span class="linenos">246</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Adjusting beam current...&quot;</span><span class="p">)</span>
</span><span id="beam_current-247"><a href="#beam_current-247"><span class="linenos">247</span></a>        <span class="n">selected_beam</span><span class="o">.</span><span class="n">beam_current</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">current_na</span> <span class="o">*</span> <span class="n">cs</span><span class="o">.</span><span class="n">Conversions</span><span class="o">.</span><span class="n">NA_TO_A</span>
</span><span id="beam_current-248"><a href="#beam_current-248"><span class="linenos">248</span></a>        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">delay_s</span><span class="p">)</span>
</span><span id="beam_current-249"><a href="#beam_current-249"><span class="linenos">249</span></a>
</span><span id="beam_current-250"><a href="#beam_current-250"><span class="linenos">250</span></a>        <span class="n">new_current_na</span> <span class="o">=</span> <span class="n">selected_beam</span><span class="o">.</span><span class="n">beam_current</span><span class="o">.</span><span class="n">value</span> <span class="o">*</span> <span class="n">cs</span><span class="o">.</span><span class="n">Conversions</span><span class="o">.</span><span class="n">A_TO_NA</span>
</span><span id="beam_current-251"><a href="#beam_current-251"><span class="linenos">251</span></a>        <span class="n">current_diff_na</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">new_current_na</span> <span class="o">-</span> <span class="n">current_na</span><span class="p">)</span>
</span><span id="beam_current-252"><a href="#beam_current-252"><span class="linenos">252</span></a>        <span class="k">if</span> <span class="n">current_diff_na</span> <span class="o">&gt;</span> <span class="n">current_tol_na</span><span class="p">:</span>
</span><span id="beam_current-253"><a href="#beam_current-253"><span class="linenos">253</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="beam_current-254"><a href="#beam_current-254"><span class="linenos">254</span></a>                <span class="sa">f</span><span class="s2">&quot;&quot;&quot;Could not correctly adjust beam voltage,</span>
</span><span id="beam_current-255"><a href="#beam_current-255"><span class="linenos">255</span></a><span class="s2">                requested </span><span class="si">{</span><span class="n">current_na</span><span class="si">}</span><span class="s2"> nA, current beam current is</span>
</span><span id="beam_current-256"><a href="#beam_current-256"><span class="linenos">256</span></a><span class="s2">                </span><span class="si">{</span><span class="n">new_current_na</span><span class="si">}</span><span class="s2"> nA&quot;&quot;&quot;</span>
</span><span id="beam_current-257"><a href="#beam_current-257"><span class="linenos">257</span></a>            <span class="p">)</span>
</span><span id="beam_current-258"><a href="#beam_current-258"><span class="linenos">258</span></a>
</span><span id="beam_current-259"><a href="#beam_current-259"><span class="linenos">259</span></a>    <span class="k">return</span> <span class="kc">True</span>
</span></pre></div>


            <div class="docstring"><p>Sets the current for the selected beam type, with inputs in units of nanoamps.</p>

<p>This function sets the beam current for the specified beam type on the microscope.
If the current difference exceeds the tolerance, it adjusts the beam current and
waits for the specified delay.</p>

<h2 id="parameters">Parameters</h2>

<p>beam : tbt.Beam
    The beam type to configure.
microscope : tbt.Microscope
    The microscope object to configure.
current_na : float
    The desired beam current in nanoamps.
current_tol_na : float
    The tolerance for the beam current in nanoamps.
delay_s : float, optional
    The delay in seconds to wait after adjusting the beam current (default is 5.0).</p>

<h2 id="returns">Returns</h2>

<p>bool
    True if the beam current is set successfully, False otherwise.</p>

<h2 id="raises">Raises</h2>

<p>ValueError
    If the beam current cannot be adjusted within the specified tolerance.</p>

<h2 id="examples">Examples</h2>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn"><a href="types.html">pytribeam.types</a></span> <span class="k">as</span> <span class="nn">tbt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">microscope</span> <span class="o">=</span> <span class="n">tbt</span><span class="o">.</span><span class="n">Microscope</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">microscope</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;localhost&quot;</span><span class="p">)</span>
<span class="go">Client connecting to [localhost:7520]...</span>
<span class="go">Client connected to [localhost:7520]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">beam</span> <span class="o">=</span> <span class="n">tbt</span><span class="o">.</span><span class="n">ElectronBeam</span><span class="p">(</span><span class="n">settings</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">success</span> <span class="o">=</span> <span class="n">beam_current</span><span class="p">(</span><span class="n">beam</span><span class="p">,</span> <span class="n">microscope</span><span class="p">,</span> <span class="n">current_na</span><span class="o">=</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">current_tol_na</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">success</span><span class="p">)</span>
<span class="go">True</span>
</code></pre>
</div>
</div>


                </section>
                <section id="beam_dwell_time">
                            <input id="beam_dwell_time-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">beam_dwell_time</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">beam</span><span class="p">:</span> <span class="n"><a href="types.html#Beam">pytribeam.types.Beam</a></span>,</span><span class="param">	<span class="n">microscope</span><span class="p">:</span> <span class="n"><a href="types.html#Microscope">pytribeam.types.Microscope</a></span>,</span><span class="param">	<span class="n">dwell_us</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">delay_s</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.1</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <label class="view-source-button" for="beam_dwell_time-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#beam_dwell_time"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="beam_dwell_time-262"><a href="#beam_dwell_time-262"><span class="linenos">262</span></a><span class="k">def</span> <span class="nf">beam_dwell_time</span><span class="p">(</span>
</span><span id="beam_dwell_time-263"><a href="#beam_dwell_time-263"><span class="linenos">263</span></a>    <span class="n">beam</span><span class="p">:</span> <span class="n">tbt</span><span class="o">.</span><span class="n">Beam</span><span class="p">,</span>
</span><span id="beam_dwell_time-264"><a href="#beam_dwell_time-264"><span class="linenos">264</span></a>    <span class="n">microscope</span><span class="p">:</span> <span class="n">tbt</span><span class="o">.</span><span class="n">Microscope</span><span class="p">,</span>
</span><span id="beam_dwell_time-265"><a href="#beam_dwell_time-265"><span class="linenos">265</span></a>    <span class="n">dwell_us</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="beam_dwell_time-266"><a href="#beam_dwell_time-266"><span class="linenos">266</span></a>    <span class="n">delay_s</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span>
</span><span id="beam_dwell_time-267"><a href="#beam_dwell_time-267"><span class="linenos">267</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="beam_dwell_time-268"><a href="#beam_dwell_time-268"><span class="linenos">268</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="beam_dwell_time-269"><a href="#beam_dwell_time-269"><span class="linenos">269</span></a><span class="sd">    Sets the dwell time for the selected beam, with inputs in units of microseconds.</span>
</span><span id="beam_dwell_time-270"><a href="#beam_dwell_time-270"><span class="linenos">270</span></a>
</span><span id="beam_dwell_time-271"><a href="#beam_dwell_time-271"><span class="linenos">271</span></a><span class="sd">    This function sets the dwell time for the specified beam type on the microscope.</span>
</span><span id="beam_dwell_time-272"><a href="#beam_dwell_time-272"><span class="linenos">272</span></a><span class="sd">    It converts the dwell time from microseconds to seconds, sets the dwell time, and</span>
</span><span id="beam_dwell_time-273"><a href="#beam_dwell_time-273"><span class="linenos">273</span></a><span class="sd">    waits for the specified delay.</span>
</span><span id="beam_dwell_time-274"><a href="#beam_dwell_time-274"><span class="linenos">274</span></a>
</span><span id="beam_dwell_time-275"><a href="#beam_dwell_time-275"><span class="linenos">275</span></a><span class="sd">    Parameters</span>
</span><span id="beam_dwell_time-276"><a href="#beam_dwell_time-276"><span class="linenos">276</span></a><span class="sd">    ----------</span>
</span><span id="beam_dwell_time-277"><a href="#beam_dwell_time-277"><span class="linenos">277</span></a><span class="sd">    beam : tbt.Beam</span>
</span><span id="beam_dwell_time-278"><a href="#beam_dwell_time-278"><span class="linenos">278</span></a><span class="sd">        The beam type to configure.</span>
</span><span id="beam_dwell_time-279"><a href="#beam_dwell_time-279"><span class="linenos">279</span></a><span class="sd">    microscope : tbt.Microscope</span>
</span><span id="beam_dwell_time-280"><a href="#beam_dwell_time-280"><span class="linenos">280</span></a><span class="sd">        The microscope object to configure.</span>
</span><span id="beam_dwell_time-281"><a href="#beam_dwell_time-281"><span class="linenos">281</span></a><span class="sd">    dwell_us : float</span>
</span><span id="beam_dwell_time-282"><a href="#beam_dwell_time-282"><span class="linenos">282</span></a><span class="sd">        The desired dwell time in microseconds.</span>
</span><span id="beam_dwell_time-283"><a href="#beam_dwell_time-283"><span class="linenos">283</span></a><span class="sd">    delay_s : float, optional</span>
</span><span id="beam_dwell_time-284"><a href="#beam_dwell_time-284"><span class="linenos">284</span></a><span class="sd">        The delay in seconds to wait after adjusting the dwell time (default is 0.1).</span>
</span><span id="beam_dwell_time-285"><a href="#beam_dwell_time-285"><span class="linenos">285</span></a>
</span><span id="beam_dwell_time-286"><a href="#beam_dwell_time-286"><span class="linenos">286</span></a><span class="sd">    Returns</span>
</span><span id="beam_dwell_time-287"><a href="#beam_dwell_time-287"><span class="linenos">287</span></a><span class="sd">    -------</span>
</span><span id="beam_dwell_time-288"><a href="#beam_dwell_time-288"><span class="linenos">288</span></a><span class="sd">    bool</span>
</span><span id="beam_dwell_time-289"><a href="#beam_dwell_time-289"><span class="linenos">289</span></a><span class="sd">        True if the dwell time is set successfully, False otherwise.</span>
</span><span id="beam_dwell_time-290"><a href="#beam_dwell_time-290"><span class="linenos">290</span></a>
</span><span id="beam_dwell_time-291"><a href="#beam_dwell_time-291"><span class="linenos">291</span></a><span class="sd">    Raises</span>
</span><span id="beam_dwell_time-292"><a href="#beam_dwell_time-292"><span class="linenos">292</span></a><span class="sd">    ------</span>
</span><span id="beam_dwell_time-293"><a href="#beam_dwell_time-293"><span class="linenos">293</span></a><span class="sd">    ValueError</span>
</span><span id="beam_dwell_time-294"><a href="#beam_dwell_time-294"><span class="linenos">294</span></a><span class="sd">        If the dwell time cannot be adjusted correctly.</span>
</span><span id="beam_dwell_time-295"><a href="#beam_dwell_time-295"><span class="linenos">295</span></a>
</span><span id="beam_dwell_time-296"><a href="#beam_dwell_time-296"><span class="linenos">296</span></a><span class="sd">    Examples</span>
</span><span id="beam_dwell_time-297"><a href="#beam_dwell_time-297"><span class="linenos">297</span></a><span class="sd">    --------</span>
</span><span id="beam_dwell_time-298"><a href="#beam_dwell_time-298"><span class="linenos">298</span></a><span class="sd">    &gt;&gt;&gt; import pytribeam.types as tbt</span>
</span><span id="beam_dwell_time-299"><a href="#beam_dwell_time-299"><span class="linenos">299</span></a><span class="sd">    &gt;&gt;&gt; microscope = tbt.Microscope()</span>
</span><span id="beam_dwell_time-300"><a href="#beam_dwell_time-300"><span class="linenos">300</span></a><span class="sd">    &gt;&gt;&gt; microscope.connect(&quot;localhost&quot;)</span>
</span><span id="beam_dwell_time-301"><a href="#beam_dwell_time-301"><span class="linenos">301</span></a><span class="sd">    Client connecting to [localhost:7520]...</span>
</span><span id="beam_dwell_time-302"><a href="#beam_dwell_time-302"><span class="linenos">302</span></a><span class="sd">    Client connected to [localhost:7520]</span>
</span><span id="beam_dwell_time-303"><a href="#beam_dwell_time-303"><span class="linenos">303</span></a><span class="sd">    &gt;&gt;&gt; beam = tbt.ElectronBeam(settings=None)</span>
</span><span id="beam_dwell_time-304"><a href="#beam_dwell_time-304"><span class="linenos">304</span></a><span class="sd">    &gt;&gt;&gt; success = beam_dwell_time(beam, microscope, dwell_us=10.0)</span>
</span><span id="beam_dwell_time-305"><a href="#beam_dwell_time-305"><span class="linenos">305</span></a><span class="sd">    &gt;&gt;&gt; print(success)</span>
</span><span id="beam_dwell_time-306"><a href="#beam_dwell_time-306"><span class="linenos">306</span></a><span class="sd">    True</span>
</span><span id="beam_dwell_time-307"><a href="#beam_dwell_time-307"><span class="linenos">307</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="beam_dwell_time-308"><a href="#beam_dwell_time-308"><span class="linenos">308</span></a>    <span class="n">selected_beam</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">beam_type</span><span class="p">(</span><span class="n">beam</span><span class="p">,</span> <span class="n">microscope</span><span class="p">)</span>
</span><span id="beam_dwell_time-309"><a href="#beam_dwell_time-309"><span class="linenos">309</span></a>    <span class="n">dwell_s</span> <span class="o">=</span> <span class="n">dwell_us</span> <span class="o">*</span> <span class="n">cs</span><span class="o">.</span><span class="n">Conversions</span><span class="o">.</span><span class="n">US_TO_S</span>
</span><span id="beam_dwell_time-310"><a href="#beam_dwell_time-310"><span class="linenos">310</span></a>    <span class="n">selected_beam</span><span class="o">.</span><span class="n">scanning</span><span class="o">.</span><span class="n">dwell_time</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">dwell_s</span>
</span><span id="beam_dwell_time-311"><a href="#beam_dwell_time-311"><span class="linenos">311</span></a>    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">delay_s</span><span class="p">)</span>
</span><span id="beam_dwell_time-312"><a href="#beam_dwell_time-312"><span class="linenos">312</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">math</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span>
</span><span id="beam_dwell_time-313"><a href="#beam_dwell_time-313"><span class="linenos">313</span></a>        <span class="n">selected_beam</span><span class="o">.</span><span class="n">scanning</span><span class="o">.</span><span class="n">dwell_time</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
</span><span id="beam_dwell_time-314"><a href="#beam_dwell_time-314"><span class="linenos">314</span></a>        <span class="n">dwell_s</span><span class="p">,</span>
</span><span id="beam_dwell_time-315"><a href="#beam_dwell_time-315"><span class="linenos">315</span></a>        <span class="n">rel_tol</span><span class="o">=</span><span class="n">cs</span><span class="o">.</span><span class="n">Constants</span><span class="o">.</span><span class="n">beam_dwell_tol_ratio</span><span class="p">,</span>
</span><span id="beam_dwell_time-316"><a href="#beam_dwell_time-316"><span class="linenos">316</span></a>    <span class="p">):</span>
</span><span id="beam_dwell_time-317"><a href="#beam_dwell_time-317"><span class="linenos">317</span></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="beam_dwell_time-318"><a href="#beam_dwell_time-318"><span class="linenos">318</span></a>            <span class="sa">f</span><span class="s2">&quot;&quot;&quot;Could not correctly adjust dwell time,</span>
</span><span id="beam_dwell_time-319"><a href="#beam_dwell_time-319"><span class="linenos">319</span></a><span class="s2">            requested </span><span class="si">{</span><span class="n">dwell_s</span><span class="si">}</span><span class="s2"> seconds, current dwell time is</span>
</span><span id="beam_dwell_time-320"><a href="#beam_dwell_time-320"><span class="linenos">320</span></a><span class="s2">            </span><span class="si">{</span><span class="n">selected_beam</span><span class="o">.</span><span class="n">scanning</span><span class="o">.</span><span class="n">dwell_time</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2"> seconds&quot;&quot;&quot;</span>
</span><span id="beam_dwell_time-321"><a href="#beam_dwell_time-321"><span class="linenos">321</span></a>        <span class="p">)</span>
</span><span id="beam_dwell_time-322"><a href="#beam_dwell_time-322"><span class="linenos">322</span></a>
</span><span id="beam_dwell_time-323"><a href="#beam_dwell_time-323"><span class="linenos">323</span></a>    <span class="k">return</span> <span class="kc">True</span>
</span></pre></div>


            <div class="docstring"><p>Sets the dwell time for the selected beam, with inputs in units of microseconds.</p>

<p>This function sets the dwell time for the specified beam type on the microscope.
It converts the dwell time from microseconds to seconds, sets the dwell time, and
waits for the specified delay.</p>

<h2 id="parameters">Parameters</h2>

<p>beam : tbt.Beam
    The beam type to configure.
microscope : tbt.Microscope
    The microscope object to configure.
dwell_us : float
    The desired dwell time in microseconds.
delay_s : float, optional
    The delay in seconds to wait after adjusting the dwell time (default is 0.1).</p>

<h2 id="returns">Returns</h2>

<p>bool
    True if the dwell time is set successfully, False otherwise.</p>

<h2 id="raises">Raises</h2>

<p>ValueError
    If the dwell time cannot be adjusted correctly.</p>

<h2 id="examples">Examples</h2>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn"><a href="types.html">pytribeam.types</a></span> <span class="k">as</span> <span class="nn">tbt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">microscope</span> <span class="o">=</span> <span class="n">tbt</span><span class="o">.</span><span class="n">Microscope</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">microscope</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;localhost&quot;</span><span class="p">)</span>
<span class="go">Client connecting to [localhost:7520]...</span>
<span class="go">Client connected to [localhost:7520]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">beam</span> <span class="o">=</span> <span class="n">tbt</span><span class="o">.</span><span class="n">ElectronBeam</span><span class="p">(</span><span class="n">settings</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">success</span> <span class="o">=</span> <span class="n">beam_dwell_time</span><span class="p">(</span><span class="n">beam</span><span class="p">,</span> <span class="n">microscope</span><span class="p">,</span> <span class="n">dwell_us</span><span class="o">=</span><span class="mf">10.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">success</span><span class="p">)</span>
<span class="go">True</span>
</code></pre>
</div>
</div>


                </section>
                <section id="beam_hfw">
                            <input id="beam_hfw-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">beam_hfw</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">beam</span><span class="p">:</span> <span class="n"><a href="types.html#Beam">pytribeam.types.Beam</a></span>,</span><span class="param">	<span class="n">microscope</span><span class="p">:</span> <span class="n"><a href="types.html#Microscope">pytribeam.types.Microscope</a></span>,</span><span class="param">	<span class="n">hfw_mm</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">delay_s</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.1</span>,</span><span class="param">	<span class="n">hfw_tol_mm</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-06</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <label class="view-source-button" for="beam_hfw-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#beam_hfw"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="beam_hfw-326"><a href="#beam_hfw-326"><span class="linenos">326</span></a><span class="k">def</span> <span class="nf">beam_hfw</span><span class="p">(</span>
</span><span id="beam_hfw-327"><a href="#beam_hfw-327"><span class="linenos">327</span></a>    <span class="n">beam</span><span class="p">:</span> <span class="n">tbt</span><span class="o">.</span><span class="n">Beam</span><span class="p">,</span>
</span><span id="beam_hfw-328"><a href="#beam_hfw-328"><span class="linenos">328</span></a>    <span class="n">microscope</span><span class="p">:</span> <span class="n">tbt</span><span class="o">.</span><span class="n">Microscope</span><span class="p">,</span>
</span><span id="beam_hfw-329"><a href="#beam_hfw-329"><span class="linenos">329</span></a>    <span class="n">hfw_mm</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="beam_hfw-330"><a href="#beam_hfw-330"><span class="linenos">330</span></a>    <span class="n">delay_s</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span>
</span><span id="beam_hfw-331"><a href="#beam_hfw-331"><span class="linenos">331</span></a>    <span class="n">hfw_tol_mm</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">1e-6</span><span class="p">,</span>  <span class="c1"># 1 nm of tolerance</span>
</span><span id="beam_hfw-332"><a href="#beam_hfw-332"><span class="linenos">332</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="beam_hfw-333"><a href="#beam_hfw-333"><span class="linenos">333</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="beam_hfw-334"><a href="#beam_hfw-334"><span class="linenos">334</span></a><span class="sd">    Sets the horizontal field width for the selected beam, with inputs in units of millimeters.</span>
</span><span id="beam_hfw-335"><a href="#beam_hfw-335"><span class="linenos">335</span></a>
</span><span id="beam_hfw-336"><a href="#beam_hfw-336"><span class="linenos">336</span></a><span class="sd">    This function sets the horizontal field width (HFW) for the specified beam type on the microscope.</span>
</span><span id="beam_hfw-337"><a href="#beam_hfw-337"><span class="linenos">337</span></a><span class="sd">    It converts the HFW from millimeters to meters, sets the HFW, and waits for the specified delay.</span>
</span><span id="beam_hfw-338"><a href="#beam_hfw-338"><span class="linenos">338</span></a><span class="sd">    This should be done after adjusting the working distance.</span>
</span><span id="beam_hfw-339"><a href="#beam_hfw-339"><span class="linenos">339</span></a>
</span><span id="beam_hfw-340"><a href="#beam_hfw-340"><span class="linenos">340</span></a><span class="sd">    Parameters</span>
</span><span id="beam_hfw-341"><a href="#beam_hfw-341"><span class="linenos">341</span></a><span class="sd">    ----------</span>
</span><span id="beam_hfw-342"><a href="#beam_hfw-342"><span class="linenos">342</span></a><span class="sd">    beam : tbt.Beam</span>
</span><span id="beam_hfw-343"><a href="#beam_hfw-343"><span class="linenos">343</span></a><span class="sd">        The beam type to configure.</span>
</span><span id="beam_hfw-344"><a href="#beam_hfw-344"><span class="linenos">344</span></a><span class="sd">    microscope : tbt.Microscope</span>
</span><span id="beam_hfw-345"><a href="#beam_hfw-345"><span class="linenos">345</span></a><span class="sd">        The microscope object to configure.</span>
</span><span id="beam_hfw-346"><a href="#beam_hfw-346"><span class="linenos">346</span></a><span class="sd">    hfw_mm : float</span>
</span><span id="beam_hfw-347"><a href="#beam_hfw-347"><span class="linenos">347</span></a><span class="sd">        The desired horizontal field width in millimeters.</span>
</span><span id="beam_hfw-348"><a href="#beam_hfw-348"><span class="linenos">348</span></a><span class="sd">    delay_s : float, optional</span>
</span><span id="beam_hfw-349"><a href="#beam_hfw-349"><span class="linenos">349</span></a><span class="sd">        The delay in seconds to wait after adjusting the HFW (default is 0.1).</span>
</span><span id="beam_hfw-350"><a href="#beam_hfw-350"><span class="linenos">350</span></a>
</span><span id="beam_hfw-351"><a href="#beam_hfw-351"><span class="linenos">351</span></a><span class="sd">    Returns</span>
</span><span id="beam_hfw-352"><a href="#beam_hfw-352"><span class="linenos">352</span></a><span class="sd">    -------</span>
</span><span id="beam_hfw-353"><a href="#beam_hfw-353"><span class="linenos">353</span></a><span class="sd">    bool</span>
</span><span id="beam_hfw-354"><a href="#beam_hfw-354"><span class="linenos">354</span></a><span class="sd">        True if the HFW is set successfully, False otherwise.</span>
</span><span id="beam_hfw-355"><a href="#beam_hfw-355"><span class="linenos">355</span></a>
</span><span id="beam_hfw-356"><a href="#beam_hfw-356"><span class="linenos">356</span></a><span class="sd">    Raises</span>
</span><span id="beam_hfw-357"><a href="#beam_hfw-357"><span class="linenos">357</span></a><span class="sd">    ------</span>
</span><span id="beam_hfw-358"><a href="#beam_hfw-358"><span class="linenos">358</span></a><span class="sd">    ValueError</span>
</span><span id="beam_hfw-359"><a href="#beam_hfw-359"><span class="linenos">359</span></a><span class="sd">        If the HFW cannot be adjusted correctly.</span>
</span><span id="beam_hfw-360"><a href="#beam_hfw-360"><span class="linenos">360</span></a>
</span><span id="beam_hfw-361"><a href="#beam_hfw-361"><span class="linenos">361</span></a><span class="sd">    Examples</span>
</span><span id="beam_hfw-362"><a href="#beam_hfw-362"><span class="linenos">362</span></a><span class="sd">    --------</span>
</span><span id="beam_hfw-363"><a href="#beam_hfw-363"><span class="linenos">363</span></a><span class="sd">    &gt;&gt;&gt; import pytribeam.types as tbt</span>
</span><span id="beam_hfw-364"><a href="#beam_hfw-364"><span class="linenos">364</span></a><span class="sd">    &gt;&gt;&gt; microscope = tbt.Microscope()</span>
</span><span id="beam_hfw-365"><a href="#beam_hfw-365"><span class="linenos">365</span></a><span class="sd">    &gt;&gt;&gt; microscope.connect(&quot;localhost&quot;)</span>
</span><span id="beam_hfw-366"><a href="#beam_hfw-366"><span class="linenos">366</span></a><span class="sd">    Client connecting to [localhost:7520]...</span>
</span><span id="beam_hfw-367"><a href="#beam_hfw-367"><span class="linenos">367</span></a><span class="sd">    Client connected to [localhost:7520]</span>
</span><span id="beam_hfw-368"><a href="#beam_hfw-368"><span class="linenos">368</span></a><span class="sd">    &gt;&gt;&gt; beam = tbt.ElectronBeam(settings=None)</span>
</span><span id="beam_hfw-369"><a href="#beam_hfw-369"><span class="linenos">369</span></a><span class="sd">    &gt;&gt;&gt; success = beam_hfw(beam, microscope, hfw_mm=1.0)</span>
</span><span id="beam_hfw-370"><a href="#beam_hfw-370"><span class="linenos">370</span></a><span class="sd">    &gt;&gt;&gt; print(success)</span>
</span><span id="beam_hfw-371"><a href="#beam_hfw-371"><span class="linenos">371</span></a><span class="sd">    True</span>
</span><span id="beam_hfw-372"><a href="#beam_hfw-372"><span class="linenos">372</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="beam_hfw-373"><a href="#beam_hfw-373"><span class="linenos">373</span></a>    <span class="n">selected_beam</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">beam_type</span><span class="p">(</span><span class="n">beam</span><span class="p">,</span> <span class="n">microscope</span><span class="p">)</span>
</span><span id="beam_hfw-374"><a href="#beam_hfw-374"><span class="linenos">374</span></a>    <span class="n">hfw_m</span> <span class="o">=</span> <span class="n">hfw_mm</span> <span class="o">*</span> <span class="n">cs</span><span class="o">.</span><span class="n">Conversions</span><span class="o">.</span><span class="n">MM_TO_M</span>
</span><span id="beam_hfw-375"><a href="#beam_hfw-375"><span class="linenos">375</span></a>    <span class="n">selected_beam</span><span class="o">.</span><span class="n">horizontal_field_width</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">hfw_m</span>
</span><span id="beam_hfw-376"><a href="#beam_hfw-376"><span class="linenos">376</span></a>    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">delay_s</span><span class="p">)</span>
</span><span id="beam_hfw-377"><a href="#beam_hfw-377"><span class="linenos">377</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">math</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span>
</span><span id="beam_hfw-378"><a href="#beam_hfw-378"><span class="linenos">378</span></a>        <span class="n">selected_beam</span><span class="o">.</span><span class="n">horizontal_field_width</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
</span><span id="beam_hfw-379"><a href="#beam_hfw-379"><span class="linenos">379</span></a>        <span class="n">hfw_m</span><span class="p">,</span>
</span><span id="beam_hfw-380"><a href="#beam_hfw-380"><span class="linenos">380</span></a>        <span class="n">abs_tol</span><span class="o">=</span><span class="n">hfw_tol_mm</span>
</span><span id="beam_hfw-381"><a href="#beam_hfw-381"><span class="linenos">381</span></a>        <span class="o">*</span> <span class="n">cs</span><span class="o">.</span><span class="n">Conversions</span><span class="o">.</span><span class="n">MM_TO_M</span><span class="p">,</span>  <span class="c1"># convert to meters for autoscript calls</span>
</span><span id="beam_hfw-382"><a href="#beam_hfw-382"><span class="linenos">382</span></a>    <span class="p">):</span>
</span><span id="beam_hfw-383"><a href="#beam_hfw-383"><span class="linenos">383</span></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="beam_hfw-384"><a href="#beam_hfw-384"><span class="linenos">384</span></a>            <span class="sa">f</span><span class="s2">&quot;&quot;&quot;Could not correctly adjust horizontal field width,</span>
</span><span id="beam_hfw-385"><a href="#beam_hfw-385"><span class="linenos">385</span></a><span class="s2">            requested </span><span class="si">{</span><span class="n">hfw_mm</span><span class="si">}</span><span class="s2"> millimeters, current field with is</span>
</span><span id="beam_hfw-386"><a href="#beam_hfw-386"><span class="linenos">386</span></a><span class="s2">            </span><span class="si">{</span><span class="n">selected_beam</span><span class="o">.</span><span class="n">horizontal_field_width</span><span class="o">.</span><span class="n">value</span><span class="o">*</span><span class="n">cs</span><span class="o">.</span><span class="n">Conversions</span><span class="o">.</span><span class="n">M_TO_MM</span><span class="si">}</span><span class="s2"> millimeters&quot;&quot;&quot;</span>
</span><span id="beam_hfw-387"><a href="#beam_hfw-387"><span class="linenos">387</span></a>        <span class="p">)</span>
</span><span id="beam_hfw-388"><a href="#beam_hfw-388"><span class="linenos">388</span></a>
</span><span id="beam_hfw-389"><a href="#beam_hfw-389"><span class="linenos">389</span></a>    <span class="k">return</span> <span class="kc">True</span>
</span></pre></div>


            <div class="docstring"><p>Sets the horizontal field width for the selected beam, with inputs in units of millimeters.</p>

<p>This function sets the horizontal field width (HFW) for the specified beam type on the microscope.
It converts the HFW from millimeters to meters, sets the HFW, and waits for the specified delay.
This should be done after adjusting the working distance.</p>

<h2 id="parameters">Parameters</h2>

<p>beam : tbt.Beam
    The beam type to configure.
microscope : tbt.Microscope
    The microscope object to configure.
hfw_mm : float
    The desired horizontal field width in millimeters.
delay_s : float, optional
    The delay in seconds to wait after adjusting the HFW (default is 0.1).</p>

<h2 id="returns">Returns</h2>

<p>bool
    True if the HFW is set successfully, False otherwise.</p>

<h2 id="raises">Raises</h2>

<p>ValueError
    If the HFW cannot be adjusted correctly.</p>

<h2 id="examples">Examples</h2>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn"><a href="types.html">pytribeam.types</a></span> <span class="k">as</span> <span class="nn">tbt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">microscope</span> <span class="o">=</span> <span class="n">tbt</span><span class="o">.</span><span class="n">Microscope</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">microscope</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;localhost&quot;</span><span class="p">)</span>
<span class="go">Client connecting to [localhost:7520]...</span>
<span class="go">Client connected to [localhost:7520]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">beam</span> <span class="o">=</span> <span class="n">tbt</span><span class="o">.</span><span class="n">ElectronBeam</span><span class="p">(</span><span class="n">settings</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">success</span> <span class="o">=</span> <span class="n">beam_hfw</span><span class="p">(</span><span class="n">beam</span><span class="p">,</span> <span class="n">microscope</span><span class="p">,</span> <span class="n">hfw_mm</span><span class="o">=</span><span class="mf">1.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">success</span><span class="p">)</span>
<span class="go">True</span>
</code></pre>
</div>
</div>


                </section>
                <section id="beam_ready">
                            <input id="beam_ready-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">beam_ready</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">beam</span><span class="p">:</span> <span class="n"><a href="types.html#Beam">pytribeam.types.Beam</a></span>,</span><span class="param">	<span class="n">microscope</span><span class="p">:</span> <span class="n"><a href="types.html#Microscope">pytribeam.types.Microscope</a></span>,</span><span class="param">	<span class="n">delay_s</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">5.0</span>,</span><span class="param">	<span class="n">attempts</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <label class="view-source-button" for="beam_ready-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#beam_ready"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="beam_ready-392"><a href="#beam_ready-392"><span class="linenos">392</span></a><span class="k">def</span> <span class="nf">beam_ready</span><span class="p">(</span>
</span><span id="beam_ready-393"><a href="#beam_ready-393"><span class="linenos">393</span></a>    <span class="n">beam</span><span class="p">:</span> <span class="n">tbt</span><span class="o">.</span><span class="n">Beam</span><span class="p">,</span>
</span><span id="beam_ready-394"><a href="#beam_ready-394"><span class="linenos">394</span></a>    <span class="n">microscope</span><span class="p">:</span> <span class="n">tbt</span><span class="o">.</span><span class="n">Microscope</span><span class="p">,</span>
</span><span id="beam_ready-395"><a href="#beam_ready-395"><span class="linenos">395</span></a>    <span class="n">delay_s</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">5.0</span><span class="p">,</span>
</span><span id="beam_ready-396"><a href="#beam_ready-396"><span class="linenos">396</span></a>    <span class="n">attempts</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>
</span><span id="beam_ready-397"><a href="#beam_ready-397"><span class="linenos">397</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="beam_ready-398"><a href="#beam_ready-398"><span class="linenos">398</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="beam_ready-399"><a href="#beam_ready-399"><span class="linenos">399</span></a><span class="sd">    Checks if the beam is on or blanked, and tries to turn it on and unblank it if possible.</span>
</span><span id="beam_ready-400"><a href="#beam_ready-400"><span class="linenos">400</span></a>
</span><span id="beam_ready-401"><a href="#beam_ready-401"><span class="linenos">401</span></a><span class="sd">    This function checks the vacuum state, ensures the beam is on, and unblanks the beam if it is blanked.</span>
</span><span id="beam_ready-402"><a href="#beam_ready-402"><span class="linenos">402</span></a><span class="sd">    It makes multiple attempts to turn on and unblank the beam, waiting for the specified delay between attempts.</span>
</span><span id="beam_ready-403"><a href="#beam_ready-403"><span class="linenos">403</span></a>
</span><span id="beam_ready-404"><a href="#beam_ready-404"><span class="linenos">404</span></a><span class="sd">    Parameters</span>
</span><span id="beam_ready-405"><a href="#beam_ready-405"><span class="linenos">405</span></a><span class="sd">    ----------</span>
</span><span id="beam_ready-406"><a href="#beam_ready-406"><span class="linenos">406</span></a><span class="sd">    beam : tbt.Beam</span>
</span><span id="beam_ready-407"><a href="#beam_ready-407"><span class="linenos">407</span></a><span class="sd">        The beam type to check.</span>
</span><span id="beam_ready-408"><a href="#beam_ready-408"><span class="linenos">408</span></a><span class="sd">    microscope : tbt.Microscope</span>
</span><span id="beam_ready-409"><a href="#beam_ready-409"><span class="linenos">409</span></a><span class="sd">        The microscope object to check.</span>
</span><span id="beam_ready-410"><a href="#beam_ready-410"><span class="linenos">410</span></a><span class="sd">    delay_s : float, optional</span>
</span><span id="beam_ready-411"><a href="#beam_ready-411"><span class="linenos">411</span></a><span class="sd">        The delay in seconds to wait between attempts (default is 5.0).</span>
</span><span id="beam_ready-412"><a href="#beam_ready-412"><span class="linenos">412</span></a><span class="sd">    attempts : int, optional</span>
</span><span id="beam_ready-413"><a href="#beam_ready-413"><span class="linenos">413</span></a><span class="sd">        The number of attempts to turn on and unblank the beam (default is 2).</span>
</span><span id="beam_ready-414"><a href="#beam_ready-414"><span class="linenos">414</span></a>
</span><span id="beam_ready-415"><a href="#beam_ready-415"><span class="linenos">415</span></a><span class="sd">    Returns</span>
</span><span id="beam_ready-416"><a href="#beam_ready-416"><span class="linenos">416</span></a><span class="sd">    -------</span>
</span><span id="beam_ready-417"><a href="#beam_ready-417"><span class="linenos">417</span></a><span class="sd">    bool</span>
</span><span id="beam_ready-418"><a href="#beam_ready-418"><span class="linenos">418</span></a><span class="sd">        True if the beam is ready (on and unblanked), False otherwise.</span>
</span><span id="beam_ready-419"><a href="#beam_ready-419"><span class="linenos">419</span></a>
</span><span id="beam_ready-420"><a href="#beam_ready-420"><span class="linenos">420</span></a><span class="sd">    Raises</span>
</span><span id="beam_ready-421"><a href="#beam_ready-421"><span class="linenos">421</span></a><span class="sd">    ------</span>
</span><span id="beam_ready-422"><a href="#beam_ready-422"><span class="linenos">422</span></a><span class="sd">    ValueError</span>
</span><span id="beam_ready-423"><a href="#beam_ready-423"><span class="linenos">423</span></a><span class="sd">        If the vacuum is not pumped.</span>
</span><span id="beam_ready-424"><a href="#beam_ready-424"><span class="linenos">424</span></a><span class="sd">        If the beam cannot be turned on after the specified number of attempts.</span>
</span><span id="beam_ready-425"><a href="#beam_ready-425"><span class="linenos">425</span></a><span class="sd">        If the beam cannot be unblanked after the specified number of attempts.</span>
</span><span id="beam_ready-426"><a href="#beam_ready-426"><span class="linenos">426</span></a>
</span><span id="beam_ready-427"><a href="#beam_ready-427"><span class="linenos">427</span></a><span class="sd">    Examples</span>
</span><span id="beam_ready-428"><a href="#beam_ready-428"><span class="linenos">428</span></a><span class="sd">    --------</span>
</span><span id="beam_ready-429"><a href="#beam_ready-429"><span class="linenos">429</span></a><span class="sd">    &gt;&gt;&gt; import pytribeam.types as tbt</span>
</span><span id="beam_ready-430"><a href="#beam_ready-430"><span class="linenos">430</span></a><span class="sd">    &gt;&gt;&gt; microscope = tbt.Microscope()</span>
</span><span id="beam_ready-431"><a href="#beam_ready-431"><span class="linenos">431</span></a><span class="sd">    &gt;&gt;&gt; microscope.connect(&quot;localhost&quot;)</span>
</span><span id="beam_ready-432"><a href="#beam_ready-432"><span class="linenos">432</span></a><span class="sd">    Client connecting to [localhost:7520]...</span>
</span><span id="beam_ready-433"><a href="#beam_ready-433"><span class="linenos">433</span></a><span class="sd">    Client connected to [localhost:7520]</span>
</span><span id="beam_ready-434"><a href="#beam_ready-434"><span class="linenos">434</span></a><span class="sd">    &gt;&gt;&gt; beam = tbt.ElectronBeam(settings=None)</span>
</span><span id="beam_ready-435"><a href="#beam_ready-435"><span class="linenos">435</span></a><span class="sd">    &gt;&gt;&gt; success = beam_ready(beam, microscope)</span>
</span><span id="beam_ready-436"><a href="#beam_ready-436"><span class="linenos">436</span></a><span class="sd">    &gt;&gt;&gt; print(success)</span>
</span><span id="beam_ready-437"><a href="#beam_ready-437"><span class="linenos">437</span></a><span class="sd">    True</span>
</span><span id="beam_ready-438"><a href="#beam_ready-438"><span class="linenos">438</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="beam_ready-439"><a href="#beam_ready-439"><span class="linenos">439</span></a>    <span class="n">selected_beam</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">beam_type</span><span class="p">(</span><span class="n">beam</span><span class="p">,</span> <span class="n">microscope</span><span class="p">)</span>
</span><span id="beam_ready-440"><a href="#beam_ready-440"><span class="linenos">440</span></a>
</span><span id="beam_ready-441"><a href="#beam_ready-441"><span class="linenos">441</span></a>    <span class="c1"># check vaccum</span>
</span><span id="beam_ready-442"><a href="#beam_ready-442"><span class="linenos">442</span></a>    <span class="n">vacuum</span> <span class="o">=</span> <span class="n">microscope</span><span class="o">.</span><span class="n">vacuum</span><span class="o">.</span><span class="n">chamber_state</span>
</span><span id="beam_ready-443"><a href="#beam_ready-443"><span class="linenos">443</span></a>    <span class="k">if</span> <span class="n">vacuum</span> <span class="o">!=</span> <span class="n">tbt</span><span class="o">.</span><span class="n">VacuumState</span><span class="o">.</span><span class="n">PUMPED</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>
</span><span id="beam_ready-444"><a href="#beam_ready-444"><span class="linenos">444</span></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Vacuum is not pumped, current state is &quot;</span><span class="si">{</span><span class="n">vacuum</span><span class="si">}</span><span class="s1">&quot;&#39;</span><span class="p">)</span>
</span><span id="beam_ready-445"><a href="#beam_ready-445"><span class="linenos">445</span></a>
</span><span id="beam_ready-446"><a href="#beam_ready-446"><span class="linenos">446</span></a>    <span class="c1"># check beam on</span>
</span><span id="beam_ready-447"><a href="#beam_ready-447"><span class="linenos">447</span></a>    <span class="n">count</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="beam_ready-448"><a href="#beam_ready-448"><span class="linenos">448</span></a>    <span class="k">while</span> <span class="n">count</span> <span class="o">&lt;</span> <span class="n">attempts</span><span class="p">:</span>
</span><span id="beam_ready-449"><a href="#beam_ready-449"><span class="linenos">449</span></a>        <span class="n">beam_on</span> <span class="o">=</span> <span class="n">selected_beam</span><span class="o">.</span><span class="n">is_on</span>
</span><span id="beam_ready-450"><a href="#beam_ready-450"><span class="linenos">450</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">beam_on</span><span class="p">:</span>
</span><span id="beam_ready-451"><a href="#beam_ready-451"><span class="linenos">451</span></a>            <span class="n">selected_beam</span><span class="o">.</span><span class="n">turn_on</span><span class="p">()</span>
</span><span id="beam_ready-452"><a href="#beam_ready-452"><span class="linenos">452</span></a>            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">delay_s</span><span class="p">)</span>
</span><span id="beam_ready-453"><a href="#beam_ready-453"><span class="linenos">453</span></a>        <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="beam_ready-454"><a href="#beam_ready-454"><span class="linenos">454</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">beam_on</span><span class="p">:</span>
</span><span id="beam_ready-455"><a href="#beam_ready-455"><span class="linenos">455</span></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="beam_ready-456"><a href="#beam_ready-456"><span class="linenos">456</span></a>            <span class="sa">f</span><span class="s2">&quot;Unable to turn on </span><span class="si">{</span><span class="n">beam</span><span class="o">.</span><span class="n">type</span><span class="si">}</span><span class="s2"> beam after </span><span class="si">{</span><span class="n">attempts</span><span class="si">}</span><span class="s2"> attempts.&quot;</span>
</span><span id="beam_ready-457"><a href="#beam_ready-457"><span class="linenos">457</span></a>        <span class="p">)</span>
</span><span id="beam_ready-458"><a href="#beam_ready-458"><span class="linenos">458</span></a>
</span><span id="beam_ready-459"><a href="#beam_ready-459"><span class="linenos">459</span></a>    <span class="c1"># check beam blank</span>
</span><span id="beam_ready-460"><a href="#beam_ready-460"><span class="linenos">460</span></a>    <span class="n">count</span><span class="p">:</span> <span class="nb">int</span> <span class="o">=</span> <span class="mi">0</span>
</span><span id="beam_ready-461"><a href="#beam_ready-461"><span class="linenos">461</span></a>    <span class="k">while</span> <span class="n">count</span> <span class="o">&lt;</span> <span class="n">attempts</span><span class="p">:</span>
</span><span id="beam_ready-462"><a href="#beam_ready-462"><span class="linenos">462</span></a>        <span class="n">beam_blank</span> <span class="o">=</span> <span class="n">selected_beam</span><span class="o">.</span><span class="n">is_blanked</span>
</span><span id="beam_ready-463"><a href="#beam_ready-463"><span class="linenos">463</span></a>        <span class="k">if</span> <span class="n">beam_blank</span><span class="p">:</span>
</span><span id="beam_ready-464"><a href="#beam_ready-464"><span class="linenos">464</span></a>            <span class="n">selected_beam</span><span class="o">.</span><span class="n">unblank</span><span class="p">()</span>
</span><span id="beam_ready-465"><a href="#beam_ready-465"><span class="linenos">465</span></a>            <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">delay_s</span><span class="p">)</span>
</span><span id="beam_ready-466"><a href="#beam_ready-466"><span class="linenos">466</span></a>        <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
</span><span id="beam_ready-467"><a href="#beam_ready-467"><span class="linenos">467</span></a>    <span class="k">if</span> <span class="n">beam_blank</span><span class="p">:</span>
</span><span id="beam_ready-468"><a href="#beam_ready-468"><span class="linenos">468</span></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="beam_ready-469"><a href="#beam_ready-469"><span class="linenos">469</span></a>            <span class="sa">f</span><span class="s2">&quot;Unable to unblank </span><span class="si">{</span><span class="n">beam</span><span class="o">.</span><span class="n">type</span><span class="si">}</span><span class="s2"> beam after </span><span class="si">{</span><span class="n">attempts</span><span class="si">}</span><span class="s2"> attempts.&quot;</span>
</span><span id="beam_ready-470"><a href="#beam_ready-470"><span class="linenos">470</span></a>        <span class="p">)</span>
</span><span id="beam_ready-471"><a href="#beam_ready-471"><span class="linenos">471</span></a>
</span><span id="beam_ready-472"><a href="#beam_ready-472"><span class="linenos">472</span></a>    <span class="k">return</span> <span class="kc">True</span>
</span></pre></div>


            <div class="docstring"><p>Checks if the beam is on or blanked, and tries to turn it on and unblank it if possible.</p>

<p>This function checks the vacuum state, ensures the beam is on, and unblanks the beam if it is blanked.
It makes multiple attempts to turn on and unblank the beam, waiting for the specified delay between attempts.</p>

<h2 id="parameters">Parameters</h2>

<p>beam : tbt.Beam
    The beam type to check.
microscope : tbt.Microscope
    The microscope object to check.
delay_s : float, optional
    The delay in seconds to wait between attempts (default is 5.0).
attempts : int, optional
    The number of attempts to turn on and unblank the beam (default is 2).</p>

<h2 id="returns">Returns</h2>

<p>bool
    True if the beam is ready (on and unblanked), False otherwise.</p>

<h2 id="raises">Raises</h2>

<p>ValueError
    If the vacuum is not pumped.
    If the beam cannot be turned on after the specified number of attempts.
    If the beam cannot be unblanked after the specified number of attempts.</p>

<h2 id="examples">Examples</h2>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn"><a href="types.html">pytribeam.types</a></span> <span class="k">as</span> <span class="nn">tbt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">microscope</span> <span class="o">=</span> <span class="n">tbt</span><span class="o">.</span><span class="n">Microscope</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">microscope</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;localhost&quot;</span><span class="p">)</span>
<span class="go">Client connecting to [localhost:7520]...</span>
<span class="go">Client connected to [localhost:7520]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">beam</span> <span class="o">=</span> <span class="n">tbt</span><span class="o">.</span><span class="n">ElectronBeam</span><span class="p">(</span><span class="n">settings</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">success</span> <span class="o">=</span> <span class="n">beam_ready</span><span class="p">(</span><span class="n">beam</span><span class="p">,</span> <span class="n">microscope</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">success</span><span class="p">)</span>
<span class="go">True</span>
</code></pre>
</div>
</div>


                </section>
                <section id="beam_scan_full_frame">
                            <input id="beam_scan_full_frame-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">beam_scan_full_frame</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">beam</span><span class="p">:</span> <span class="n"><a href="types.html#Beam">pytribeam.types.Beam</a></span>,</span><span class="param">	<span class="n">microscope</span><span class="p">:</span> <span class="n"><a href="types.html#Microscope">pytribeam.types.Microscope</a></span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <label class="view-source-button" for="beam_scan_full_frame-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#beam_scan_full_frame"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="beam_scan_full_frame-475"><a href="#beam_scan_full_frame-475"><span class="linenos">475</span></a><span class="k">def</span> <span class="nf">beam_scan_full_frame</span><span class="p">(</span>
</span><span id="beam_scan_full_frame-476"><a href="#beam_scan_full_frame-476"><span class="linenos">476</span></a>    <span class="n">beam</span><span class="p">:</span> <span class="n">tbt</span><span class="o">.</span><span class="n">Beam</span><span class="p">,</span>
</span><span id="beam_scan_full_frame-477"><a href="#beam_scan_full_frame-477"><span class="linenos">477</span></a>    <span class="n">microscope</span><span class="p">:</span> <span class="n">tbt</span><span class="o">.</span><span class="n">Microscope</span><span class="p">,</span>
</span><span id="beam_scan_full_frame-478"><a href="#beam_scan_full_frame-478"><span class="linenos">478</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="beam_scan_full_frame-479"><a href="#beam_scan_full_frame-479"><span class="linenos">479</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="beam_scan_full_frame-480"><a href="#beam_scan_full_frame-480"><span class="linenos">480</span></a><span class="sd">    Set beam scan mode to full frame.</span>
</span><span id="beam_scan_full_frame-481"><a href="#beam_scan_full_frame-481"><span class="linenos">481</span></a>
</span><span id="beam_scan_full_frame-482"><a href="#beam_scan_full_frame-482"><span class="linenos">482</span></a><span class="sd">    This function sets the scanning mode of the specified beam to full frame on the microscope.</span>
</span><span id="beam_scan_full_frame-483"><a href="#beam_scan_full_frame-483"><span class="linenos">483</span></a>
</span><span id="beam_scan_full_frame-484"><a href="#beam_scan_full_frame-484"><span class="linenos">484</span></a><span class="sd">    Parameters</span>
</span><span id="beam_scan_full_frame-485"><a href="#beam_scan_full_frame-485"><span class="linenos">485</span></a><span class="sd">    ----------</span>
</span><span id="beam_scan_full_frame-486"><a href="#beam_scan_full_frame-486"><span class="linenos">486</span></a><span class="sd">    beam : tbt.Beam</span>
</span><span id="beam_scan_full_frame-487"><a href="#beam_scan_full_frame-487"><span class="linenos">487</span></a><span class="sd">        The beam type to configure.</span>
</span><span id="beam_scan_full_frame-488"><a href="#beam_scan_full_frame-488"><span class="linenos">488</span></a><span class="sd">    microscope : tbt.Microscope</span>
</span><span id="beam_scan_full_frame-489"><a href="#beam_scan_full_frame-489"><span class="linenos">489</span></a><span class="sd">        The microscope object to configure.</span>
</span><span id="beam_scan_full_frame-490"><a href="#beam_scan_full_frame-490"><span class="linenos">490</span></a>
</span><span id="beam_scan_full_frame-491"><a href="#beam_scan_full_frame-491"><span class="linenos">491</span></a><span class="sd">    Returns</span>
</span><span id="beam_scan_full_frame-492"><a href="#beam_scan_full_frame-492"><span class="linenos">492</span></a><span class="sd">    -------</span>
</span><span id="beam_scan_full_frame-493"><a href="#beam_scan_full_frame-493"><span class="linenos">493</span></a><span class="sd">    bool</span>
</span><span id="beam_scan_full_frame-494"><a href="#beam_scan_full_frame-494"><span class="linenos">494</span></a><span class="sd">        True if the scan mode is set to full frame successfully, False otherwise.</span>
</span><span id="beam_scan_full_frame-495"><a href="#beam_scan_full_frame-495"><span class="linenos">495</span></a>
</span><span id="beam_scan_full_frame-496"><a href="#beam_scan_full_frame-496"><span class="linenos">496</span></a><span class="sd">    Raises</span>
</span><span id="beam_scan_full_frame-497"><a href="#beam_scan_full_frame-497"><span class="linenos">497</span></a><span class="sd">    ------</span>
</span><span id="beam_scan_full_frame-498"><a href="#beam_scan_full_frame-498"><span class="linenos">498</span></a><span class="sd">    SystemError</span>
</span><span id="beam_scan_full_frame-499"><a href="#beam_scan_full_frame-499"><span class="linenos">499</span></a><span class="sd">        If unable to set the scan mode to full frame.</span>
</span><span id="beam_scan_full_frame-500"><a href="#beam_scan_full_frame-500"><span class="linenos">500</span></a>
</span><span id="beam_scan_full_frame-501"><a href="#beam_scan_full_frame-501"><span class="linenos">501</span></a><span class="sd">    Examples</span>
</span><span id="beam_scan_full_frame-502"><a href="#beam_scan_full_frame-502"><span class="linenos">502</span></a><span class="sd">    --------</span>
</span><span id="beam_scan_full_frame-503"><a href="#beam_scan_full_frame-503"><span class="linenos">503</span></a><span class="sd">    &gt;&gt;&gt; import pytribeam.types as tbt</span>
</span><span id="beam_scan_full_frame-504"><a href="#beam_scan_full_frame-504"><span class="linenos">504</span></a><span class="sd">    &gt;&gt;&gt; microscope = tbt.Microscope()</span>
</span><span id="beam_scan_full_frame-505"><a href="#beam_scan_full_frame-505"><span class="linenos">505</span></a><span class="sd">    &gt;&gt;&gt; microscope.connect(&quot;localhost&quot;)</span>
</span><span id="beam_scan_full_frame-506"><a href="#beam_scan_full_frame-506"><span class="linenos">506</span></a><span class="sd">    Client connecting to [localhost:7520]...</span>
</span><span id="beam_scan_full_frame-507"><a href="#beam_scan_full_frame-507"><span class="linenos">507</span></a><span class="sd">    Client connected to [localhost:7520]</span>
</span><span id="beam_scan_full_frame-508"><a href="#beam_scan_full_frame-508"><span class="linenos">508</span></a><span class="sd">    &gt;&gt;&gt; beam = tbt.ElectronBeam(settings=None)</span>
</span><span id="beam_scan_full_frame-509"><a href="#beam_scan_full_frame-509"><span class="linenos">509</span></a><span class="sd">    &gt;&gt;&gt; success = beam_scan_full_frame(beam, microscope)</span>
</span><span id="beam_scan_full_frame-510"><a href="#beam_scan_full_frame-510"><span class="linenos">510</span></a><span class="sd">    &gt;&gt;&gt; print(success)</span>
</span><span id="beam_scan_full_frame-511"><a href="#beam_scan_full_frame-511"><span class="linenos">511</span></a><span class="sd">    True</span>
</span><span id="beam_scan_full_frame-512"><a href="#beam_scan_full_frame-512"><span class="linenos">512</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="beam_scan_full_frame-513"><a href="#beam_scan_full_frame-513"><span class="linenos">513</span></a>    <span class="n">selected_beam</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">beam_type</span><span class="p">(</span><span class="n">beam</span><span class="p">,</span> <span class="n">microscope</span><span class="p">)</span>
</span><span id="beam_scan_full_frame-514"><a href="#beam_scan_full_frame-514"><span class="linenos">514</span></a>    <span class="n">selected_beam</span><span class="o">.</span><span class="n">scanning</span><span class="o">.</span><span class="n">mode</span><span class="o">.</span><span class="n">set_full_frame</span><span class="p">()</span>
</span><span id="beam_scan_full_frame-515"><a href="#beam_scan_full_frame-515"><span class="linenos">515</span></a>    <span class="n">scan_mode</span> <span class="o">=</span> <span class="n">selected_beam</span><span class="o">.</span><span class="n">scanning</span><span class="o">.</span><span class="n">mode</span><span class="o">.</span><span class="n">value</span>
</span><span id="beam_scan_full_frame-516"><a href="#beam_scan_full_frame-516"><span class="linenos">516</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">scan_mode</span> <span class="o">==</span> <span class="n">tbt</span><span class="o">.</span><span class="n">ScanMode</span><span class="o">.</span><span class="n">FULL_FRAME</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>
</span><span id="beam_scan_full_frame-517"><a href="#beam_scan_full_frame-517"><span class="linenos">517</span></a>        <span class="k">raise</span> <span class="ne">SystemError</span><span class="p">(</span>
</span><span id="beam_scan_full_frame-518"><a href="#beam_scan_full_frame-518"><span class="linenos">518</span></a>            <span class="sa">f</span><span class="s2">&quot;Unable to set imaging to full frame. Current scan mode is </span><span class="si">{</span><span class="n">scan_mode</span><span class="si">}</span><span class="s2">.&quot;</span>
</span><span id="beam_scan_full_frame-519"><a href="#beam_scan_full_frame-519"><span class="linenos">519</span></a>        <span class="p">)</span>
</span><span id="beam_scan_full_frame-520"><a href="#beam_scan_full_frame-520"><span class="linenos">520</span></a>    <span class="k">return</span> <span class="kc">True</span>
</span></pre></div>


            <div class="docstring"><p>Set beam scan mode to full frame.</p>

<p>This function sets the scanning mode of the specified beam to full frame on the microscope.</p>

<h2 id="parameters">Parameters</h2>

<p>beam : tbt.Beam
    The beam type to configure.
microscope : tbt.Microscope
    The microscope object to configure.</p>

<h2 id="returns">Returns</h2>

<p>bool
    True if the scan mode is set to full frame successfully, False otherwise.</p>

<h2 id="raises">Raises</h2>

<p>SystemError
    If unable to set the scan mode to full frame.</p>

<h2 id="examples">Examples</h2>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn"><a href="types.html">pytribeam.types</a></span> <span class="k">as</span> <span class="nn">tbt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">microscope</span> <span class="o">=</span> <span class="n">tbt</span><span class="o">.</span><span class="n">Microscope</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">microscope</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;localhost&quot;</span><span class="p">)</span>
<span class="go">Client connecting to [localhost:7520]...</span>
<span class="go">Client connected to [localhost:7520]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">beam</span> <span class="o">=</span> <span class="n">tbt</span><span class="o">.</span><span class="n">ElectronBeam</span><span class="p">(</span><span class="n">settings</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">success</span> <span class="o">=</span> <span class="n">beam_scan_full_frame</span><span class="p">(</span><span class="n">beam</span><span class="p">,</span> <span class="n">microscope</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">success</span><span class="p">)</span>
<span class="go">True</span>
</code></pre>
</div>
</div>


                </section>
                <section id="beam_scan_resolution">
                            <input id="beam_scan_resolution-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">beam_scan_resolution</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">beam</span><span class="p">:</span> <span class="n"><a href="types.html#Beam">pytribeam.types.Beam</a></span>,</span><span class="param">	<span class="n">microscope</span><span class="p">:</span> <span class="n"><a href="types.html#Microscope">pytribeam.types.Microscope</a></span>,</span><span class="param">	<span class="n">resolution</span><span class="p">:</span> <span class="n"><a href="types.html#Resolution">pytribeam.types.Resolution</a></span>,</span><span class="param">	<span class="n">delay_s</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.1</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <label class="view-source-button" for="beam_scan_resolution-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#beam_scan_resolution"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="beam_scan_resolution-523"><a href="#beam_scan_resolution-523"><span class="linenos">523</span></a><span class="k">def</span> <span class="nf">beam_scan_resolution</span><span class="p">(</span>
</span><span id="beam_scan_resolution-524"><a href="#beam_scan_resolution-524"><span class="linenos">524</span></a>    <span class="n">beam</span><span class="p">:</span> <span class="n">tbt</span><span class="o">.</span><span class="n">Beam</span><span class="p">,</span>
</span><span id="beam_scan_resolution-525"><a href="#beam_scan_resolution-525"><span class="linenos">525</span></a>    <span class="n">microscope</span><span class="p">:</span> <span class="n">tbt</span><span class="o">.</span><span class="n">Microscope</span><span class="p">,</span>
</span><span id="beam_scan_resolution-526"><a href="#beam_scan_resolution-526"><span class="linenos">526</span></a>    <span class="n">resolution</span><span class="p">:</span> <span class="n">tbt</span><span class="o">.</span><span class="n">Resolution</span><span class="p">,</span>
</span><span id="beam_scan_resolution-527"><a href="#beam_scan_resolution-527"><span class="linenos">527</span></a>    <span class="n">delay_s</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span>
</span><span id="beam_scan_resolution-528"><a href="#beam_scan_resolution-528"><span class="linenos">528</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="beam_scan_resolution-529"><a href="#beam_scan_resolution-529"><span class="linenos">529</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="beam_scan_resolution-530"><a href="#beam_scan_resolution-530"><span class="linenos">530</span></a><span class="sd">    Sets the scan resolution for the selected beam, with inputs in units of preset resolutions.</span>
</span><span id="beam_scan_resolution-531"><a href="#beam_scan_resolution-531"><span class="linenos">531</span></a>
</span><span id="beam_scan_resolution-532"><a href="#beam_scan_resolution-532"><span class="linenos">532</span></a><span class="sd">    This function sets the scan resolution for the specified beam type on the microscope.</span>
</span><span id="beam_scan_resolution-533"><a href="#beam_scan_resolution-533"><span class="linenos">533</span></a><span class="sd">    It only works for preset resolutions and waits for the specified delay after setting the resolution.</span>
</span><span id="beam_scan_resolution-534"><a href="#beam_scan_resolution-534"><span class="linenos">534</span></a>
</span><span id="beam_scan_resolution-535"><a href="#beam_scan_resolution-535"><span class="linenos">535</span></a><span class="sd">    Parameters</span>
</span><span id="beam_scan_resolution-536"><a href="#beam_scan_resolution-536"><span class="linenos">536</span></a><span class="sd">    ----------</span>
</span><span id="beam_scan_resolution-537"><a href="#beam_scan_resolution-537"><span class="linenos">537</span></a><span class="sd">    beam : tbt.Beam</span>
</span><span id="beam_scan_resolution-538"><a href="#beam_scan_resolution-538"><span class="linenos">538</span></a><span class="sd">        The beam type to configure.</span>
</span><span id="beam_scan_resolution-539"><a href="#beam_scan_resolution-539"><span class="linenos">539</span></a><span class="sd">    microscope : tbt.Microscope</span>
</span><span id="beam_scan_resolution-540"><a href="#beam_scan_resolution-540"><span class="linenos">540</span></a><span class="sd">        The microscope object to configure.</span>
</span><span id="beam_scan_resolution-541"><a href="#beam_scan_resolution-541"><span class="linenos">541</span></a><span class="sd">    resolution : tbt.Resolution</span>
</span><span id="beam_scan_resolution-542"><a href="#beam_scan_resolution-542"><span class="linenos">542</span></a><span class="sd">        The desired scan resolution (must be a preset resolution).</span>
</span><span id="beam_scan_resolution-543"><a href="#beam_scan_resolution-543"><span class="linenos">543</span></a><span class="sd">    delay_s : float, optional</span>
</span><span id="beam_scan_resolution-544"><a href="#beam_scan_resolution-544"><span class="linenos">544</span></a><span class="sd">        The delay in seconds to wait after adjusting the resolution (default is 0.1).</span>
</span><span id="beam_scan_resolution-545"><a href="#beam_scan_resolution-545"><span class="linenos">545</span></a>
</span><span id="beam_scan_resolution-546"><a href="#beam_scan_resolution-546"><span class="linenos">546</span></a><span class="sd">    Returns</span>
</span><span id="beam_scan_resolution-547"><a href="#beam_scan_resolution-547"><span class="linenos">547</span></a><span class="sd">    -------</span>
</span><span id="beam_scan_resolution-548"><a href="#beam_scan_resolution-548"><span class="linenos">548</span></a><span class="sd">    bool</span>
</span><span id="beam_scan_resolution-549"><a href="#beam_scan_resolution-549"><span class="linenos">549</span></a><span class="sd">        True if the scan resolution is set successfully, False otherwise.</span>
</span><span id="beam_scan_resolution-550"><a href="#beam_scan_resolution-550"><span class="linenos">550</span></a>
</span><span id="beam_scan_resolution-551"><a href="#beam_scan_resolution-551"><span class="linenos">551</span></a><span class="sd">    Raises</span>
</span><span id="beam_scan_resolution-552"><a href="#beam_scan_resolution-552"><span class="linenos">552</span></a><span class="sd">    ------</span>
</span><span id="beam_scan_resolution-553"><a href="#beam_scan_resolution-553"><span class="linenos">553</span></a><span class="sd">    ValueError</span>
</span><span id="beam_scan_resolution-554"><a href="#beam_scan_resolution-554"><span class="linenos">554</span></a><span class="sd">        If a custom resolution is requested or if the resolution cannot be adjusted correctly.</span>
</span><span id="beam_scan_resolution-555"><a href="#beam_scan_resolution-555"><span class="linenos">555</span></a>
</span><span id="beam_scan_resolution-556"><a href="#beam_scan_resolution-556"><span class="linenos">556</span></a><span class="sd">    Examples</span>
</span><span id="beam_scan_resolution-557"><a href="#beam_scan_resolution-557"><span class="linenos">557</span></a><span class="sd">    --------</span>
</span><span id="beam_scan_resolution-558"><a href="#beam_scan_resolution-558"><span class="linenos">558</span></a><span class="sd">    &gt;&gt;&gt; import pytribeam.types as tbt</span>
</span><span id="beam_scan_resolution-559"><a href="#beam_scan_resolution-559"><span class="linenos">559</span></a><span class="sd">    &gt;&gt;&gt; import pytribeam.utility as ut</span>
</span><span id="beam_scan_resolution-560"><a href="#beam_scan_resolution-560"><span class="linenos">560</span></a><span class="sd">    &gt;&gt;&gt; microscope = tbt.Microscope()</span>
</span><span id="beam_scan_resolution-561"><a href="#beam_scan_resolution-561"><span class="linenos">561</span></a><span class="sd">    &gt;&gt;&gt; microscope.connect(&quot;localhost&quot;)</span>
</span><span id="beam_scan_resolution-562"><a href="#beam_scan_resolution-562"><span class="linenos">562</span></a><span class="sd">    Client connecting to [localhost:7520]...</span>
</span><span id="beam_scan_resolution-563"><a href="#beam_scan_resolution-563"><span class="linenos">563</span></a><span class="sd">    Client connected to [localhost:7520]</span>
</span><span id="beam_scan_resolution-564"><a href="#beam_scan_resolution-564"><span class="linenos">564</span></a><span class="sd">    &gt;&gt;&gt; beam = tbt.ElectronBeam(settings=None)</span>
</span><span id="beam_scan_resolution-565"><a href="#beam_scan_resolution-565"><span class="linenos">565</span></a><span class="sd">    &gt;&gt;&gt; resolution = tbt.PresetResolution.HIGH</span>
</span><span id="beam_scan_resolution-566"><a href="#beam_scan_resolution-566"><span class="linenos">566</span></a><span class="sd">    &gt;&gt;&gt; success = beam_scan_resolution(beam, microscope, resolution)</span>
</span><span id="beam_scan_resolution-567"><a href="#beam_scan_resolution-567"><span class="linenos">567</span></a><span class="sd">    &gt;&gt;&gt; print(success)</span>
</span><span id="beam_scan_resolution-568"><a href="#beam_scan_resolution-568"><span class="linenos">568</span></a><span class="sd">    True</span>
</span><span id="beam_scan_resolution-569"><a href="#beam_scan_resolution-569"><span class="linenos">569</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="beam_scan_resolution-570"><a href="#beam_scan_resolution-570"><span class="linenos">570</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">resolution</span><span class="p">,</span> <span class="n">tbt</span><span class="o">.</span><span class="n">PresetResolution</span><span class="p">):</span>
</span><span id="beam_scan_resolution-571"><a href="#beam_scan_resolution-571"><span class="linenos">571</span></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="beam_scan_resolution-572"><a href="#beam_scan_resolution-572"><span class="linenos">572</span></a>            <span class="sa">f</span><span class="s2">&quot;Requested a custom resolution of </span><span class="si">{</span><span class="n">resolution</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2">. Only preset resolutions allowed.&quot;</span>
</span><span id="beam_scan_resolution-573"><a href="#beam_scan_resolution-573"><span class="linenos">573</span></a>        <span class="p">)</span>
</span><span id="beam_scan_resolution-574"><a href="#beam_scan_resolution-574"><span class="linenos">574</span></a>
</span><span id="beam_scan_resolution-575"><a href="#beam_scan_resolution-575"><span class="linenos">575</span></a>    <span class="n">selected_beam</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">beam_type</span><span class="p">(</span><span class="n">beam</span><span class="p">,</span> <span class="n">microscope</span><span class="p">)</span>
</span><span id="beam_scan_resolution-576"><a href="#beam_scan_resolution-576"><span class="linenos">576</span></a>    <span class="n">selected_beam</span><span class="o">.</span><span class="n">scanning</span><span class="o">.</span><span class="n">resolution</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">resolution</span><span class="o">.</span><span class="n">value</span>
</span><span id="beam_scan_resolution-577"><a href="#beam_scan_resolution-577"><span class="linenos">577</span></a>    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">delay_s</span><span class="p">)</span>
</span><span id="beam_scan_resolution-578"><a href="#beam_scan_resolution-578"><span class="linenos">578</span></a>    <span class="k">if</span> <span class="n">selected_beam</span><span class="o">.</span><span class="n">scanning</span><span class="o">.</span><span class="n">resolution</span><span class="o">.</span><span class="n">value</span> <span class="o">!=</span> <span class="n">resolution</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>
</span><span id="beam_scan_resolution-579"><a href="#beam_scan_resolution-579"><span class="linenos">579</span></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="beam_scan_resolution-580"><a href="#beam_scan_resolution-580"><span class="linenos">580</span></a>            <span class="sa">f</span><span class="s2">&quot;&quot;&quot;Could not correctly adjust scan resolution,</span>
</span><span id="beam_scan_resolution-581"><a href="#beam_scan_resolution-581"><span class="linenos">581</span></a><span class="s2">            requested </span><span class="si">{</span><span class="n">resolution</span><span class="si">}</span><span class="s2">, current resolution is</span>
</span><span id="beam_scan_resolution-582"><a href="#beam_scan_resolution-582"><span class="linenos">582</span></a><span class="s2">            </span><span class="si">{</span><span class="n">selected_beam</span><span class="o">.</span><span class="n">scanning</span><span class="o">.</span><span class="n">resolution</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;&quot;&quot;</span>
</span><span id="beam_scan_resolution-583"><a href="#beam_scan_resolution-583"><span class="linenos">583</span></a>        <span class="p">)</span>
</span><span id="beam_scan_resolution-584"><a href="#beam_scan_resolution-584"><span class="linenos">584</span></a>
</span><span id="beam_scan_resolution-585"><a href="#beam_scan_resolution-585"><span class="linenos">585</span></a>    <span class="k">return</span> <span class="kc">True</span>
</span></pre></div>


            <div class="docstring"><p>Sets the scan resolution for the selected beam, with inputs in units of preset resolutions.</p>

<p>This function sets the scan resolution for the specified beam type on the microscope.
It only works for preset resolutions and waits for the specified delay after setting the resolution.</p>

<h2 id="parameters">Parameters</h2>

<p>beam : tbt.Beam
    The beam type to configure.
microscope : tbt.Microscope
    The microscope object to configure.
resolution : tbt.Resolution
    The desired scan resolution (must be a preset resolution).
delay_s : float, optional
    The delay in seconds to wait after adjusting the resolution (default is 0.1).</p>

<h2 id="returns">Returns</h2>

<p>bool
    True if the scan resolution is set successfully, False otherwise.</p>

<h2 id="raises">Raises</h2>

<p>ValueError
    If a custom resolution is requested or if the resolution cannot be adjusted correctly.</p>

<h2 id="examples">Examples</h2>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn"><a href="types.html">pytribeam.types</a></span> <span class="k">as</span> <span class="nn">tbt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">pytribeam.utility</span> <span class="k">as</span> <span class="nn">ut</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">microscope</span> <span class="o">=</span> <span class="n">tbt</span><span class="o">.</span><span class="n">Microscope</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">microscope</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;localhost&quot;</span><span class="p">)</span>
<span class="go">Client connecting to [localhost:7520]...</span>
<span class="go">Client connected to [localhost:7520]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">beam</span> <span class="o">=</span> <span class="n">tbt</span><span class="o">.</span><span class="n">ElectronBeam</span><span class="p">(</span><span class="n">settings</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">resolution</span> <span class="o">=</span> <span class="n">tbt</span><span class="o">.</span><span class="n">PresetResolution</span><span class="o">.</span><span class="n">HIGH</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">success</span> <span class="o">=</span> <span class="n">beam_scan_resolution</span><span class="p">(</span><span class="n">beam</span><span class="p">,</span> <span class="n">microscope</span><span class="p">,</span> <span class="n">resolution</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">success</span><span class="p">)</span>
<span class="go">True</span>
</code></pre>
</div>
</div>


                </section>
                <section id="beam_scan_rotation">
                            <input id="beam_scan_rotation-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">beam_scan_rotation</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">beam</span><span class="p">:</span> <span class="n"><a href="types.html#Beam">pytribeam.types.Beam</a></span>,</span><span class="param">	<span class="n">microscope</span><span class="p">:</span> <span class="n"><a href="types.html#Microscope">pytribeam.types.Microscope</a></span>,</span><span class="param">	<span class="n">rotation_deg</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">delay_s</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.1</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <label class="view-source-button" for="beam_scan_rotation-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#beam_scan_rotation"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="beam_scan_rotation-588"><a href="#beam_scan_rotation-588"><span class="linenos">588</span></a><span class="k">def</span> <span class="nf">beam_scan_rotation</span><span class="p">(</span>
</span><span id="beam_scan_rotation-589"><a href="#beam_scan_rotation-589"><span class="linenos">589</span></a>    <span class="n">beam</span><span class="p">:</span> <span class="n">tbt</span><span class="o">.</span><span class="n">Beam</span><span class="p">,</span>
</span><span id="beam_scan_rotation-590"><a href="#beam_scan_rotation-590"><span class="linenos">590</span></a>    <span class="n">microscope</span><span class="p">:</span> <span class="n">tbt</span><span class="o">.</span><span class="n">Microscope</span><span class="p">,</span>
</span><span id="beam_scan_rotation-591"><a href="#beam_scan_rotation-591"><span class="linenos">591</span></a>    <span class="n">rotation_deg</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="beam_scan_rotation-592"><a href="#beam_scan_rotation-592"><span class="linenos">592</span></a>    <span class="n">delay_s</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span>
</span><span id="beam_scan_rotation-593"><a href="#beam_scan_rotation-593"><span class="linenos">593</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="beam_scan_rotation-594"><a href="#beam_scan_rotation-594"><span class="linenos">594</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="beam_scan_rotation-595"><a href="#beam_scan_rotation-595"><span class="linenos">595</span></a><span class="sd">    Sets the scan rotation for the selected beam, with inputs in units of degrees.</span>
</span><span id="beam_scan_rotation-596"><a href="#beam_scan_rotation-596"><span class="linenos">596</span></a>
</span><span id="beam_scan_rotation-597"><a href="#beam_scan_rotation-597"><span class="linenos">597</span></a><span class="sd">    This function sets the scan rotation for the specified beam type on the microscope.</span>
</span><span id="beam_scan_rotation-598"><a href="#beam_scan_rotation-598"><span class="linenos">598</span></a><span class="sd">    It converts the rotation from degrees to radians, sets the scan rotation, and waits for the specified delay.</span>
</span><span id="beam_scan_rotation-599"><a href="#beam_scan_rotation-599"><span class="linenos">599</span></a>
</span><span id="beam_scan_rotation-600"><a href="#beam_scan_rotation-600"><span class="linenos">600</span></a><span class="sd">    Parameters</span>
</span><span id="beam_scan_rotation-601"><a href="#beam_scan_rotation-601"><span class="linenos">601</span></a><span class="sd">    ----------</span>
</span><span id="beam_scan_rotation-602"><a href="#beam_scan_rotation-602"><span class="linenos">602</span></a><span class="sd">    beam : tbt.Beam</span>
</span><span id="beam_scan_rotation-603"><a href="#beam_scan_rotation-603"><span class="linenos">603</span></a><span class="sd">        The beam type to configure.</span>
</span><span id="beam_scan_rotation-604"><a href="#beam_scan_rotation-604"><span class="linenos">604</span></a><span class="sd">    microscope : tbt.Microscope</span>
</span><span id="beam_scan_rotation-605"><a href="#beam_scan_rotation-605"><span class="linenos">605</span></a><span class="sd">        The microscope object to configure.</span>
</span><span id="beam_scan_rotation-606"><a href="#beam_scan_rotation-606"><span class="linenos">606</span></a><span class="sd">    rotation_deg : float</span>
</span><span id="beam_scan_rotation-607"><a href="#beam_scan_rotation-607"><span class="linenos">607</span></a><span class="sd">        The desired scan rotation in degrees.</span>
</span><span id="beam_scan_rotation-608"><a href="#beam_scan_rotation-608"><span class="linenos">608</span></a><span class="sd">    delay_s : float, optional</span>
</span><span id="beam_scan_rotation-609"><a href="#beam_scan_rotation-609"><span class="linenos">609</span></a><span class="sd">        The delay in seconds to wait after adjusting the scan rotation (default is 0.1).</span>
</span><span id="beam_scan_rotation-610"><a href="#beam_scan_rotation-610"><span class="linenos">610</span></a>
</span><span id="beam_scan_rotation-611"><a href="#beam_scan_rotation-611"><span class="linenos">611</span></a><span class="sd">    Returns</span>
</span><span id="beam_scan_rotation-612"><a href="#beam_scan_rotation-612"><span class="linenos">612</span></a><span class="sd">    -------</span>
</span><span id="beam_scan_rotation-613"><a href="#beam_scan_rotation-613"><span class="linenos">613</span></a><span class="sd">    bool</span>
</span><span id="beam_scan_rotation-614"><a href="#beam_scan_rotation-614"><span class="linenos">614</span></a><span class="sd">        True if the scan rotation is set successfully, False otherwise.</span>
</span><span id="beam_scan_rotation-615"><a href="#beam_scan_rotation-615"><span class="linenos">615</span></a>
</span><span id="beam_scan_rotation-616"><a href="#beam_scan_rotation-616"><span class="linenos">616</span></a><span class="sd">    Raises</span>
</span><span id="beam_scan_rotation-617"><a href="#beam_scan_rotation-617"><span class="linenos">617</span></a><span class="sd">    ------</span>
</span><span id="beam_scan_rotation-618"><a href="#beam_scan_rotation-618"><span class="linenos">618</span></a><span class="sd">    ValueError</span>
</span><span id="beam_scan_rotation-619"><a href="#beam_scan_rotation-619"><span class="linenos">619</span></a><span class="sd">        If the scan rotation cannot be adjusted correctly.</span>
</span><span id="beam_scan_rotation-620"><a href="#beam_scan_rotation-620"><span class="linenos">620</span></a>
</span><span id="beam_scan_rotation-621"><a href="#beam_scan_rotation-621"><span class="linenos">621</span></a><span class="sd">    Examples</span>
</span><span id="beam_scan_rotation-622"><a href="#beam_scan_rotation-622"><span class="linenos">622</span></a><span class="sd">    --------</span>
</span><span id="beam_scan_rotation-623"><a href="#beam_scan_rotation-623"><span class="linenos">623</span></a><span class="sd">    &gt;&gt;&gt; import pytribeam.types as tbt</span>
</span><span id="beam_scan_rotation-624"><a href="#beam_scan_rotation-624"><span class="linenos">624</span></a><span class="sd">    &gt;&gt;&gt; microscope = tbt.Microscope()</span>
</span><span id="beam_scan_rotation-625"><a href="#beam_scan_rotation-625"><span class="linenos">625</span></a><span class="sd">    &gt;&gt;&gt; microscope.connect(&quot;localhost&quot;)</span>
</span><span id="beam_scan_rotation-626"><a href="#beam_scan_rotation-626"><span class="linenos">626</span></a><span class="sd">    Client connecting to [localhost:7520]...</span>
</span><span id="beam_scan_rotation-627"><a href="#beam_scan_rotation-627"><span class="linenos">627</span></a><span class="sd">    Client connected to [localhost:7520]</span>
</span><span id="beam_scan_rotation-628"><a href="#beam_scan_rotation-628"><span class="linenos">628</span></a><span class="sd">    &gt;&gt;&gt; beam = tbt.ElectronBeam(settings=None)</span>
</span><span id="beam_scan_rotation-629"><a href="#beam_scan_rotation-629"><span class="linenos">629</span></a><span class="sd">    &gt;&gt;&gt; success = beam_scan_rotation(beam, microscope, rotation_deg=45.0)</span>
</span><span id="beam_scan_rotation-630"><a href="#beam_scan_rotation-630"><span class="linenos">630</span></a><span class="sd">    &gt;&gt;&gt; print(success)</span>
</span><span id="beam_scan_rotation-631"><a href="#beam_scan_rotation-631"><span class="linenos">631</span></a><span class="sd">    True</span>
</span><span id="beam_scan_rotation-632"><a href="#beam_scan_rotation-632"><span class="linenos">632</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="beam_scan_rotation-633"><a href="#beam_scan_rotation-633"><span class="linenos">633</span></a>    <span class="n">selected_beam</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">beam_type</span><span class="p">(</span><span class="n">beam</span><span class="p">,</span> <span class="n">microscope</span><span class="p">)</span>
</span><span id="beam_scan_rotation-634"><a href="#beam_scan_rotation-634"><span class="linenos">634</span></a>    <span class="n">rotation_rad</span> <span class="o">=</span> <span class="n">rotation_deg</span> <span class="o">*</span> <span class="n">cs</span><span class="o">.</span><span class="n">Conversions</span><span class="o">.</span><span class="n">DEG_TO_RAD</span>
</span><span id="beam_scan_rotation-635"><a href="#beam_scan_rotation-635"><span class="linenos">635</span></a>    <span class="n">selected_beam</span><span class="o">.</span><span class="n">scanning</span><span class="o">.</span><span class="n">rotation</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">rotation_rad</span>
</span><span id="beam_scan_rotation-636"><a href="#beam_scan_rotation-636"><span class="linenos">636</span></a>    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">delay_s</span><span class="p">)</span>
</span><span id="beam_scan_rotation-637"><a href="#beam_scan_rotation-637"><span class="linenos">637</span></a>    <span class="k">if</span> <span class="n">selected_beam</span><span class="o">.</span><span class="n">scanning</span><span class="o">.</span><span class="n">rotation</span><span class="o">.</span><span class="n">value</span> <span class="o">!=</span> <span class="n">rotation_rad</span><span class="p">:</span>
</span><span id="beam_scan_rotation-638"><a href="#beam_scan_rotation-638"><span class="linenos">638</span></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="beam_scan_rotation-639"><a href="#beam_scan_rotation-639"><span class="linenos">639</span></a>            <span class="sa">f</span><span class="s2">&quot;&quot;&quot;Could not correctly adjust scan rotation,</span>
</span><span id="beam_scan_rotation-640"><a href="#beam_scan_rotation-640"><span class="linenos">640</span></a><span class="s2">            requested </span><span class="si">{</span><span class="n">rotation_rad</span><span class="si">}</span><span class="s2"> radians, current scan rotation is</span>
</span><span id="beam_scan_rotation-641"><a href="#beam_scan_rotation-641"><span class="linenos">641</span></a><span class="s2">            </span><span class="si">{</span><span class="n">selected_beam</span><span class="o">.</span><span class="n">scanning</span><span class="o">.</span><span class="n">rotation</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2"> radians&quot;&quot;&quot;</span>
</span><span id="beam_scan_rotation-642"><a href="#beam_scan_rotation-642"><span class="linenos">642</span></a>        <span class="p">)</span>
</span><span id="beam_scan_rotation-643"><a href="#beam_scan_rotation-643"><span class="linenos">643</span></a>
</span><span id="beam_scan_rotation-644"><a href="#beam_scan_rotation-644"><span class="linenos">644</span></a>    <span class="k">return</span> <span class="kc">True</span>
</span></pre></div>


            <div class="docstring"><p>Sets the scan rotation for the selected beam, with inputs in units of degrees.</p>

<p>This function sets the scan rotation for the specified beam type on the microscope.
It converts the rotation from degrees to radians, sets the scan rotation, and waits for the specified delay.</p>

<h2 id="parameters">Parameters</h2>

<p>beam : tbt.Beam
    The beam type to configure.
microscope : tbt.Microscope
    The microscope object to configure.
rotation_deg : float
    The desired scan rotation in degrees.
delay_s : float, optional
    The delay in seconds to wait after adjusting the scan rotation (default is 0.1).</p>

<h2 id="returns">Returns</h2>

<p>bool
    True if the scan rotation is set successfully, False otherwise.</p>

<h2 id="raises">Raises</h2>

<p>ValueError
    If the scan rotation cannot be adjusted correctly.</p>

<h2 id="examples">Examples</h2>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn"><a href="types.html">pytribeam.types</a></span> <span class="k">as</span> <span class="nn">tbt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">microscope</span> <span class="o">=</span> <span class="n">tbt</span><span class="o">.</span><span class="n">Microscope</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">microscope</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;localhost&quot;</span><span class="p">)</span>
<span class="go">Client connecting to [localhost:7520]...</span>
<span class="go">Client connected to [localhost:7520]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">beam</span> <span class="o">=</span> <span class="n">tbt</span><span class="o">.</span><span class="n">ElectronBeam</span><span class="p">(</span><span class="n">settings</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">success</span> <span class="o">=</span> <span class="n">beam_scan_rotation</span><span class="p">(</span><span class="n">beam</span><span class="p">,</span> <span class="n">microscope</span><span class="p">,</span> <span class="n">rotation_deg</span><span class="o">=</span><span class="mf">45.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">success</span><span class="p">)</span>
<span class="go">True</span>
</code></pre>
</div>
</div>


                </section>
                <section id="beam_voltage">
                            <input id="beam_voltage-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">beam_voltage</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">beam</span><span class="p">:</span> <span class="n"><a href="types.html#Beam">pytribeam.types.Beam</a></span>,</span><span class="param">	<span class="n">microscope</span><span class="p">:</span> <span class="n"><a href="types.html#Microscope">pytribeam.types.Microscope</a></span>,</span><span class="param">	<span class="n">voltage_kv</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">voltage_tol_kv</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">delay_s</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">5.0</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <label class="view-source-button" for="beam_voltage-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#beam_voltage"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="beam_voltage-647"><a href="#beam_voltage-647"><span class="linenos">647</span></a><span class="k">def</span> <span class="nf">beam_voltage</span><span class="p">(</span>
</span><span id="beam_voltage-648"><a href="#beam_voltage-648"><span class="linenos">648</span></a>    <span class="n">beam</span><span class="p">:</span> <span class="n">tbt</span><span class="o">.</span><span class="n">Beam</span><span class="p">,</span>
</span><span id="beam_voltage-649"><a href="#beam_voltage-649"><span class="linenos">649</span></a>    <span class="n">microscope</span><span class="p">:</span> <span class="n">tbt</span><span class="o">.</span><span class="n">Microscope</span><span class="p">,</span>
</span><span id="beam_voltage-650"><a href="#beam_voltage-650"><span class="linenos">650</span></a>    <span class="n">voltage_kv</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="beam_voltage-651"><a href="#beam_voltage-651"><span class="linenos">651</span></a>    <span class="n">voltage_tol_kv</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="beam_voltage-652"><a href="#beam_voltage-652"><span class="linenos">652</span></a>    <span class="n">delay_s</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">5.0</span><span class="p">,</span>
</span><span id="beam_voltage-653"><a href="#beam_voltage-653"><span class="linenos">653</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="beam_voltage-654"><a href="#beam_voltage-654"><span class="linenos">654</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="beam_voltage-655"><a href="#beam_voltage-655"><span class="linenos">655</span></a><span class="sd">    Sets the voltage for a given beam type, with inputs in units of kilovolts.</span>
</span><span id="beam_voltage-656"><a href="#beam_voltage-656"><span class="linenos">656</span></a>
</span><span id="beam_voltage-657"><a href="#beam_voltage-657"><span class="linenos">657</span></a><span class="sd">    This function sets the beam voltage for the specified beam type on the microscope.</span>
</span><span id="beam_voltage-658"><a href="#beam_voltage-658"><span class="linenos">658</span></a><span class="sd">    If the voltage difference exceeds the tolerance, it adjusts the beam voltage and waits for the specified delay.</span>
</span><span id="beam_voltage-659"><a href="#beam_voltage-659"><span class="linenos">659</span></a>
</span><span id="beam_voltage-660"><a href="#beam_voltage-660"><span class="linenos">660</span></a><span class="sd">    Parameters</span>
</span><span id="beam_voltage-661"><a href="#beam_voltage-661"><span class="linenos">661</span></a><span class="sd">    ----------</span>
</span><span id="beam_voltage-662"><a href="#beam_voltage-662"><span class="linenos">662</span></a><span class="sd">    beam : tbt.Beam</span>
</span><span id="beam_voltage-663"><a href="#beam_voltage-663"><span class="linenos">663</span></a><span class="sd">        The beam type to configure.</span>
</span><span id="beam_voltage-664"><a href="#beam_voltage-664"><span class="linenos">664</span></a><span class="sd">    microscope : tbt.Microscope</span>
</span><span id="beam_voltage-665"><a href="#beam_voltage-665"><span class="linenos">665</span></a><span class="sd">        The microscope object to configure.</span>
</span><span id="beam_voltage-666"><a href="#beam_voltage-666"><span class="linenos">666</span></a><span class="sd">    voltage_kv : float</span>
</span><span id="beam_voltage-667"><a href="#beam_voltage-667"><span class="linenos">667</span></a><span class="sd">        The desired beam voltage in kilovolts.</span>
</span><span id="beam_voltage-668"><a href="#beam_voltage-668"><span class="linenos">668</span></a><span class="sd">    voltage_tol_kv : float</span>
</span><span id="beam_voltage-669"><a href="#beam_voltage-669"><span class="linenos">669</span></a><span class="sd">        The tolerance for the beam voltage in kilovolts.</span>
</span><span id="beam_voltage-670"><a href="#beam_voltage-670"><span class="linenos">670</span></a><span class="sd">    delay_s : float, optional</span>
</span><span id="beam_voltage-671"><a href="#beam_voltage-671"><span class="linenos">671</span></a><span class="sd">        The delay in seconds to wait after adjusting the beam voltage (default is 5.0).</span>
</span><span id="beam_voltage-672"><a href="#beam_voltage-672"><span class="linenos">672</span></a>
</span><span id="beam_voltage-673"><a href="#beam_voltage-673"><span class="linenos">673</span></a><span class="sd">    Returns</span>
</span><span id="beam_voltage-674"><a href="#beam_voltage-674"><span class="linenos">674</span></a><span class="sd">    -------</span>
</span><span id="beam_voltage-675"><a href="#beam_voltage-675"><span class="linenos">675</span></a><span class="sd">    bool</span>
</span><span id="beam_voltage-676"><a href="#beam_voltage-676"><span class="linenos">676</span></a><span class="sd">        True if the beam voltage is set successfully, False otherwise.</span>
</span><span id="beam_voltage-677"><a href="#beam_voltage-677"><span class="linenos">677</span></a>
</span><span id="beam_voltage-678"><a href="#beam_voltage-678"><span class="linenos">678</span></a><span class="sd">    Raises</span>
</span><span id="beam_voltage-679"><a href="#beam_voltage-679"><span class="linenos">679</span></a><span class="sd">    ------</span>
</span><span id="beam_voltage-680"><a href="#beam_voltage-680"><span class="linenos">680</span></a><span class="sd">    ValueError</span>
</span><span id="beam_voltage-681"><a href="#beam_voltage-681"><span class="linenos">681</span></a><span class="sd">        If the beam voltage cannot be adjusted within the specified tolerance.</span>
</span><span id="beam_voltage-682"><a href="#beam_voltage-682"><span class="linenos">682</span></a><span class="sd">        If the beam is not controllable.</span>
</span><span id="beam_voltage-683"><a href="#beam_voltage-683"><span class="linenos">683</span></a>
</span><span id="beam_voltage-684"><a href="#beam_voltage-684"><span class="linenos">684</span></a><span class="sd">    Examples</span>
</span><span id="beam_voltage-685"><a href="#beam_voltage-685"><span class="linenos">685</span></a><span class="sd">    --------</span>
</span><span id="beam_voltage-686"><a href="#beam_voltage-686"><span class="linenos">686</span></a><span class="sd">    &gt;&gt;&gt; import pytribeam.types as tbt</span>
</span><span id="beam_voltage-687"><a href="#beam_voltage-687"><span class="linenos">687</span></a><span class="sd">    &gt;&gt;&gt; microscope = tbt.Microscope()</span>
</span><span id="beam_voltage-688"><a href="#beam_voltage-688"><span class="linenos">688</span></a><span class="sd">    &gt;&gt;&gt; microscope.connect(&quot;localhost&quot;)</span>
</span><span id="beam_voltage-689"><a href="#beam_voltage-689"><span class="linenos">689</span></a><span class="sd">    Client connecting to [localhost:7520]...</span>
</span><span id="beam_voltage-690"><a href="#beam_voltage-690"><span class="linenos">690</span></a><span class="sd">    Client connected to [localhost:7520]</span>
</span><span id="beam_voltage-691"><a href="#beam_voltage-691"><span class="linenos">691</span></a><span class="sd">    &gt;&gt;&gt; beam = tbt.ElectronBeam(settings=None)</span>
</span><span id="beam_voltage-692"><a href="#beam_voltage-692"><span class="linenos">692</span></a><span class="sd">    &gt;&gt;&gt; success = beam_voltage(beam, microscope, voltage_kv=15.0, voltage_tol_kv=0.5)</span>
</span><span id="beam_voltage-693"><a href="#beam_voltage-693"><span class="linenos">693</span></a><span class="sd">    &gt;&gt;&gt; print(success)</span>
</span><span id="beam_voltage-694"><a href="#beam_voltage-694"><span class="linenos">694</span></a><span class="sd">    True</span>
</span><span id="beam_voltage-695"><a href="#beam_voltage-695"><span class="linenos">695</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="beam_voltage-696"><a href="#beam_voltage-696"><span class="linenos">696</span></a>    <span class="n">selected_beam</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">beam_type</span><span class="p">(</span><span class="n">beam</span><span class="p">,</span> <span class="n">microscope</span><span class="p">)</span>
</span><span id="beam_voltage-697"><a href="#beam_voltage-697"><span class="linenos">697</span></a>
</span><span id="beam_voltage-698"><a href="#beam_voltage-698"><span class="linenos">698</span></a>    <span class="n">exisiting_voltage_v</span> <span class="o">=</span> <span class="n">selected_beam</span><span class="o">.</span><span class="n">high_voltage</span><span class="o">.</span><span class="n">value</span>  <span class="c1"># volts</span>
</span><span id="beam_voltage-699"><a href="#beam_voltage-699"><span class="linenos">699</span></a>    <span class="n">delta_voltage_kv</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span>
</span><span id="beam_voltage-700"><a href="#beam_voltage-700"><span class="linenos">700</span></a>        <span class="n">exisiting_voltage_v</span> <span class="o">*</span> <span class="n">cs</span><span class="o">.</span><span class="n">Conversions</span><span class="o">.</span><span class="n">V_TO_KV</span> <span class="o">-</span> <span class="n">voltage_kv</span>
</span><span id="beam_voltage-701"><a href="#beam_voltage-701"><span class="linenos">701</span></a>    <span class="p">)</span>  <span class="c1"># kilovolts</span>
</span><span id="beam_voltage-702"><a href="#beam_voltage-702"><span class="linenos">702</span></a>    <span class="k">if</span> <span class="n">delta_voltage_kv</span> <span class="o">&gt;</span> <span class="n">voltage_tol_kv</span><span class="p">:</span>
</span><span id="beam_voltage-703"><a href="#beam_voltage-703"><span class="linenos">703</span></a>        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
</span><span id="beam_voltage-704"><a href="#beam_voltage-704"><span class="linenos">704</span></a>            <span class="s2">&quot;Requested beam current is not the current setting, imaging conditions may be non-ideal.&quot;</span>
</span><span id="beam_voltage-705"><a href="#beam_voltage-705"><span class="linenos">705</span></a>        <span class="p">)</span>
</span><span id="beam_voltage-706"><a href="#beam_voltage-706"><span class="linenos">706</span></a>        <span class="n">beam_controllable</span> <span class="o">=</span> <span class="n">selected_beam</span><span class="o">.</span><span class="n">high_voltage</span><span class="o">.</span><span class="n">is_controllable</span>
</span><span id="beam_voltage-707"><a href="#beam_voltage-707"><span class="linenos">707</span></a>
</span><span id="beam_voltage-708"><a href="#beam_voltage-708"><span class="linenos">708</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="n">beam_controllable</span><span class="p">:</span>
</span><span id="beam_voltage-709"><a href="#beam_voltage-709"><span class="linenos">709</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="beam_voltage-710"><a href="#beam_voltage-710"><span class="linenos">710</span></a>                <span class="sa">f</span><span class="s2">&quot;Unable to modify beam voltage, beam is not currently controllable.&quot;</span>
</span><span id="beam_voltage-711"><a href="#beam_voltage-711"><span class="linenos">711</span></a>            <span class="p">)</span>
</span><span id="beam_voltage-712"><a href="#beam_voltage-712"><span class="linenos">712</span></a>        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Adjusting beam voltage...&quot;</span><span class="p">)</span>
</span><span id="beam_voltage-713"><a href="#beam_voltage-713"><span class="linenos">713</span></a>        <span class="n">selected_beam</span><span class="o">.</span><span class="n">high_voltage</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">voltage_kv</span> <span class="o">*</span> <span class="n">cs</span><span class="o">.</span><span class="n">Conversions</span><span class="o">.</span><span class="n">KV_TO_V</span>
</span><span id="beam_voltage-714"><a href="#beam_voltage-714"><span class="linenos">714</span></a>        <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">delay_s</span><span class="p">)</span>
</span><span id="beam_voltage-715"><a href="#beam_voltage-715"><span class="linenos">715</span></a>        <span class="n">new_voltage_kv</span> <span class="o">=</span> <span class="n">selected_beam</span><span class="o">.</span><span class="n">high_voltage</span><span class="o">.</span><span class="n">value</span> <span class="o">*</span> <span class="n">cs</span><span class="o">.</span><span class="n">Conversions</span><span class="o">.</span><span class="n">V_TO_KV</span>
</span><span id="beam_voltage-716"><a href="#beam_voltage-716"><span class="linenos">716</span></a>        <span class="n">voltage_diff_kv</span> <span class="o">=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">new_voltage_kv</span> <span class="o">-</span> <span class="n">voltage_kv</span><span class="p">)</span>
</span><span id="beam_voltage-717"><a href="#beam_voltage-717"><span class="linenos">717</span></a>        <span class="k">if</span> <span class="n">voltage_diff_kv</span> <span class="o">&gt;</span> <span class="n">voltage_tol_kv</span><span class="p">:</span>
</span><span id="beam_voltage-718"><a href="#beam_voltage-718"><span class="linenos">718</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="beam_voltage-719"><a href="#beam_voltage-719"><span class="linenos">719</span></a>                <span class="sa">f</span><span class="s2">&quot;&quot;&quot;Could not correctly adjust beam voltage,</span>
</span><span id="beam_voltage-720"><a href="#beam_voltage-720"><span class="linenos">720</span></a><span class="s2">                requested </span><span class="si">{</span><span class="n">voltage_kv</span><span class="si">}</span><span class="s2"> kV, current beam voltage is</span>
</span><span id="beam_voltage-721"><a href="#beam_voltage-721"><span class="linenos">721</span></a><span class="s2">                </span><span class="si">{</span><span class="n">new_voltage_kv</span><span class="si">}</span><span class="s2"> kV&quot;&quot;&quot;</span>
</span><span id="beam_voltage-722"><a href="#beam_voltage-722"><span class="linenos">722</span></a>            <span class="p">)</span>
</span><span id="beam_voltage-723"><a href="#beam_voltage-723"><span class="linenos">723</span></a>
</span><span id="beam_voltage-724"><a href="#beam_voltage-724"><span class="linenos">724</span></a>    <span class="k">return</span> <span class="kc">True</span>
</span></pre></div>


            <div class="docstring"><p>Sets the voltage for a given beam type, with inputs in units of kilovolts.</p>

<p>This function sets the beam voltage for the specified beam type on the microscope.
If the voltage difference exceeds the tolerance, it adjusts the beam voltage and waits for the specified delay.</p>

<h2 id="parameters">Parameters</h2>

<p>beam : tbt.Beam
    The beam type to configure.
microscope : tbt.Microscope
    The microscope object to configure.
voltage_kv : float
    The desired beam voltage in kilovolts.
voltage_tol_kv : float
    The tolerance for the beam voltage in kilovolts.
delay_s : float, optional
    The delay in seconds to wait after adjusting the beam voltage (default is 5.0).</p>

<h2 id="returns">Returns</h2>

<p>bool
    True if the beam voltage is set successfully, False otherwise.</p>

<h2 id="raises">Raises</h2>

<p>ValueError
    If the beam voltage cannot be adjusted within the specified tolerance.
    If the beam is not controllable.</p>

<h2 id="examples">Examples</h2>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn"><a href="types.html">pytribeam.types</a></span> <span class="k">as</span> <span class="nn">tbt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">microscope</span> <span class="o">=</span> <span class="n">tbt</span><span class="o">.</span><span class="n">Microscope</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">microscope</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;localhost&quot;</span><span class="p">)</span>
<span class="go">Client connecting to [localhost:7520]...</span>
<span class="go">Client connected to [localhost:7520]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">beam</span> <span class="o">=</span> <span class="n">tbt</span><span class="o">.</span><span class="n">ElectronBeam</span><span class="p">(</span><span class="n">settings</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">success</span> <span class="o">=</span> <span class="n">beam_voltage</span><span class="p">(</span><span class="n">beam</span><span class="p">,</span> <span class="n">microscope</span><span class="p">,</span> <span class="n">voltage_kv</span><span class="o">=</span><span class="mf">15.0</span><span class="p">,</span> <span class="n">voltage_tol_kv</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">success</span><span class="p">)</span>
<span class="go">True</span>
</code></pre>
</div>
</div>


                </section>
                <section id="beam_working_distance">
                            <input id="beam_working_distance-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">beam_working_distance</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">beam</span><span class="p">:</span> <span class="n"><a href="types.html#Beam">pytribeam.types.Beam</a></span>,</span><span class="param">	<span class="n">microscope</span><span class="p">:</span> <span class="n"><a href="types.html#Microscope">pytribeam.types.Microscope</a></span>,</span><span class="param">	<span class="n">wd_mm</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">delay_s</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.1</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <label class="view-source-button" for="beam_working_distance-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#beam_working_distance"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="beam_working_distance-727"><a href="#beam_working_distance-727"><span class="linenos">727</span></a><span class="k">def</span> <span class="nf">beam_working_distance</span><span class="p">(</span>
</span><span id="beam_working_distance-728"><a href="#beam_working_distance-728"><span class="linenos">728</span></a>    <span class="n">beam</span><span class="p">:</span> <span class="n">tbt</span><span class="o">.</span><span class="n">Beam</span><span class="p">,</span>
</span><span id="beam_working_distance-729"><a href="#beam_working_distance-729"><span class="linenos">729</span></a>    <span class="n">microscope</span><span class="p">:</span> <span class="n">tbt</span><span class="o">.</span><span class="n">Microscope</span><span class="p">,</span>
</span><span id="beam_working_distance-730"><a href="#beam_working_distance-730"><span class="linenos">730</span></a>    <span class="n">wd_mm</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="beam_working_distance-731"><a href="#beam_working_distance-731"><span class="linenos">731</span></a>    <span class="n">delay_s</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span>
</span><span id="beam_working_distance-732"><a href="#beam_working_distance-732"><span class="linenos">732</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="beam_working_distance-733"><a href="#beam_working_distance-733"><span class="linenos">733</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="beam_working_distance-734"><a href="#beam_working_distance-734"><span class="linenos">734</span></a><span class="sd">    Sets the working distance for the selected beam, with inputs in units of millimeters.</span>
</span><span id="beam_working_distance-735"><a href="#beam_working_distance-735"><span class="linenos">735</span></a>
</span><span id="beam_working_distance-736"><a href="#beam_working_distance-736"><span class="linenos">736</span></a><span class="sd">    This function sets the working distance (WD) for the specified beam type on the microscope.</span>
</span><span id="beam_working_distance-737"><a href="#beam_working_distance-737"><span class="linenos">737</span></a><span class="sd">    It converts the WD from millimeters to meters, sets the WD, and waits for the specified delay.</span>
</span><span id="beam_working_distance-738"><a href="#beam_working_distance-738"><span class="linenos">738</span></a><span class="sd">    This should be done before adjusting the horizontal field width.</span>
</span><span id="beam_working_distance-739"><a href="#beam_working_distance-739"><span class="linenos">739</span></a>
</span><span id="beam_working_distance-740"><a href="#beam_working_distance-740"><span class="linenos">740</span></a><span class="sd">    Parameters</span>
</span><span id="beam_working_distance-741"><a href="#beam_working_distance-741"><span class="linenos">741</span></a><span class="sd">    ----------</span>
</span><span id="beam_working_distance-742"><a href="#beam_working_distance-742"><span class="linenos">742</span></a><span class="sd">    beam : tbt.Beam</span>
</span><span id="beam_working_distance-743"><a href="#beam_working_distance-743"><span class="linenos">743</span></a><span class="sd">        The beam type to configure.</span>
</span><span id="beam_working_distance-744"><a href="#beam_working_distance-744"><span class="linenos">744</span></a><span class="sd">    microscope : tbt.Microscope</span>
</span><span id="beam_working_distance-745"><a href="#beam_working_distance-745"><span class="linenos">745</span></a><span class="sd">        The microscope object to configure.</span>
</span><span id="beam_working_distance-746"><a href="#beam_working_distance-746"><span class="linenos">746</span></a><span class="sd">    wd_mm : float</span>
</span><span id="beam_working_distance-747"><a href="#beam_working_distance-747"><span class="linenos">747</span></a><span class="sd">        The desired working distance in millimeters.</span>
</span><span id="beam_working_distance-748"><a href="#beam_working_distance-748"><span class="linenos">748</span></a><span class="sd">    delay_s : float, optional</span>
</span><span id="beam_working_distance-749"><a href="#beam_working_distance-749"><span class="linenos">749</span></a><span class="sd">        The delay in seconds to wait after adjusting the working distance (default is 0.1).</span>
</span><span id="beam_working_distance-750"><a href="#beam_working_distance-750"><span class="linenos">750</span></a>
</span><span id="beam_working_distance-751"><a href="#beam_working_distance-751"><span class="linenos">751</span></a><span class="sd">    Returns</span>
</span><span id="beam_working_distance-752"><a href="#beam_working_distance-752"><span class="linenos">752</span></a><span class="sd">    -------</span>
</span><span id="beam_working_distance-753"><a href="#beam_working_distance-753"><span class="linenos">753</span></a><span class="sd">    bool</span>
</span><span id="beam_working_distance-754"><a href="#beam_working_distance-754"><span class="linenos">754</span></a><span class="sd">        True if the working distance is set successfully, False otherwise.</span>
</span><span id="beam_working_distance-755"><a href="#beam_working_distance-755"><span class="linenos">755</span></a>
</span><span id="beam_working_distance-756"><a href="#beam_working_distance-756"><span class="linenos">756</span></a><span class="sd">    Raises</span>
</span><span id="beam_working_distance-757"><a href="#beam_working_distance-757"><span class="linenos">757</span></a><span class="sd">    ------</span>
</span><span id="beam_working_distance-758"><a href="#beam_working_distance-758"><span class="linenos">758</span></a><span class="sd">    ValueError</span>
</span><span id="beam_working_distance-759"><a href="#beam_working_distance-759"><span class="linenos">759</span></a><span class="sd">        If the working distance cannot be adjusted correctly.</span>
</span><span id="beam_working_distance-760"><a href="#beam_working_distance-760"><span class="linenos">760</span></a>
</span><span id="beam_working_distance-761"><a href="#beam_working_distance-761"><span class="linenos">761</span></a><span class="sd">    Examples</span>
</span><span id="beam_working_distance-762"><a href="#beam_working_distance-762"><span class="linenos">762</span></a><span class="sd">    --------</span>
</span><span id="beam_working_distance-763"><a href="#beam_working_distance-763"><span class="linenos">763</span></a><span class="sd">    &gt;&gt;&gt; import pytribeam.types as tbt</span>
</span><span id="beam_working_distance-764"><a href="#beam_working_distance-764"><span class="linenos">764</span></a><span class="sd">    &gt;&gt;&gt; microscope = tbt.Microscope()</span>
</span><span id="beam_working_distance-765"><a href="#beam_working_distance-765"><span class="linenos">765</span></a><span class="sd">    &gt;&gt;&gt; microscope.connect(&quot;localhost&quot;)</span>
</span><span id="beam_working_distance-766"><a href="#beam_working_distance-766"><span class="linenos">766</span></a><span class="sd">    Client connecting to [localhost:7520]...</span>
</span><span id="beam_working_distance-767"><a href="#beam_working_distance-767"><span class="linenos">767</span></a><span class="sd">    Client connected to [localhost:7520]</span>
</span><span id="beam_working_distance-768"><a href="#beam_working_distance-768"><span class="linenos">768</span></a><span class="sd">    &gt;&gt;&gt; beam = tbt.ElectronBeam(settings=None)</span>
</span><span id="beam_working_distance-769"><a href="#beam_working_distance-769"><span class="linenos">769</span></a><span class="sd">    &gt;&gt;&gt; success = beam_working_dist(beam, microscope, wd_mm=5.0)</span>
</span><span id="beam_working_distance-770"><a href="#beam_working_distance-770"><span class="linenos">770</span></a><span class="sd">    &gt;&gt;&gt; print(success)</span>
</span><span id="beam_working_distance-771"><a href="#beam_working_distance-771"><span class="linenos">771</span></a><span class="sd">    True</span>
</span><span id="beam_working_distance-772"><a href="#beam_working_distance-772"><span class="linenos">772</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="beam_working_distance-773"><a href="#beam_working_distance-773"><span class="linenos">773</span></a>    <span class="n">selected_beam</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">beam_type</span><span class="p">(</span><span class="n">beam</span><span class="p">,</span> <span class="n">microscope</span><span class="p">)</span>
</span><span id="beam_working_distance-774"><a href="#beam_working_distance-774"><span class="linenos">774</span></a>    <span class="n">wd_m</span> <span class="o">=</span> <span class="n">wd_mm</span> <span class="o">*</span> <span class="n">cs</span><span class="o">.</span><span class="n">Conversions</span><span class="o">.</span><span class="n">MM_TO_M</span>
</span><span id="beam_working_distance-775"><a href="#beam_working_distance-775"><span class="linenos">775</span></a>    <span class="n">selected_beam</span><span class="o">.</span><span class="n">working_distance</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">wd_m</span>
</span><span id="beam_working_distance-776"><a href="#beam_working_distance-776"><span class="linenos">776</span></a>    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">delay_s</span><span class="p">)</span>
</span><span id="beam_working_distance-777"><a href="#beam_working_distance-777"><span class="linenos">777</span></a>    <span class="k">if</span> <span class="n">selected_beam</span><span class="o">.</span><span class="n">working_distance</span><span class="o">.</span><span class="n">value</span> <span class="o">!=</span> <span class="n">wd_m</span><span class="p">:</span>
</span><span id="beam_working_distance-778"><a href="#beam_working_distance-778"><span class="linenos">778</span></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="beam_working_distance-779"><a href="#beam_working_distance-779"><span class="linenos">779</span></a>            <span class="sa">f</span><span class="s2">&quot;&quot;&quot;Could not correctly adjust working distance,</span>
</span><span id="beam_working_distance-780"><a href="#beam_working_distance-780"><span class="linenos">780</span></a><span class="s2">            requested </span><span class="si">{</span><span class="n">wd_m</span><span class="si">}</span><span class="s2"> meters, current working distance is</span>
</span><span id="beam_working_distance-781"><a href="#beam_working_distance-781"><span class="linenos">781</span></a><span class="s2">            </span><span class="si">{</span><span class="n">selected_beam</span><span class="o">.</span><span class="n">working_distance</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2"> meters&quot;&quot;&quot;</span>
</span><span id="beam_working_distance-782"><a href="#beam_working_distance-782"><span class="linenos">782</span></a>        <span class="p">)</span>
</span><span id="beam_working_distance-783"><a href="#beam_working_distance-783"><span class="linenos">783</span></a>
</span><span id="beam_working_distance-784"><a href="#beam_working_distance-784"><span class="linenos">784</span></a>    <span class="k">return</span> <span class="kc">True</span>
</span></pre></div>


            <div class="docstring"><p>Sets the working distance for the selected beam, with inputs in units of millimeters.</p>

<p>This function sets the working distance (WD) for the specified beam type on the microscope.
It converts the WD from millimeters to meters, sets the WD, and waits for the specified delay.
This should be done before adjusting the horizontal field width.</p>

<h2 id="parameters">Parameters</h2>

<p>beam : tbt.Beam
    The beam type to configure.
microscope : tbt.Microscope
    The microscope object to configure.
wd_mm : float
    The desired working distance in millimeters.
delay_s : float, optional
    The delay in seconds to wait after adjusting the working distance (default is 0.1).</p>

<h2 id="returns">Returns</h2>

<p>bool
    True if the working distance is set successfully, False otherwise.</p>

<h2 id="raises">Raises</h2>

<p>ValueError
    If the working distance cannot be adjusted correctly.</p>

<h2 id="examples">Examples</h2>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn"><a href="types.html">pytribeam.types</a></span> <span class="k">as</span> <span class="nn">tbt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">microscope</span> <span class="o">=</span> <span class="n">tbt</span><span class="o">.</span><span class="n">Microscope</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">microscope</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;localhost&quot;</span><span class="p">)</span>
<span class="go">Client connecting to [localhost:7520]...</span>
<span class="go">Client connected to [localhost:7520]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">beam</span> <span class="o">=</span> <span class="n">tbt</span><span class="o">.</span><span class="n">ElectronBeam</span><span class="p">(</span><span class="n">settings</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">success</span> <span class="o">=</span> <span class="n">beam_working_dist</span><span class="p">(</span><span class="n">beam</span><span class="p">,</span> <span class="n">microscope</span><span class="p">,</span> <span class="n">wd_mm</span><span class="o">=</span><span class="mf">5.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">success</span><span class="p">)</span>
<span class="go">True</span>
</code></pre>
</div>
</div>


                </section>
                <section id="detector_auto_cb">
                            <input id="detector_auto_cb-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">detector_auto_cb</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">microscope</span><span class="p">:</span> <span class="n"><a href="types.html#Microscope">pytribeam.types.Microscope</a></span>,</span><span class="param">	<span class="n">beam</span><span class="p">:</span> <span class="n"><a href="types.html#Beam">pytribeam.types.Beam</a></span>,</span><span class="param">	<span class="n">settings</span><span class="p">:</span> <span class="n"><a href="types.html#ScanArea">pytribeam.types.ScanArea</a></span>,</span><span class="param">	<span class="n">delay_s</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.1</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <label class="view-source-button" for="detector_auto_cb-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#detector_auto_cb"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="detector_auto_cb-787"><a href="#detector_auto_cb-787"><span class="linenos">787</span></a><span class="k">def</span> <span class="nf">detector_auto_cb</span><span class="p">(</span>
</span><span id="detector_auto_cb-788"><a href="#detector_auto_cb-788"><span class="linenos">788</span></a>    <span class="n">microscope</span><span class="p">:</span> <span class="n">tbt</span><span class="o">.</span><span class="n">Microscope</span><span class="p">,</span>
</span><span id="detector_auto_cb-789"><a href="#detector_auto_cb-789"><span class="linenos">789</span></a>    <span class="n">beam</span><span class="p">:</span> <span class="n">tbt</span><span class="o">.</span><span class="n">Beam</span><span class="p">,</span>
</span><span id="detector_auto_cb-790"><a href="#detector_auto_cb-790"><span class="linenos">790</span></a>    <span class="n">settings</span><span class="p">:</span> <span class="n">tbt</span><span class="o">.</span><span class="n">ScanArea</span><span class="p">,</span>
</span><span id="detector_auto_cb-791"><a href="#detector_auto_cb-791"><span class="linenos">791</span></a>    <span class="n">delay_s</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span>
</span><span id="detector_auto_cb-792"><a href="#detector_auto_cb-792"><span class="linenos">792</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="detector_auto_cb-793"><a href="#detector_auto_cb-793"><span class="linenos">793</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="detector_auto_cb-794"><a href="#detector_auto_cb-794"><span class="linenos">794</span></a><span class="sd">    Detector auto contrast brightness. Currently only reduced scan area option is supported.</span>
</span><span id="detector_auto_cb-795"><a href="#detector_auto_cb-795"><span class="linenos">795</span></a>
</span><span id="detector_auto_cb-796"><a href="#detector_auto_cb-796"><span class="linenos">796</span></a><span class="sd">    This function sets the scanning mode to reduced area, runs the auto contrast-brightness function,</span>
</span><span id="detector_auto_cb-797"><a href="#detector_auto_cb-797"><span class="linenos">797</span></a><span class="sd">    and then sets the scanning mode back to full frame.</span>
</span><span id="detector_auto_cb-798"><a href="#detector_auto_cb-798"><span class="linenos">798</span></a>
</span><span id="detector_auto_cb-799"><a href="#detector_auto_cb-799"><span class="linenos">799</span></a><span class="sd">    Parameters</span>
</span><span id="detector_auto_cb-800"><a href="#detector_auto_cb-800"><span class="linenos">800</span></a><span class="sd">    ----------</span>
</span><span id="detector_auto_cb-801"><a href="#detector_auto_cb-801"><span class="linenos">801</span></a><span class="sd">    microscope : tbt.Microscope</span>
</span><span id="detector_auto_cb-802"><a href="#detector_auto_cb-802"><span class="linenos">802</span></a><span class="sd">        The microscope object to configure.</span>
</span><span id="detector_auto_cb-803"><a href="#detector_auto_cb-803"><span class="linenos">803</span></a><span class="sd">    beam : tbt.Beam</span>
</span><span id="detector_auto_cb-804"><a href="#detector_auto_cb-804"><span class="linenos">804</span></a><span class="sd">        The beam type to configure.</span>
</span><span id="detector_auto_cb-805"><a href="#detector_auto_cb-805"><span class="linenos">805</span></a><span class="sd">    settings : tbt.ScanArea</span>
</span><span id="detector_auto_cb-806"><a href="#detector_auto_cb-806"><span class="linenos">806</span></a><span class="sd">        The scan area settings for the reduced area.</span>
</span><span id="detector_auto_cb-807"><a href="#detector_auto_cb-807"><span class="linenos">807</span></a><span class="sd">    delay_s : float, optional</span>
</span><span id="detector_auto_cb-808"><a href="#detector_auto_cb-808"><span class="linenos">808</span></a><span class="sd">        The delay in seconds to wait after each operation (default is 0.1).</span>
</span><span id="detector_auto_cb-809"><a href="#detector_auto_cb-809"><span class="linenos">809</span></a>
</span><span id="detector_auto_cb-810"><a href="#detector_auto_cb-810"><span class="linenos">810</span></a><span class="sd">    Returns</span>
</span><span id="detector_auto_cb-811"><a href="#detector_auto_cb-811"><span class="linenos">811</span></a><span class="sd">    -------</span>
</span><span id="detector_auto_cb-812"><a href="#detector_auto_cb-812"><span class="linenos">812</span></a><span class="sd">    bool</span>
</span><span id="detector_auto_cb-813"><a href="#detector_auto_cb-813"><span class="linenos">813</span></a><span class="sd">        True if the auto contrast-brightness is completed successfully, False otherwise.</span>
</span><span id="detector_auto_cb-814"><a href="#detector_auto_cb-814"><span class="linenos">814</span></a>
</span><span id="detector_auto_cb-815"><a href="#detector_auto_cb-815"><span class="linenos">815</span></a><span class="sd">    Raises</span>
</span><span id="detector_auto_cb-816"><a href="#detector_auto_cb-816"><span class="linenos">816</span></a><span class="sd">    ------</span>
</span><span id="detector_auto_cb-817"><a href="#detector_auto_cb-817"><span class="linenos">817</span></a><span class="sd">    SystemError</span>
</span><span id="detector_auto_cb-818"><a href="#detector_auto_cb-818"><span class="linenos">818</span></a><span class="sd">        If unable to set the scan mode to reduced area or full frame.</span>
</span><span id="detector_auto_cb-819"><a href="#detector_auto_cb-819"><span class="linenos">819</span></a>
</span><span id="detector_auto_cb-820"><a href="#detector_auto_cb-820"><span class="linenos">820</span></a><span class="sd">    Examples</span>
</span><span id="detector_auto_cb-821"><a href="#detector_auto_cb-821"><span class="linenos">821</span></a><span class="sd">    --------</span>
</span><span id="detector_auto_cb-822"><a href="#detector_auto_cb-822"><span class="linenos">822</span></a><span class="sd">    &gt;&gt;&gt; import pytribeam.types as tbt</span>
</span><span id="detector_auto_cb-823"><a href="#detector_auto_cb-823"><span class="linenos">823</span></a><span class="sd">    &gt;&gt;&gt; microscope = tbt.Microscope()</span>
</span><span id="detector_auto_cb-824"><a href="#detector_auto_cb-824"><span class="linenos">824</span></a><span class="sd">    &gt;&gt;&gt; microscope.connect(&quot;localhost&quot;)</span>
</span><span id="detector_auto_cb-825"><a href="#detector_auto_cb-825"><span class="linenos">825</span></a><span class="sd">    Client connecting to [localhost:7520]...</span>
</span><span id="detector_auto_cb-826"><a href="#detector_auto_cb-826"><span class="linenos">826</span></a><span class="sd">    Client connected to [localhost:7520]</span>
</span><span id="detector_auto_cb-827"><a href="#detector_auto_cb-827"><span class="linenos">827</span></a><span class="sd">    &gt;&gt;&gt; beam = tbt.ElectronBeam(settings=None)</span>
</span><span id="detector_auto_cb-828"><a href="#detector_auto_cb-828"><span class="linenos">828</span></a><span class="sd">    &gt;&gt;&gt; auto_cb_settings = tbt.ScanArea(left=0.1, top=0.1, width=0.8, height=0.8)</span>
</span><span id="detector_auto_cb-829"><a href="#detector_auto_cb-829"><span class="linenos">829</span></a><span class="sd">    &gt;&gt;&gt; success = detector_auto_cb(microscope, beam, auto_cb_settings)</span>
</span><span id="detector_auto_cb-830"><a href="#detector_auto_cb-830"><span class="linenos">830</span></a><span class="sd">    &gt;&gt;&gt; print(success)</span>
</span><span id="detector_auto_cb-831"><a href="#detector_auto_cb-831"><span class="linenos">831</span></a><span class="sd">    True</span>
</span><span id="detector_auto_cb-832"><a href="#detector_auto_cb-832"><span class="linenos">832</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="detector_auto_cb-833"><a href="#detector_auto_cb-833"><span class="linenos">833</span></a>    <span class="n">selected_beam</span> <span class="o">=</span> <span class="n">ut</span><span class="o">.</span><span class="n">beam_type</span><span class="p">(</span><span class="n">beam</span><span class="p">,</span> <span class="n">microscope</span><span class="p">)</span>
</span><span id="detector_auto_cb-834"><a href="#detector_auto_cb-834"><span class="linenos">834</span></a>    <span class="n">selected_beam</span><span class="o">.</span><span class="n">scanning</span><span class="o">.</span><span class="n">mode</span><span class="o">.</span><span class="n">set_reduced_area</span><span class="p">(</span>
</span><span id="detector_auto_cb-835"><a href="#detector_auto_cb-835"><span class="linenos">835</span></a>        <span class="n">left</span><span class="o">=</span><span class="n">settings</span><span class="o">.</span><span class="n">left</span><span class="p">,</span>
</span><span id="detector_auto_cb-836"><a href="#detector_auto_cb-836"><span class="linenos">836</span></a>        <span class="n">top</span><span class="o">=</span><span class="n">settings</span><span class="o">.</span><span class="n">top</span><span class="p">,</span>
</span><span id="detector_auto_cb-837"><a href="#detector_auto_cb-837"><span class="linenos">837</span></a>        <span class="n">width</span><span class="o">=</span><span class="n">settings</span><span class="o">.</span><span class="n">width</span><span class="p">,</span>
</span><span id="detector_auto_cb-838"><a href="#detector_auto_cb-838"><span class="linenos">838</span></a>        <span class="n">height</span><span class="o">=</span><span class="n">settings</span><span class="o">.</span><span class="n">height</span><span class="p">,</span>
</span><span id="detector_auto_cb-839"><a href="#detector_auto_cb-839"><span class="linenos">839</span></a>    <span class="p">)</span>
</span><span id="detector_auto_cb-840"><a href="#detector_auto_cb-840"><span class="linenos">840</span></a>    <span class="n">scan_mode</span> <span class="o">=</span> <span class="n">selected_beam</span><span class="o">.</span><span class="n">scanning</span><span class="o">.</span><span class="n">mode</span><span class="o">.</span><span class="n">value</span>
</span><span id="detector_auto_cb-841"><a href="#detector_auto_cb-841"><span class="linenos">841</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">scan_mode</span> <span class="o">==</span> <span class="n">tbt</span><span class="o">.</span><span class="n">ScanMode</span><span class="o">.</span><span class="n">REDUCED_AREA</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>
</span><span id="detector_auto_cb-842"><a href="#detector_auto_cb-842"><span class="linenos">842</span></a>        <span class="k">raise</span> <span class="ne">SystemError</span><span class="p">(</span>
</span><span id="detector_auto_cb-843"><a href="#detector_auto_cb-843"><span class="linenos">843</span></a>            <span class="sa">f</span><span class="s2">&quot;Unable to set imaging to reduced area before auto contrast-brightness. Current scan mode is </span><span class="si">{</span><span class="n">scan_mode</span><span class="si">}</span><span class="s2">.&quot;</span>
</span><span id="detector_auto_cb-844"><a href="#detector_auto_cb-844"><span class="linenos">844</span></a>        <span class="p">)</span>
</span><span id="detector_auto_cb-845"><a href="#detector_auto_cb-845"><span class="linenos">845</span></a>    <span class="n">microscope</span><span class="o">.</span><span class="n">auto_functions</span><span class="o">.</span><span class="n">run_auto_cb</span><span class="p">()</span>
</span><span id="detector_auto_cb-846"><a href="#detector_auto_cb-846"><span class="linenos">846</span></a>    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">delay_s</span><span class="p">)</span>
</span><span id="detector_auto_cb-847"><a href="#detector_auto_cb-847"><span class="linenos">847</span></a>    <span class="n">selected_beam</span><span class="o">.</span><span class="n">scanning</span><span class="o">.</span><span class="n">mode</span><span class="o">.</span><span class="n">set_full_frame</span><span class="p">()</span>
</span><span id="detector_auto_cb-848"><a href="#detector_auto_cb-848"><span class="linenos">848</span></a>    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">delay_s</span><span class="p">)</span>
</span><span id="detector_auto_cb-849"><a href="#detector_auto_cb-849"><span class="linenos">849</span></a>
</span><span id="detector_auto_cb-850"><a href="#detector_auto_cb-850"><span class="linenos">850</span></a>    <span class="n">new_scan_mode</span> <span class="o">=</span> <span class="n">selected_beam</span><span class="o">.</span><span class="n">scanning</span><span class="o">.</span><span class="n">mode</span><span class="o">.</span><span class="n">value</span>
</span><span id="detector_auto_cb-851"><a href="#detector_auto_cb-851"><span class="linenos">851</span></a>    <span class="k">if</span> <span class="n">new_scan_mode</span> <span class="o">!=</span> <span class="n">tbt</span><span class="o">.</span><span class="n">ScanMode</span><span class="o">.</span><span class="n">FULL_FRAME</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>
</span><span id="detector_auto_cb-852"><a href="#detector_auto_cb-852"><span class="linenos">852</span></a>        <span class="k">raise</span> <span class="ne">SystemError</span><span class="p">(</span>
</span><span id="detector_auto_cb-853"><a href="#detector_auto_cb-853"><span class="linenos">853</span></a>            <span class="sa">f</span><span class="s2">&quot;Unable to set imaging back to full frame after auto contrast-brightness. Current scan mode is </span><span class="si">{</span><span class="n">new_scan_mode</span><span class="si">}</span><span class="s2">.&quot;</span>
</span><span id="detector_auto_cb-854"><a href="#detector_auto_cb-854"><span class="linenos">854</span></a>        <span class="p">)</span>
</span><span id="detector_auto_cb-855"><a href="#detector_auto_cb-855"><span class="linenos">855</span></a>    <span class="k">return</span> <span class="kc">True</span>
</span></pre></div>


            <div class="docstring"><p>Detector auto contrast brightness. Currently only reduced scan area option is supported.</p>

<p>This function sets the scanning mode to reduced area, runs the auto contrast-brightness function,
and then sets the scanning mode back to full frame.</p>

<h2 id="parameters">Parameters</h2>

<p>microscope : tbt.Microscope
    The microscope object to configure.
beam : tbt.Beam
    The beam type to configure.
settings : tbt.ScanArea
    The scan area settings for the reduced area.
delay_s : float, optional
    The delay in seconds to wait after each operation (default is 0.1).</p>

<h2 id="returns">Returns</h2>

<p>bool
    True if the auto contrast-brightness is completed successfully, False otherwise.</p>

<h2 id="raises">Raises</h2>

<p>SystemError
    If unable to set the scan mode to reduced area or full frame.</p>

<h2 id="examples">Examples</h2>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn"><a href="types.html">pytribeam.types</a></span> <span class="k">as</span> <span class="nn">tbt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">microscope</span> <span class="o">=</span> <span class="n">tbt</span><span class="o">.</span><span class="n">Microscope</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">microscope</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;localhost&quot;</span><span class="p">)</span>
<span class="go">Client connecting to [localhost:7520]...</span>
<span class="go">Client connected to [localhost:7520]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">beam</span> <span class="o">=</span> <span class="n">tbt</span><span class="o">.</span><span class="n">ElectronBeam</span><span class="p">(</span><span class="n">settings</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">auto_cb_settings</span> <span class="o">=</span> <span class="n">tbt</span><span class="o">.</span><span class="n">ScanArea</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mf">0.8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">success</span> <span class="o">=</span> <span class="n">detector_auto_cb</span><span class="p">(</span><span class="n">microscope</span><span class="p">,</span> <span class="n">beam</span><span class="p">,</span> <span class="n">auto_cb_settings</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">success</span><span class="p">)</span>
<span class="go">True</span>
</code></pre>
</div>
</div>


                </section>
                <section id="detector_brightness">
                            <input id="detector_brightness-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">detector_brightness</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">microscope</span><span class="p">:</span> <span class="n"><a href="types.html#Microscope">pytribeam.types.Microscope</a></span>,</span><span class="param">	<span class="n">brightness</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">delay_s</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.1</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <label class="view-source-button" for="detector_brightness-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#detector_brightness"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="detector_brightness-858"><a href="#detector_brightness-858"><span class="linenos">858</span></a><span class="k">def</span> <span class="nf">detector_brightness</span><span class="p">(</span>
</span><span id="detector_brightness-859"><a href="#detector_brightness-859"><span class="linenos">859</span></a>    <span class="n">microscope</span><span class="p">:</span> <span class="n">tbt</span><span class="o">.</span><span class="n">Microscope</span><span class="p">,</span>
</span><span id="detector_brightness-860"><a href="#detector_brightness-860"><span class="linenos">860</span></a>    <span class="n">brightness</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="detector_brightness-861"><a href="#detector_brightness-861"><span class="linenos">861</span></a>    <span class="n">delay_s</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span>
</span><span id="detector_brightness-862"><a href="#detector_brightness-862"><span class="linenos">862</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="detector_brightness-863"><a href="#detector_brightness-863"><span class="linenos">863</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="detector_brightness-864"><a href="#detector_brightness-864"><span class="linenos">864</span></a><span class="sd">    Sets the detector brightness with input from 0 to 1.</span>
</span><span id="detector_brightness-865"><a href="#detector_brightness-865"><span class="linenos">865</span></a>
</span><span id="detector_brightness-866"><a href="#detector_brightness-866"><span class="linenos">866</span></a><span class="sd">    This function sets the brightness for the detector on the microscope and waits for the specified delay.</span>
</span><span id="detector_brightness-867"><a href="#detector_brightness-867"><span class="linenos">867</span></a>
</span><span id="detector_brightness-868"><a href="#detector_brightness-868"><span class="linenos">868</span></a><span class="sd">    Parameters</span>
</span><span id="detector_brightness-869"><a href="#detector_brightness-869"><span class="linenos">869</span></a><span class="sd">    ----------</span>
</span><span id="detector_brightness-870"><a href="#detector_brightness-870"><span class="linenos">870</span></a><span class="sd">    microscope : tbt.Microscope</span>
</span><span id="detector_brightness-871"><a href="#detector_brightness-871"><span class="linenos">871</span></a><span class="sd">        The microscope object to configure.</span>
</span><span id="detector_brightness-872"><a href="#detector_brightness-872"><span class="linenos">872</span></a><span class="sd">    brightness : float</span>
</span><span id="detector_brightness-873"><a href="#detector_brightness-873"><span class="linenos">873</span></a><span class="sd">        The desired brightness value (from 0 to 1).</span>
</span><span id="detector_brightness-874"><a href="#detector_brightness-874"><span class="linenos">874</span></a><span class="sd">    delay_s : float, optional</span>
</span><span id="detector_brightness-875"><a href="#detector_brightness-875"><span class="linenos">875</span></a><span class="sd">        The delay in seconds to wait after adjusting the brightness (default is 0.1).</span>
</span><span id="detector_brightness-876"><a href="#detector_brightness-876"><span class="linenos">876</span></a>
</span><span id="detector_brightness-877"><a href="#detector_brightness-877"><span class="linenos">877</span></a><span class="sd">    Returns</span>
</span><span id="detector_brightness-878"><a href="#detector_brightness-878"><span class="linenos">878</span></a><span class="sd">    -------</span>
</span><span id="detector_brightness-879"><a href="#detector_brightness-879"><span class="linenos">879</span></a><span class="sd">    bool</span>
</span><span id="detector_brightness-880"><a href="#detector_brightness-880"><span class="linenos">880</span></a><span class="sd">        True if the brightness is set successfully, False otherwise.</span>
</span><span id="detector_brightness-881"><a href="#detector_brightness-881"><span class="linenos">881</span></a>
</span><span id="detector_brightness-882"><a href="#detector_brightness-882"><span class="linenos">882</span></a><span class="sd">    Raises</span>
</span><span id="detector_brightness-883"><a href="#detector_brightness-883"><span class="linenos">883</span></a><span class="sd">    ------</span>
</span><span id="detector_brightness-884"><a href="#detector_brightness-884"><span class="linenos">884</span></a><span class="sd">    ValueError</span>
</span><span id="detector_brightness-885"><a href="#detector_brightness-885"><span class="linenos">885</span></a><span class="sd">        If the brightness cannot be adjusted correctly.</span>
</span><span id="detector_brightness-886"><a href="#detector_brightness-886"><span class="linenos">886</span></a>
</span><span id="detector_brightness-887"><a href="#detector_brightness-887"><span class="linenos">887</span></a><span class="sd">    Examples</span>
</span><span id="detector_brightness-888"><a href="#detector_brightness-888"><span class="linenos">888</span></a><span class="sd">    --------</span>
</span><span id="detector_brightness-889"><a href="#detector_brightness-889"><span class="linenos">889</span></a><span class="sd">    &gt;&gt;&gt; import pytribeam.types as tbt</span>
</span><span id="detector_brightness-890"><a href="#detector_brightness-890"><span class="linenos">890</span></a><span class="sd">    &gt;&gt;&gt; microscope = tbt.Microscope()</span>
</span><span id="detector_brightness-891"><a href="#detector_brightness-891"><span class="linenos">891</span></a><span class="sd">    &gt;&gt;&gt; microscope.connect(&quot;localhost&quot;)</span>
</span><span id="detector_brightness-892"><a href="#detector_brightness-892"><span class="linenos">892</span></a><span class="sd">    Client connecting to [localhost:7520]...</span>
</span><span id="detector_brightness-893"><a href="#detector_brightness-893"><span class="linenos">893</span></a><span class="sd">    Client connected to [localhost:7520]</span>
</span><span id="detector_brightness-894"><a href="#detector_brightness-894"><span class="linenos">894</span></a><span class="sd">    &gt;&gt;&gt; success = detector_brightness(microscope, brightness=0.5)</span>
</span><span id="detector_brightness-895"><a href="#detector_brightness-895"><span class="linenos">895</span></a><span class="sd">    &gt;&gt;&gt; print(success)</span>
</span><span id="detector_brightness-896"><a href="#detector_brightness-896"><span class="linenos">896</span></a><span class="sd">    True</span>
</span><span id="detector_brightness-897"><a href="#detector_brightness-897"><span class="linenos">897</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="detector_brightness-898"><a href="#detector_brightness-898"><span class="linenos">898</span></a>    <span class="n">microscope</span><span class="o">.</span><span class="n">detector</span><span class="o">.</span><span class="n">brightness</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">brightness</span>
</span><span id="detector_brightness-899"><a href="#detector_brightness-899"><span class="linenos">899</span></a>    <span class="n">current_detector</span> <span class="o">=</span> <span class="n">microscope</span><span class="o">.</span><span class="n">detector</span><span class="o">.</span><span class="n">type</span><span class="o">.</span><span class="n">value</span>
</span><span id="detector_brightness-900"><a href="#detector_brightness-900"><span class="linenos">900</span></a>    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">delay_s</span><span class="p">)</span>
</span><span id="detector_brightness-901"><a href="#detector_brightness-901"><span class="linenos">901</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">math</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span>
</span><span id="detector_brightness-902"><a href="#detector_brightness-902"><span class="linenos">902</span></a>        <span class="n">microscope</span><span class="o">.</span><span class="n">detector</span><span class="o">.</span><span class="n">brightness</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
</span><span id="detector_brightness-903"><a href="#detector_brightness-903"><span class="linenos">903</span></a>        <span class="n">brightness</span><span class="p">,</span>
</span><span id="detector_brightness-904"><a href="#detector_brightness-904"><span class="linenos">904</span></a>        <span class="n">abs_tol</span><span class="o">=</span><span class="n">cs</span><span class="o">.</span><span class="n">Constants</span><span class="o">.</span><span class="n">contrast_brightness_tolerance</span><span class="p">,</span>
</span><span id="detector_brightness-905"><a href="#detector_brightness-905"><span class="linenos">905</span></a>    <span class="p">):</span>
</span><span id="detector_brightness-906"><a href="#detector_brightness-906"><span class="linenos">906</span></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="detector_brightness-907"><a href="#detector_brightness-907"><span class="linenos">907</span></a>            <span class="sa">f</span><span class="s2">&quot;&quot;&quot;Could not correctly adjust detector brightness,</span>
</span><span id="detector_brightness-908"><a href="#detector_brightness-908"><span class="linenos">908</span></a><span class="s2">            requested </span><span class="si">{</span><span class="n">brightness</span><span class="si">}</span><span class="s2"> on </span><span class="si">{</span><span class="n">current_detector</span><span class="si">}</span><span class="s2"> detector, </span>
</span><span id="detector_brightness-909"><a href="#detector_brightness-909"><span class="linenos">909</span></a><span class="s2">            current brightness is </span><span class="si">{</span><span class="n">microscope</span><span class="o">.</span><span class="n">detector</span><span class="o">.</span><span class="n">brightness</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;&quot;&quot;</span>
</span><span id="detector_brightness-910"><a href="#detector_brightness-910"><span class="linenos">910</span></a>        <span class="p">)</span>
</span><span id="detector_brightness-911"><a href="#detector_brightness-911"><span class="linenos">911</span></a>    <span class="k">return</span> <span class="kc">True</span>
</span></pre></div>


            <div class="docstring"><p>Sets the detector brightness with input from 0 to 1.</p>

<p>This function sets the brightness for the detector on the microscope and waits for the specified delay.</p>

<h2 id="parameters">Parameters</h2>

<p>microscope : tbt.Microscope
    The microscope object to configure.
brightness : float
    The desired brightness value (from 0 to 1).
delay_s : float, optional
    The delay in seconds to wait after adjusting the brightness (default is 0.1).</p>

<h2 id="returns">Returns</h2>

<p>bool
    True if the brightness is set successfully, False otherwise.</p>

<h2 id="raises">Raises</h2>

<p>ValueError
    If the brightness cannot be adjusted correctly.</p>

<h2 id="examples">Examples</h2>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn"><a href="types.html">pytribeam.types</a></span> <span class="k">as</span> <span class="nn">tbt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">microscope</span> <span class="o">=</span> <span class="n">tbt</span><span class="o">.</span><span class="n">Microscope</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">microscope</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;localhost&quot;</span><span class="p">)</span>
<span class="go">Client connecting to [localhost:7520]...</span>
<span class="go">Client connected to [localhost:7520]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">success</span> <span class="o">=</span> <span class="n">detector_brightness</span><span class="p">(</span><span class="n">microscope</span><span class="p">,</span> <span class="n">brightness</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">success</span><span class="p">)</span>
<span class="go">True</span>
</code></pre>
</div>
</div>


                </section>
                <section id="detector_contrast">
                            <input id="detector_contrast-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">detector_contrast</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">microscope</span><span class="p">:</span> <span class="n"><a href="types.html#Microscope">pytribeam.types.Microscope</a></span>,</span><span class="param">	<span class="n">contrast</span><span class="p">:</span> <span class="nb">float</span>,</span><span class="param">	<span class="n">delay_s</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.1</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <label class="view-source-button" for="detector_contrast-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#detector_contrast"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="detector_contrast-914"><a href="#detector_contrast-914"><span class="linenos">914</span></a><span class="k">def</span> <span class="nf">detector_contrast</span><span class="p">(</span>
</span><span id="detector_contrast-915"><a href="#detector_contrast-915"><span class="linenos">915</span></a>    <span class="n">microscope</span><span class="p">:</span> <span class="n">tbt</span><span class="o">.</span><span class="n">Microscope</span><span class="p">,</span>
</span><span id="detector_contrast-916"><a href="#detector_contrast-916"><span class="linenos">916</span></a>    <span class="n">contrast</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
</span><span id="detector_contrast-917"><a href="#detector_contrast-917"><span class="linenos">917</span></a>    <span class="n">delay_s</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span>
</span><span id="detector_contrast-918"><a href="#detector_contrast-918"><span class="linenos">918</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="detector_contrast-919"><a href="#detector_contrast-919"><span class="linenos">919</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="detector_contrast-920"><a href="#detector_contrast-920"><span class="linenos">920</span></a><span class="sd">    Sets the detector contrast with input from 0 to 1.</span>
</span><span id="detector_contrast-921"><a href="#detector_contrast-921"><span class="linenos">921</span></a>
</span><span id="detector_contrast-922"><a href="#detector_contrast-922"><span class="linenos">922</span></a><span class="sd">    This function sets the contrast for the detector on the microscope and waits for the specified delay.</span>
</span><span id="detector_contrast-923"><a href="#detector_contrast-923"><span class="linenos">923</span></a>
</span><span id="detector_contrast-924"><a href="#detector_contrast-924"><span class="linenos">924</span></a><span class="sd">    Parameters</span>
</span><span id="detector_contrast-925"><a href="#detector_contrast-925"><span class="linenos">925</span></a><span class="sd">    ----------</span>
</span><span id="detector_contrast-926"><a href="#detector_contrast-926"><span class="linenos">926</span></a><span class="sd">    microscope : tbt.Microscope</span>
</span><span id="detector_contrast-927"><a href="#detector_contrast-927"><span class="linenos">927</span></a><span class="sd">        The microscope object to configure.</span>
</span><span id="detector_contrast-928"><a href="#detector_contrast-928"><span class="linenos">928</span></a><span class="sd">    contrast : float</span>
</span><span id="detector_contrast-929"><a href="#detector_contrast-929"><span class="linenos">929</span></a><span class="sd">        The desired contrast value (from 0 to 1).</span>
</span><span id="detector_contrast-930"><a href="#detector_contrast-930"><span class="linenos">930</span></a><span class="sd">    delay_s : float, optional</span>
</span><span id="detector_contrast-931"><a href="#detector_contrast-931"><span class="linenos">931</span></a><span class="sd">        The delay in seconds to wait after adjusting the contrast (default is 0.1).</span>
</span><span id="detector_contrast-932"><a href="#detector_contrast-932"><span class="linenos">932</span></a>
</span><span id="detector_contrast-933"><a href="#detector_contrast-933"><span class="linenos">933</span></a><span class="sd">    Returns</span>
</span><span id="detector_contrast-934"><a href="#detector_contrast-934"><span class="linenos">934</span></a><span class="sd">    -------</span>
</span><span id="detector_contrast-935"><a href="#detector_contrast-935"><span class="linenos">935</span></a><span class="sd">    bool</span>
</span><span id="detector_contrast-936"><a href="#detector_contrast-936"><span class="linenos">936</span></a><span class="sd">        True if the contrast is set successfully, False otherwise.</span>
</span><span id="detector_contrast-937"><a href="#detector_contrast-937"><span class="linenos">937</span></a>
</span><span id="detector_contrast-938"><a href="#detector_contrast-938"><span class="linenos">938</span></a><span class="sd">    Raises</span>
</span><span id="detector_contrast-939"><a href="#detector_contrast-939"><span class="linenos">939</span></a><span class="sd">    ------</span>
</span><span id="detector_contrast-940"><a href="#detector_contrast-940"><span class="linenos">940</span></a><span class="sd">    ValueError</span>
</span><span id="detector_contrast-941"><a href="#detector_contrast-941"><span class="linenos">941</span></a><span class="sd">        If the contrast cannot be adjusted correctly.</span>
</span><span id="detector_contrast-942"><a href="#detector_contrast-942"><span class="linenos">942</span></a>
</span><span id="detector_contrast-943"><a href="#detector_contrast-943"><span class="linenos">943</span></a><span class="sd">    Examples</span>
</span><span id="detector_contrast-944"><a href="#detector_contrast-944"><span class="linenos">944</span></a><span class="sd">    --------</span>
</span><span id="detector_contrast-945"><a href="#detector_contrast-945"><span class="linenos">945</span></a><span class="sd">    &gt;&gt;&gt; import pytribeam.types as tbt</span>
</span><span id="detector_contrast-946"><a href="#detector_contrast-946"><span class="linenos">946</span></a><span class="sd">    &gt;&gt;&gt; microscope = tbt.Microscope()</span>
</span><span id="detector_contrast-947"><a href="#detector_contrast-947"><span class="linenos">947</span></a><span class="sd">    &gt;&gt;&gt; microscope.connect(&quot;localhost&quot;)</span>
</span><span id="detector_contrast-948"><a href="#detector_contrast-948"><span class="linenos">948</span></a><span class="sd">    Client connecting to [localhost:7520]...</span>
</span><span id="detector_contrast-949"><a href="#detector_contrast-949"><span class="linenos">949</span></a><span class="sd">    Client connected to [localhost:7520]</span>
</span><span id="detector_contrast-950"><a href="#detector_contrast-950"><span class="linenos">950</span></a><span class="sd">    &gt;&gt;&gt; success = detector_contrast(microscope, contrast=0.5)</span>
</span><span id="detector_contrast-951"><a href="#detector_contrast-951"><span class="linenos">951</span></a><span class="sd">    &gt;&gt;&gt; print(success)</span>
</span><span id="detector_contrast-952"><a href="#detector_contrast-952"><span class="linenos">952</span></a><span class="sd">    True</span>
</span><span id="detector_contrast-953"><a href="#detector_contrast-953"><span class="linenos">953</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="detector_contrast-954"><a href="#detector_contrast-954"><span class="linenos">954</span></a>    <span class="n">microscope</span><span class="o">.</span><span class="n">detector</span><span class="o">.</span><span class="n">contrast</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">contrast</span>
</span><span id="detector_contrast-955"><a href="#detector_contrast-955"><span class="linenos">955</span></a>    <span class="n">current_detector</span> <span class="o">=</span> <span class="n">microscope</span><span class="o">.</span><span class="n">detector</span><span class="o">.</span><span class="n">type</span><span class="o">.</span><span class="n">value</span>
</span><span id="detector_contrast-956"><a href="#detector_contrast-956"><span class="linenos">956</span></a>    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">delay_s</span><span class="p">)</span>
</span><span id="detector_contrast-957"><a href="#detector_contrast-957"><span class="linenos">957</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">math</span><span class="o">.</span><span class="n">isclose</span><span class="p">(</span>
</span><span id="detector_contrast-958"><a href="#detector_contrast-958"><span class="linenos">958</span></a>        <span class="n">microscope</span><span class="o">.</span><span class="n">detector</span><span class="o">.</span><span class="n">contrast</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
</span><span id="detector_contrast-959"><a href="#detector_contrast-959"><span class="linenos">959</span></a>        <span class="n">contrast</span><span class="p">,</span>
</span><span id="detector_contrast-960"><a href="#detector_contrast-960"><span class="linenos">960</span></a>        <span class="n">abs_tol</span><span class="o">=</span><span class="n">cs</span><span class="o">.</span><span class="n">Constants</span><span class="o">.</span><span class="n">contrast_brightness_tolerance</span><span class="p">,</span>
</span><span id="detector_contrast-961"><a href="#detector_contrast-961"><span class="linenos">961</span></a>    <span class="p">):</span>
</span><span id="detector_contrast-962"><a href="#detector_contrast-962"><span class="linenos">962</span></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="detector_contrast-963"><a href="#detector_contrast-963"><span class="linenos">963</span></a>            <span class="sa">f</span><span class="s2">&quot;&quot;&quot;Could not correctly adjust detector contrast,</span>
</span><span id="detector_contrast-964"><a href="#detector_contrast-964"><span class="linenos">964</span></a><span class="s2">            requested </span><span class="si">{</span><span class="n">contrast</span><span class="si">}</span><span class="s2"> on </span><span class="si">{</span><span class="n">current_detector</span><span class="si">}</span><span class="s2"> detector, </span>
</span><span id="detector_contrast-965"><a href="#detector_contrast-965"><span class="linenos">965</span></a><span class="s2">            current contrast is </span><span class="si">{</span><span class="n">microscope</span><span class="o">.</span><span class="n">detector</span><span class="o">.</span><span class="n">contrast</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;&quot;&quot;</span>
</span><span id="detector_contrast-966"><a href="#detector_contrast-966"><span class="linenos">966</span></a>        <span class="p">)</span>
</span><span id="detector_contrast-967"><a href="#detector_contrast-967"><span class="linenos">967</span></a>    <span class="k">return</span> <span class="kc">True</span>
</span></pre></div>


            <div class="docstring"><p>Sets the detector contrast with input from 0 to 1.</p>

<p>This function sets the contrast for the detector on the microscope and waits for the specified delay.</p>

<h2 id="parameters">Parameters</h2>

<p>microscope : tbt.Microscope
    The microscope object to configure.
contrast : float
    The desired contrast value (from 0 to 1).
delay_s : float, optional
    The delay in seconds to wait after adjusting the contrast (default is 0.1).</p>

<h2 id="returns">Returns</h2>

<p>bool
    True if the contrast is set successfully, False otherwise.</p>

<h2 id="raises">Raises</h2>

<p>ValueError
    If the contrast cannot be adjusted correctly.</p>

<h2 id="examples">Examples</h2>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn"><a href="types.html">pytribeam.types</a></span> <span class="k">as</span> <span class="nn">tbt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">microscope</span> <span class="o">=</span> <span class="n">tbt</span><span class="o">.</span><span class="n">Microscope</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">microscope</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;localhost&quot;</span><span class="p">)</span>
<span class="go">Client connecting to [localhost:7520]...</span>
<span class="go">Client connected to [localhost:7520]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">success</span> <span class="o">=</span> <span class="n">detector_contrast</span><span class="p">(</span><span class="n">microscope</span><span class="p">,</span> <span class="n">contrast</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">success</span><span class="p">)</span>
<span class="go">True</span>
</code></pre>
</div>
</div>


                </section>
                <section id="detector_cb">
                            <input id="detector_cb-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">detector_cb</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">microscope</span><span class="p">:</span> <span class="n"><a href="types.html#Microscope">pytribeam.types.Microscope</a></span>,</span><span class="param">	<span class="n">detector_settings</span><span class="p">:</span> <span class="n"><a href="types.html#Detector">pytribeam.types.Detector</a></span>,</span><span class="param">	<span class="n">beam</span><span class="p">:</span> <span class="n"><a href="types.html#Beam">pytribeam.types.Beam</a></span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <label class="view-source-button" for="detector_cb-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#detector_cb"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="detector_cb-970"><a href="#detector_cb-970"><span class="linenos"> 970</span></a><span class="k">def</span> <span class="nf">detector_cb</span><span class="p">(</span>
</span><span id="detector_cb-971"><a href="#detector_cb-971"><span class="linenos"> 971</span></a>    <span class="n">microscope</span><span class="p">:</span> <span class="n">tbt</span><span class="o">.</span><span class="n">Microscope</span><span class="p">,</span>
</span><span id="detector_cb-972"><a href="#detector_cb-972"><span class="linenos"> 972</span></a>    <span class="n">detector_settings</span><span class="p">:</span> <span class="n">tbt</span><span class="o">.</span><span class="n">Detector</span><span class="p">,</span>
</span><span id="detector_cb-973"><a href="#detector_cb-973"><span class="linenos"> 973</span></a>    <span class="n">beam</span><span class="p">:</span> <span class="n">tbt</span><span class="o">.</span><span class="n">Beam</span><span class="p">,</span>
</span><span id="detector_cb-974"><a href="#detector_cb-974"><span class="linenos"> 974</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="detector_cb-975"><a href="#detector_cb-975"><span class="linenos"> 975</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="detector_cb-976"><a href="#detector_cb-976"><span class="linenos"> 976</span></a><span class="sd">    Sets detector contrast and brightness.</span>
</span><span id="detector_cb-977"><a href="#detector_cb-977"><span class="linenos"> 977</span></a>
</span><span id="detector_cb-978"><a href="#detector_cb-978"><span class="linenos"> 978</span></a><span class="sd">    This function sets the contrast and brightness for the detector on the microscope.</span>
</span><span id="detector_cb-979"><a href="#detector_cb-979"><span class="linenos"> 979</span></a><span class="sd">    It also runs the auto contrast-brightness function if specified in the detector settings.</span>
</span><span id="detector_cb-980"><a href="#detector_cb-980"><span class="linenos"> 980</span></a><span class="sd">    Supports initial settings of contrast and brightness with fixed values before auto adjustment.</span>
</span><span id="detector_cb-981"><a href="#detector_cb-981"><span class="linenos"> 981</span></a>
</span><span id="detector_cb-982"><a href="#detector_cb-982"><span class="linenos"> 982</span></a><span class="sd">    Parameters</span>
</span><span id="detector_cb-983"><a href="#detector_cb-983"><span class="linenos"> 983</span></a><span class="sd">    ----------</span>
</span><span id="detector_cb-984"><a href="#detector_cb-984"><span class="linenos"> 984</span></a><span class="sd">    microscope : tbt.Microscope</span>
</span><span id="detector_cb-985"><a href="#detector_cb-985"><span class="linenos"> 985</span></a><span class="sd">        The microscope object to configure.</span>
</span><span id="detector_cb-986"><a href="#detector_cb-986"><span class="linenos"> 986</span></a><span class="sd">    detector_settings : tbt.Detector</span>
</span><span id="detector_cb-987"><a href="#detector_cb-987"><span class="linenos"> 987</span></a><span class="sd">        The detector settings, including contrast, brightness, and auto contrast-brightness settings.</span>
</span><span id="detector_cb-988"><a href="#detector_cb-988"><span class="linenos"> 988</span></a><span class="sd">    beam : tbt.Beam</span>
</span><span id="detector_cb-989"><a href="#detector_cb-989"><span class="linenos"> 989</span></a><span class="sd">        The beam type to configure.</span>
</span><span id="detector_cb-990"><a href="#detector_cb-990"><span class="linenos"> 990</span></a>
</span><span id="detector_cb-991"><a href="#detector_cb-991"><span class="linenos"> 991</span></a><span class="sd">    Returns</span>
</span><span id="detector_cb-992"><a href="#detector_cb-992"><span class="linenos"> 992</span></a><span class="sd">    -------</span>
</span><span id="detector_cb-993"><a href="#detector_cb-993"><span class="linenos"> 993</span></a><span class="sd">    bool</span>
</span><span id="detector_cb-994"><a href="#detector_cb-994"><span class="linenos"> 994</span></a><span class="sd">        True if the contrast and brightness are set successfully, False otherwise.</span>
</span><span id="detector_cb-995"><a href="#detector_cb-995"><span class="linenos"> 995</span></a>
</span><span id="detector_cb-996"><a href="#detector_cb-996"><span class="linenos"> 996</span></a><span class="sd">    Examples</span>
</span><span id="detector_cb-997"><a href="#detector_cb-997"><span class="linenos"> 997</span></a><span class="sd">    --------</span>
</span><span id="detector_cb-998"><a href="#detector_cb-998"><span class="linenos"> 998</span></a><span class="sd">    &gt;&gt;&gt; import pytribeam.types as tbt</span>
</span><span id="detector_cb-999"><a href="#detector_cb-999"><span class="linenos"> 999</span></a><span class="sd">    &gt;&gt;&gt; microscope = tbt.Microscope()</span>
</span><span id="detector_cb-1000"><a href="#detector_cb-1000"><span class="linenos">1000</span></a><span class="sd">    &gt;&gt;&gt; microscope.connect(&quot;localhost&quot;)</span>
</span><span id="detector_cb-1001"><a href="#detector_cb-1001"><span class="linenos">1001</span></a><span class="sd">    Client connecting to [localhost:7520]...</span>
</span><span id="detector_cb-1002"><a href="#detector_cb-1002"><span class="linenos">1002</span></a><span class="sd">    Client connected to [localhost:7520]</span>
</span><span id="detector_cb-1003"><a href="#detector_cb-1003"><span class="linenos">1003</span></a><span class="sd">    &gt;&gt;&gt; beam = tbt.ElectronBeam(settings=None)</span>
</span><span id="detector_cb-1004"><a href="#detector_cb-1004"><span class="linenos">1004</span></a><span class="sd">    &gt;&gt;&gt; detector_settings = tbt.Detector(contrast=None, brightness=None, auto_cb_settings=tbt.ScanArea(left=0.1, top=0.1, width=0.8, height=0.8))</span>
</span><span id="detector_cb-1005"><a href="#detector_cb-1005"><span class="linenos">1005</span></a><span class="sd">    &gt;&gt;&gt; success = detector_cb(microscope, detector_settings, beam)</span>
</span><span id="detector_cb-1006"><a href="#detector_cb-1006"><span class="linenos">1006</span></a><span class="sd">    &gt;&gt;&gt; print(success)</span>
</span><span id="detector_cb-1007"><a href="#detector_cb-1007"><span class="linenos">1007</span></a><span class="sd">    True</span>
</span><span id="detector_cb-1008"><a href="#detector_cb-1008"><span class="linenos">1008</span></a>
</span><span id="detector_cb-1009"><a href="#detector_cb-1009"><span class="linenos">1009</span></a><span class="sd">    &gt;&gt;&gt; detector_settings = tbt.Detector(contrast=0.2, brightness=0.3, auto_cb_settings=None)</span>
</span><span id="detector_cb-1010"><a href="#detector_cb-1010"><span class="linenos">1010</span></a><span class="sd">    &gt;&gt;&gt; success = detector_cb(microscope, detector_settings, beam)</span>
</span><span id="detector_cb-1011"><a href="#detector_cb-1011"><span class="linenos">1011</span></a><span class="sd">    &gt;&gt;&gt; print(success)</span>
</span><span id="detector_cb-1012"><a href="#detector_cb-1012"><span class="linenos">1012</span></a><span class="sd">    True</span>
</span><span id="detector_cb-1013"><a href="#detector_cb-1013"><span class="linenos">1013</span></a><span class="sd">    &gt;&gt;&gt; beam_brightness = microscope.detector.brightness.value</span>
</span><span id="detector_cb-1014"><a href="#detector_cb-1014"><span class="linenos">1014</span></a><span class="sd">    &gt;&gt;&gt; print(beam_brightness)</span>
</span><span id="detector_cb-1015"><a href="#detector_cb-1015"><span class="linenos">1015</span></a><span class="sd">    0.3</span>
</span><span id="detector_cb-1016"><a href="#detector_cb-1016"><span class="linenos">1016</span></a><span class="sd">    &gt;&gt;&gt; beam_contrast = microscope.detector.contrast.value</span>
</span><span id="detector_cb-1017"><a href="#detector_cb-1017"><span class="linenos">1017</span></a><span class="sd">    &gt;&gt;&gt; print(beam_contrast)</span>
</span><span id="detector_cb-1018"><a href="#detector_cb-1018"><span class="linenos">1018</span></a><span class="sd">    0.2</span>
</span><span id="detector_cb-1019"><a href="#detector_cb-1019"><span class="linenos">1019</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="detector_cb-1020"><a href="#detector_cb-1020"><span class="linenos">1020</span></a>    <span class="c1">### cannot ensure detector is the active one, will overwrite mode settings, so following line is not used</span>
</span><span id="detector_cb-1021"><a href="#detector_cb-1021"><span class="linenos">1021</span></a>    <span class="c1"># microscope.detector.type.value = detector_settings.type.value</span>
</span><span id="detector_cb-1022"><a href="#detector_cb-1022"><span class="linenos">1022</span></a>    <span class="n">contrast</span> <span class="o">=</span> <span class="n">detector_settings</span><span class="o">.</span><span class="n">contrast</span>
</span><span id="detector_cb-1023"><a href="#detector_cb-1023"><span class="linenos">1023</span></a>    <span class="n">brightness</span> <span class="o">=</span> <span class="n">detector_settings</span><span class="o">.</span><span class="n">brightness</span>
</span><span id="detector_cb-1024"><a href="#detector_cb-1024"><span class="linenos">1024</span></a>    <span class="k">if</span> <span class="n">contrast</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="detector_cb-1025"><a href="#detector_cb-1025"><span class="linenos">1025</span></a>        <span class="n">detector_contrast</span><span class="p">(</span><span class="n">microscope</span><span class="o">=</span><span class="n">microscope</span><span class="p">,</span> <span class="n">contrast</span><span class="o">=</span><span class="n">contrast</span><span class="p">)</span>
</span><span id="detector_cb-1026"><a href="#detector_cb-1026"><span class="linenos">1026</span></a>    <span class="k">if</span> <span class="n">brightness</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="detector_cb-1027"><a href="#detector_cb-1027"><span class="linenos">1027</span></a>        <span class="n">detector_brightness</span><span class="p">(</span><span class="n">microscope</span><span class="o">=</span><span class="n">microscope</span><span class="p">,</span> <span class="n">brightness</span><span class="o">=</span><span class="n">brightness</span><span class="p">)</span>
</span><span id="detector_cb-1028"><a href="#detector_cb-1028"><span class="linenos">1028</span></a>
</span><span id="detector_cb-1029"><a href="#detector_cb-1029"><span class="linenos">1029</span></a>    <span class="n">null_scan</span> <span class="o">=</span> <span class="n">tbt</span><span class="o">.</span><span class="n">ScanArea</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</span><span id="detector_cb-1030"><a href="#detector_cb-1030"><span class="linenos">1030</span></a>    <span class="k">if</span> <span class="ow">not</span> <span class="n">null_scan</span> <span class="o">==</span> <span class="n">detector_settings</span><span class="o">.</span><span class="n">auto_cb_settings</span><span class="p">:</span>
</span><span id="detector_cb-1031"><a href="#detector_cb-1031"><span class="linenos">1031</span></a>        <span class="n">detector_auto_cb</span><span class="p">(</span>
</span><span id="detector_cb-1032"><a href="#detector_cb-1032"><span class="linenos">1032</span></a>            <span class="n">microscope</span><span class="o">=</span><span class="n">microscope</span><span class="p">,</span>
</span><span id="detector_cb-1033"><a href="#detector_cb-1033"><span class="linenos">1033</span></a>            <span class="n">settings</span><span class="o">=</span><span class="n">detector_settings</span><span class="o">.</span><span class="n">auto_cb_settings</span><span class="p">,</span>
</span><span id="detector_cb-1034"><a href="#detector_cb-1034"><span class="linenos">1034</span></a>            <span class="n">beam</span><span class="o">=</span><span class="n">beam</span><span class="p">,</span>
</span><span id="detector_cb-1035"><a href="#detector_cb-1035"><span class="linenos">1035</span></a>        <span class="p">)</span>
</span><span id="detector_cb-1036"><a href="#detector_cb-1036"><span class="linenos">1036</span></a>    <span class="k">return</span> <span class="kc">True</span>
</span></pre></div>


            <div class="docstring"><p>Sets detector contrast and brightness.</p>

<p>This function sets the contrast and brightness for the detector on the microscope.
It also runs the auto contrast-brightness function if specified in the detector settings.
Supports initial settings of contrast and brightness with fixed values before auto adjustment.</p>

<h2 id="parameters">Parameters</h2>

<p>microscope : tbt.Microscope
    The microscope object to configure.
detector_settings : tbt.Detector
    The detector settings, including contrast, brightness, and auto contrast-brightness settings.
beam : tbt.Beam
    The beam type to configure.</p>

<h2 id="returns">Returns</h2>

<p>bool
    True if the contrast and brightness are set successfully, False otherwise.</p>

<h2 id="examples">Examples</h2>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn"><a href="types.html">pytribeam.types</a></span> <span class="k">as</span> <span class="nn">tbt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">microscope</span> <span class="o">=</span> <span class="n">tbt</span><span class="o">.</span><span class="n">Microscope</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">microscope</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;localhost&quot;</span><span class="p">)</span>
<span class="go">Client connecting to [localhost:7520]...</span>
<span class="go">Client connected to [localhost:7520]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">beam</span> <span class="o">=</span> <span class="n">tbt</span><span class="o">.</span><span class="n">ElectronBeam</span><span class="p">(</span><span class="n">settings</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">detector_settings</span> <span class="o">=</span> <span class="n">tbt</span><span class="o">.</span><span class="n">Detector</span><span class="p">(</span><span class="n">contrast</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">brightness</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">auto_cb_settings</span><span class="o">=</span><span class="n">tbt</span><span class="o">.</span><span class="n">ScanArea</span><span class="p">(</span><span class="n">left</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">top</span><span class="o">=</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">width</span><span class="o">=</span><span class="mf">0.8</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mf">0.8</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">success</span> <span class="o">=</span> <span class="n">detector_cb</span><span class="p">(</span><span class="n">microscope</span><span class="p">,</span> <span class="n">detector_settings</span><span class="p">,</span> <span class="n">beam</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">success</span><span class="p">)</span>
<span class="go">True</span>
</code></pre>
</div>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="n">detector_settings</span> <span class="o">=</span> <span class="n">tbt</span><span class="o">.</span><span class="n">Detector</span><span class="p">(</span><span class="n">contrast</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">brightness</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> <span class="n">auto_cb_settings</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">success</span> <span class="o">=</span> <span class="n">detector_cb</span><span class="p">(</span><span class="n">microscope</span><span class="p">,</span> <span class="n">detector_settings</span><span class="p">,</span> <span class="n">beam</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">success</span><span class="p">)</span>
<span class="go">True</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">beam_brightness</span> <span class="o">=</span> <span class="n">microscope</span><span class="o">.</span><span class="n">detector</span><span class="o">.</span><span class="n">brightness</span><span class="o">.</span><span class="n">value</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">beam_brightness</span><span class="p">)</span>
<span class="go">0.3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">beam_contrast</span> <span class="o">=</span> <span class="n">microscope</span><span class="o">.</span><span class="n">detector</span><span class="o">.</span><span class="n">contrast</span><span class="o">.</span><span class="n">value</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">beam_contrast</span><span class="p">)</span>
<span class="go">0.2</span>
</code></pre>
</div>
</div>


                </section>
                <section id="detector_mode">
                            <input id="detector_mode-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">detector_mode</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">microscope</span><span class="p">:</span> <span class="n"><a href="types.html#Microscope">pytribeam.types.Microscope</a></span>,</span><span class="param">	<span class="n">detector_mode</span><span class="p">:</span> <span class="n"><a href="types.html#DetectorMode">pytribeam.types.DetectorMode</a></span>,</span><span class="param">	<span class="n">delay_s</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.1</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <label class="view-source-button" for="detector_mode-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#detector_mode"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="detector_mode-1039"><a href="#detector_mode-1039"><span class="linenos">1039</span></a><span class="k">def</span> <span class="nf">detector_mode</span><span class="p">(</span>
</span><span id="detector_mode-1040"><a href="#detector_mode-1040"><span class="linenos">1040</span></a>    <span class="n">microscope</span><span class="p">:</span> <span class="n">tbt</span><span class="o">.</span><span class="n">Microscope</span><span class="p">,</span>
</span><span id="detector_mode-1041"><a href="#detector_mode-1041"><span class="linenos">1041</span></a>    <span class="n">detector_mode</span><span class="p">:</span> <span class="n">tbt</span><span class="o">.</span><span class="n">DetectorMode</span><span class="p">,</span>
</span><span id="detector_mode-1042"><a href="#detector_mode-1042"><span class="linenos">1042</span></a>    <span class="n">delay_s</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span>
</span><span id="detector_mode-1043"><a href="#detector_mode-1043"><span class="linenos">1043</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="detector_mode-1044"><a href="#detector_mode-1044"><span class="linenos">1044</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="detector_mode-1045"><a href="#detector_mode-1045"><span class="linenos">1045</span></a><span class="sd">    Sets the detector mode.</span>
</span><span id="detector_mode-1046"><a href="#detector_mode-1046"><span class="linenos">1046</span></a>
</span><span id="detector_mode-1047"><a href="#detector_mode-1047"><span class="linenos">1047</span></a><span class="sd">    This function sets the mode for the detector on the microscope and waits for the specified delay.</span>
</span><span id="detector_mode-1048"><a href="#detector_mode-1048"><span class="linenos">1048</span></a>
</span><span id="detector_mode-1049"><a href="#detector_mode-1049"><span class="linenos">1049</span></a><span class="sd">    Parameters</span>
</span><span id="detector_mode-1050"><a href="#detector_mode-1050"><span class="linenos">1050</span></a><span class="sd">    ----------</span>
</span><span id="detector_mode-1051"><a href="#detector_mode-1051"><span class="linenos">1051</span></a><span class="sd">    microscope : tbt.Microscope</span>
</span><span id="detector_mode-1052"><a href="#detector_mode-1052"><span class="linenos">1052</span></a><span class="sd">        The microscope object to configure.</span>
</span><span id="detector_mode-1053"><a href="#detector_mode-1053"><span class="linenos">1053</span></a><span class="sd">    detector_mode : tbt.DetectorMode</span>
</span><span id="detector_mode-1054"><a href="#detector_mode-1054"><span class="linenos">1054</span></a><span class="sd">        The desired detector mode.</span>
</span><span id="detector_mode-1055"><a href="#detector_mode-1055"><span class="linenos">1055</span></a><span class="sd">    delay_s : float, optional</span>
</span><span id="detector_mode-1056"><a href="#detector_mode-1056"><span class="linenos">1056</span></a><span class="sd">        The delay in seconds to wait after setting the detector mode (default is 0.1).</span>
</span><span id="detector_mode-1057"><a href="#detector_mode-1057"><span class="linenos">1057</span></a>
</span><span id="detector_mode-1058"><a href="#detector_mode-1058"><span class="linenos">1058</span></a><span class="sd">    Returns</span>
</span><span id="detector_mode-1059"><a href="#detector_mode-1059"><span class="linenos">1059</span></a><span class="sd">    -------</span>
</span><span id="detector_mode-1060"><a href="#detector_mode-1060"><span class="linenos">1060</span></a><span class="sd">    bool</span>
</span><span id="detector_mode-1061"><a href="#detector_mode-1061"><span class="linenos">1061</span></a><span class="sd">        True if the detector mode is set successfully, False otherwise.</span>
</span><span id="detector_mode-1062"><a href="#detector_mode-1062"><span class="linenos">1062</span></a>
</span><span id="detector_mode-1063"><a href="#detector_mode-1063"><span class="linenos">1063</span></a><span class="sd">    Raises</span>
</span><span id="detector_mode-1064"><a href="#detector_mode-1064"><span class="linenos">1064</span></a><span class="sd">    ------</span>
</span><span id="detector_mode-1065"><a href="#detector_mode-1065"><span class="linenos">1065</span></a><span class="sd">    ValueError</span>
</span><span id="detector_mode-1066"><a href="#detector_mode-1066"><span class="linenos">1066</span></a><span class="sd">        If the detector mode cannot be set correctly.</span>
</span><span id="detector_mode-1067"><a href="#detector_mode-1067"><span class="linenos">1067</span></a>
</span><span id="detector_mode-1068"><a href="#detector_mode-1068"><span class="linenos">1068</span></a><span class="sd">    Examples</span>
</span><span id="detector_mode-1069"><a href="#detector_mode-1069"><span class="linenos">1069</span></a><span class="sd">    --------</span>
</span><span id="detector_mode-1070"><a href="#detector_mode-1070"><span class="linenos">1070</span></a><span class="sd">    &gt;&gt;&gt; import pytribeam.types as tbt</span>
</span><span id="detector_mode-1071"><a href="#detector_mode-1071"><span class="linenos">1071</span></a><span class="sd">    &gt;&gt;&gt; microscope = tbt.Microscope()</span>
</span><span id="detector_mode-1072"><a href="#detector_mode-1072"><span class="linenos">1072</span></a><span class="sd">    &gt;&gt;&gt; microscope.connect(&quot;localhost&quot;)</span>
</span><span id="detector_mode-1073"><a href="#detector_mode-1073"><span class="linenos">1073</span></a><span class="sd">    Client connecting to [localhost:7520]...</span>
</span><span id="detector_mode-1074"><a href="#detector_mode-1074"><span class="linenos">1074</span></a><span class="sd">    Client connected to [localhost:7520]</span>
</span><span id="detector_mode-1075"><a href="#detector_mode-1075"><span class="linenos">1075</span></a><span class="sd">    &gt;&gt;&gt; mode = tbt.DetectorMode.SECONDARY_ELECTRONS</span>
</span><span id="detector_mode-1076"><a href="#detector_mode-1076"><span class="linenos">1076</span></a><span class="sd">    &gt;&gt;&gt; success = detector_mode(microscope, mode)</span>
</span><span id="detector_mode-1077"><a href="#detector_mode-1077"><span class="linenos">1077</span></a><span class="sd">    &gt;&gt;&gt; print(success)</span>
</span><span id="detector_mode-1078"><a href="#detector_mode-1078"><span class="linenos">1078</span></a><span class="sd">    True</span>
</span><span id="detector_mode-1079"><a href="#detector_mode-1079"><span class="linenos">1079</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="detector_mode-1080"><a href="#detector_mode-1080"><span class="linenos">1080</span></a>    <span class="n">microscope</span><span class="o">.</span><span class="n">detector</span><span class="o">.</span><span class="n">mode</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">detector_mode</span><span class="o">.</span><span class="n">value</span>
</span><span id="detector_mode-1081"><a href="#detector_mode-1081"><span class="linenos">1081</span></a>    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">delay_s</span><span class="p">)</span>
</span><span id="detector_mode-1082"><a href="#detector_mode-1082"><span class="linenos">1082</span></a>    <span class="k">if</span> <span class="n">microscope</span><span class="o">.</span><span class="n">detector</span><span class="o">.</span><span class="n">mode</span><span class="o">.</span><span class="n">value</span> <span class="o">!=</span> <span class="n">detector_mode</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>
</span><span id="detector_mode-1083"><a href="#detector_mode-1083"><span class="linenos">1083</span></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="detector_mode-1084"><a href="#detector_mode-1084"><span class="linenos">1084</span></a>            <span class="sa">f</span><span class="s2">&quot;&quot;&quot;Could not correctly set detector mode,</span>
</span><span id="detector_mode-1085"><a href="#detector_mode-1085"><span class="linenos">1085</span></a><span class="s2">            requested </span><span class="si">{</span><span class="n">detector_mode</span><span class="si">}</span><span class="s2">, current mode is</span>
</span><span id="detector_mode-1086"><a href="#detector_mode-1086"><span class="linenos">1086</span></a><span class="s2">            </span><span class="si">{</span><span class="n">microscope</span><span class="o">.</span><span class="n">detector</span><span class="o">.</span><span class="n">mode</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;&quot;&quot;</span>
</span><span id="detector_mode-1087"><a href="#detector_mode-1087"><span class="linenos">1087</span></a>        <span class="p">)</span>
</span><span id="detector_mode-1088"><a href="#detector_mode-1088"><span class="linenos">1088</span></a>    <span class="k">return</span> <span class="kc">True</span>
</span></pre></div>


            <div class="docstring"><p>Sets the detector mode.</p>

<p>This function sets the mode for the detector on the microscope and waits for the specified delay.</p>

<h2 id="parameters">Parameters</h2>

<p>microscope : tbt.Microscope
    The microscope object to configure.
detector_mode : tbt.DetectorMode
    The desired detector mode.
delay_s : float, optional
    The delay in seconds to wait after setting the detector mode (default is 0.1).</p>

<h2 id="returns">Returns</h2>

<p>bool
    True if the detector mode is set successfully, False otherwise.</p>

<h2 id="raises">Raises</h2>

<p>ValueError
    If the detector mode cannot be set correctly.</p>

<h2 id="examples">Examples</h2>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn"><a href="types.html">pytribeam.types</a></span> <span class="k">as</span> <span class="nn">tbt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">microscope</span> <span class="o">=</span> <span class="n">tbt</span><span class="o">.</span><span class="n">Microscope</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">microscope</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;localhost&quot;</span><span class="p">)</span>
<span class="go">Client connecting to [localhost:7520]...</span>
<span class="go">Client connected to [localhost:7520]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mode</span> <span class="o">=</span> <span class="n">tbt</span><span class="o">.</span><span class="n">DetectorMode</span><span class="o">.</span><span class="n">SECONDARY_ELECTRONS</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">success</span> <span class="o">=</span> <span class="n">detector_mode</span><span class="p">(</span><span class="n">microscope</span><span class="p">,</span> <span class="n">mode</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">success</span><span class="p">)</span>
<span class="go">True</span>
</code></pre>
</div>
</div>


                </section>
                <section id="detector_type">
                            <input id="detector_type-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">detector_type</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">microscope</span><span class="p">:</span> <span class="n"><a href="types.html#Microscope">pytribeam.types.Microscope</a></span>,</span><span class="param">	<span class="n">detector</span><span class="p">:</span> <span class="n"><a href="types.html#DetectorType">pytribeam.types.DetectorType</a></span>,</span><span class="param">	<span class="n">delay_s</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.1</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <label class="view-source-button" for="detector_type-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#detector_type"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="detector_type-1091"><a href="#detector_type-1091"><span class="linenos">1091</span></a><span class="k">def</span> <span class="nf">detector_type</span><span class="p">(</span>
</span><span id="detector_type-1092"><a href="#detector_type-1092"><span class="linenos">1092</span></a>    <span class="n">microscope</span><span class="p">:</span> <span class="n">tbt</span><span class="o">.</span><span class="n">Microscope</span><span class="p">,</span>
</span><span id="detector_type-1093"><a href="#detector_type-1093"><span class="linenos">1093</span></a>    <span class="n">detector</span><span class="p">:</span> <span class="n">tbt</span><span class="o">.</span><span class="n">DetectorType</span><span class="p">,</span>
</span><span id="detector_type-1094"><a href="#detector_type-1094"><span class="linenos">1094</span></a>    <span class="n">delay_s</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span>
</span><span id="detector_type-1095"><a href="#detector_type-1095"><span class="linenos">1095</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="detector_type-1096"><a href="#detector_type-1096"><span class="linenos">1096</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="detector_type-1097"><a href="#detector_type-1097"><span class="linenos">1097</span></a><span class="sd">    Sets the detector type.</span>
</span><span id="detector_type-1098"><a href="#detector_type-1098"><span class="linenos">1098</span></a>
</span><span id="detector_type-1099"><a href="#detector_type-1099"><span class="linenos">1099</span></a><span class="sd">    This function sets the type for the detector on the microscope and waits for the specified delay.</span>
</span><span id="detector_type-1100"><a href="#detector_type-1100"><span class="linenos">1100</span></a>
</span><span id="detector_type-1101"><a href="#detector_type-1101"><span class="linenos">1101</span></a><span class="sd">    Parameters</span>
</span><span id="detector_type-1102"><a href="#detector_type-1102"><span class="linenos">1102</span></a><span class="sd">    ----------</span>
</span><span id="detector_type-1103"><a href="#detector_type-1103"><span class="linenos">1103</span></a><span class="sd">    microscope : tbt.Microscope</span>
</span><span id="detector_type-1104"><a href="#detector_type-1104"><span class="linenos">1104</span></a><span class="sd">        The microscope object to configure.</span>
</span><span id="detector_type-1105"><a href="#detector_type-1105"><span class="linenos">1105</span></a><span class="sd">    detector : tbt.DetectorType</span>
</span><span id="detector_type-1106"><a href="#detector_type-1106"><span class="linenos">1106</span></a><span class="sd">        The desired detector type.</span>
</span><span id="detector_type-1107"><a href="#detector_type-1107"><span class="linenos">1107</span></a><span class="sd">    delay_s : float, optional</span>
</span><span id="detector_type-1108"><a href="#detector_type-1108"><span class="linenos">1108</span></a><span class="sd">        The delay in seconds to wait after setting the detector type (default is 0.1).</span>
</span><span id="detector_type-1109"><a href="#detector_type-1109"><span class="linenos">1109</span></a>
</span><span id="detector_type-1110"><a href="#detector_type-1110"><span class="linenos">1110</span></a><span class="sd">    Returns</span>
</span><span id="detector_type-1111"><a href="#detector_type-1111"><span class="linenos">1111</span></a><span class="sd">    -------</span>
</span><span id="detector_type-1112"><a href="#detector_type-1112"><span class="linenos">1112</span></a><span class="sd">    bool</span>
</span><span id="detector_type-1113"><a href="#detector_type-1113"><span class="linenos">1113</span></a><span class="sd">        True if the detector type is set successfully, False otherwise.</span>
</span><span id="detector_type-1114"><a href="#detector_type-1114"><span class="linenos">1114</span></a>
</span><span id="detector_type-1115"><a href="#detector_type-1115"><span class="linenos">1115</span></a><span class="sd">    Raises</span>
</span><span id="detector_type-1116"><a href="#detector_type-1116"><span class="linenos">1116</span></a><span class="sd">    ------</span>
</span><span id="detector_type-1117"><a href="#detector_type-1117"><span class="linenos">1117</span></a><span class="sd">    ValueError</span>
</span><span id="detector_type-1118"><a href="#detector_type-1118"><span class="linenos">1118</span></a><span class="sd">        If the detector type cannot be set correctly.</span>
</span><span id="detector_type-1119"><a href="#detector_type-1119"><span class="linenos">1119</span></a>
</span><span id="detector_type-1120"><a href="#detector_type-1120"><span class="linenos">1120</span></a><span class="sd">    Examples</span>
</span><span id="detector_type-1121"><a href="#detector_type-1121"><span class="linenos">1121</span></a><span class="sd">    --------</span>
</span><span id="detector_type-1122"><a href="#detector_type-1122"><span class="linenos">1122</span></a><span class="sd">    &gt;&gt;&gt; import pytribeam.types as tbt</span>
</span><span id="detector_type-1123"><a href="#detector_type-1123"><span class="linenos">1123</span></a><span class="sd">    &gt;&gt;&gt; microscope = tbt.Microscope()</span>
</span><span id="detector_type-1124"><a href="#detector_type-1124"><span class="linenos">1124</span></a><span class="sd">    &gt;&gt;&gt; microscope.connect(&quot;localhost&quot;)</span>
</span><span id="detector_type-1125"><a href="#detector_type-1125"><span class="linenos">1125</span></a><span class="sd">    Client connecting to [localhost:7520]...</span>
</span><span id="detector_type-1126"><a href="#detector_type-1126"><span class="linenos">1126</span></a><span class="sd">    Client connected to [localhost:7520]</span>
</span><span id="detector_type-1127"><a href="#detector_type-1127"><span class="linenos">1127</span></a><span class="sd">    &gt;&gt;&gt; detector = tbt.DetectorType.ETD</span>
</span><span id="detector_type-1128"><a href="#detector_type-1128"><span class="linenos">1128</span></a><span class="sd">    &gt;&gt;&gt; success = detector_type(microscope, detector)</span>
</span><span id="detector_type-1129"><a href="#detector_type-1129"><span class="linenos">1129</span></a><span class="sd">    &gt;&gt;&gt; print(success)</span>
</span><span id="detector_type-1130"><a href="#detector_type-1130"><span class="linenos">1130</span></a><span class="sd">    True</span>
</span><span id="detector_type-1131"><a href="#detector_type-1131"><span class="linenos">1131</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="detector_type-1132"><a href="#detector_type-1132"><span class="linenos">1132</span></a>    <span class="n">microscope</span><span class="o">.</span><span class="n">detector</span><span class="o">.</span><span class="n">type</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">detector</span><span class="o">.</span><span class="n">value</span>
</span><span id="detector_type-1133"><a href="#detector_type-1133"><span class="linenos">1133</span></a>    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">delay_s</span><span class="p">)</span>
</span><span id="detector_type-1134"><a href="#detector_type-1134"><span class="linenos">1134</span></a>    <span class="k">if</span> <span class="n">microscope</span><span class="o">.</span><span class="n">detector</span><span class="o">.</span><span class="n">type</span><span class="o">.</span><span class="n">value</span> <span class="o">!=</span> <span class="n">detector</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>
</span><span id="detector_type-1135"><a href="#detector_type-1135"><span class="linenos">1135</span></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="detector_type-1136"><a href="#detector_type-1136"><span class="linenos">1136</span></a>            <span class="sa">f</span><span class="s2">&quot;&quot;&quot;Could not correctly set detector type,</span>
</span><span id="detector_type-1137"><a href="#detector_type-1137"><span class="linenos">1137</span></a><span class="s2">            requested </span><span class="si">{</span><span class="n">detector</span><span class="si">}</span><span class="s2">, current detector is</span>
</span><span id="detector_type-1138"><a href="#detector_type-1138"><span class="linenos">1138</span></a><span class="s2">            </span><span class="si">{</span><span class="n">microscope</span><span class="o">.</span><span class="n">detector</span><span class="o">.</span><span class="n">type</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2">&quot;&quot;&quot;</span>
</span><span id="detector_type-1139"><a href="#detector_type-1139"><span class="linenos">1139</span></a>        <span class="p">)</span>
</span><span id="detector_type-1140"><a href="#detector_type-1140"><span class="linenos">1140</span></a>    <span class="k">return</span> <span class="kc">True</span>
</span></pre></div>


            <div class="docstring"><p>Sets the detector type.</p>

<p>This function sets the type for the detector on the microscope and waits for the specified delay.</p>

<h2 id="parameters">Parameters</h2>

<p>microscope : tbt.Microscope
    The microscope object to configure.
detector : tbt.DetectorType
    The desired detector type.
delay_s : float, optional
    The delay in seconds to wait after setting the detector type (default is 0.1).</p>

<h2 id="returns">Returns</h2>

<p>bool
    True if the detector type is set successfully, False otherwise.</p>

<h2 id="raises">Raises</h2>

<p>ValueError
    If the detector type cannot be set correctly.</p>

<h2 id="examples">Examples</h2>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn"><a href="types.html">pytribeam.types</a></span> <span class="k">as</span> <span class="nn">tbt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">microscope</span> <span class="o">=</span> <span class="n">tbt</span><span class="o">.</span><span class="n">Microscope</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">microscope</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;localhost&quot;</span><span class="p">)</span>
<span class="go">Client connecting to [localhost:7520]...</span>
<span class="go">Client connected to [localhost:7520]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">detector</span> <span class="o">=</span> <span class="n">tbt</span><span class="o">.</span><span class="n">DetectorType</span><span class="o">.</span><span class="n">ETD</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">success</span> <span class="o">=</span> <span class="n">detector_type</span><span class="p">(</span><span class="n">microscope</span><span class="p">,</span> <span class="n">detector</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">success</span><span class="p">)</span>
<span class="go">True</span>
</code></pre>
</div>
</div>


                </section>
                <section id="grab_custom_resolution_frame">
                            <input id="grab_custom_resolution_frame-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">grab_custom_resolution_frame</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">img_settings</span><span class="p">:</span> <span class="n"><a href="types.html#ImageSettings">pytribeam.types.ImageSettings</a></span>,</span><span class="param">	<span class="n">save_path</span><span class="p">:</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <label class="view-source-button" for="grab_custom_resolution_frame-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#grab_custom_resolution_frame"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="grab_custom_resolution_frame-1143"><a href="#grab_custom_resolution_frame-1143"><span class="linenos">1143</span></a><span class="k">def</span> <span class="nf">grab_custom_resolution_frame</span><span class="p">(</span>
</span><span id="grab_custom_resolution_frame-1144"><a href="#grab_custom_resolution_frame-1144"><span class="linenos">1144</span></a>    <span class="n">img_settings</span><span class="p">:</span> <span class="n">tbt</span><span class="o">.</span><span class="n">ImageSettings</span><span class="p">,</span>
</span><span id="grab_custom_resolution_frame-1145"><a href="#grab_custom_resolution_frame-1145"><span class="linenos">1145</span></a>    <span class="n">save_path</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span>
</span><span id="grab_custom_resolution_frame-1146"><a href="#grab_custom_resolution_frame-1146"><span class="linenos">1146</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="grab_custom_resolution_frame-1147"><a href="#grab_custom_resolution_frame-1147"><span class="linenos">1147</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="grab_custom_resolution_frame-1148"><a href="#grab_custom_resolution_frame-1148"><span class="linenos">1148</span></a><span class="sd">    Method for single frame imaging used with custom resolutions.</span>
</span><span id="grab_custom_resolution_frame-1149"><a href="#grab_custom_resolution_frame-1149"><span class="linenos">1149</span></a>
</span><span id="grab_custom_resolution_frame-1150"><a href="#grab_custom_resolution_frame-1150"><span class="linenos">1150</span></a><span class="sd">    This function captures a single frame image using custom resolutions and saves it to the specified path.</span>
</span><span id="grab_custom_resolution_frame-1151"><a href="#grab_custom_resolution_frame-1151"><span class="linenos">1151</span></a>
</span><span id="grab_custom_resolution_frame-1152"><a href="#grab_custom_resolution_frame-1152"><span class="linenos">1152</span></a><span class="sd">    Parameters</span>
</span><span id="grab_custom_resolution_frame-1153"><a href="#grab_custom_resolution_frame-1153"><span class="linenos">1153</span></a><span class="sd">    ----------</span>
</span><span id="grab_custom_resolution_frame-1154"><a href="#grab_custom_resolution_frame-1154"><span class="linenos">1154</span></a><span class="sd">    img_settings : tbt.ImageSettings</span>
</span><span id="grab_custom_resolution_frame-1155"><a href="#grab_custom_resolution_frame-1155"><span class="linenos">1155</span></a><span class="sd">        The image settings, including the microscope and scan resolution.</span>
</span><span id="grab_custom_resolution_frame-1156"><a href="#grab_custom_resolution_frame-1156"><span class="linenos">1156</span></a><span class="sd">    save_path : Path</span>
</span><span id="grab_custom_resolution_frame-1157"><a href="#grab_custom_resolution_frame-1157"><span class="linenos">1157</span></a><span class="sd">        The path to save the captured image.</span>
</span><span id="grab_custom_resolution_frame-1158"><a href="#grab_custom_resolution_frame-1158"><span class="linenos">1158</span></a>
</span><span id="grab_custom_resolution_frame-1159"><a href="#grab_custom_resolution_frame-1159"><span class="linenos">1159</span></a><span class="sd">    Returns</span>
</span><span id="grab_custom_resolution_frame-1160"><a href="#grab_custom_resolution_frame-1160"><span class="linenos">1160</span></a><span class="sd">    -------</span>
</span><span id="grab_custom_resolution_frame-1161"><a href="#grab_custom_resolution_frame-1161"><span class="linenos">1161</span></a><span class="sd">    bool</span>
</span><span id="grab_custom_resolution_frame-1162"><a href="#grab_custom_resolution_frame-1162"><span class="linenos">1162</span></a><span class="sd">        True if the image is captured and saved successfully, False otherwise.</span>
</span><span id="grab_custom_resolution_frame-1163"><a href="#grab_custom_resolution_frame-1163"><span class="linenos">1163</span></a>
</span><span id="grab_custom_resolution_frame-1164"><a href="#grab_custom_resolution_frame-1164"><span class="linenos">1164</span></a><span class="sd">    Examples</span>
</span><span id="grab_custom_resolution_frame-1165"><a href="#grab_custom_resolution_frame-1165"><span class="linenos">1165</span></a><span class="sd">    --------</span>
</span><span id="grab_custom_resolution_frame-1166"><a href="#grab_custom_resolution_frame-1166"><span class="linenos">1166</span></a><span class="sd">    &gt;&gt;&gt; import pytribeam.types as tbt</span>
</span><span id="grab_custom_resolution_frame-1167"><a href="#grab_custom_resolution_frame-1167"><span class="linenos">1167</span></a><span class="sd">    &gt;&gt;&gt; from pathlib import Path</span>
</span><span id="grab_custom_resolution_frame-1168"><a href="#grab_custom_resolution_frame-1168"><span class="linenos">1168</span></a><span class="sd">    &gt;&gt;&gt; microscope = tbt.Microscope()</span>
</span><span id="grab_custom_resolution_frame-1169"><a href="#grab_custom_resolution_frame-1169"><span class="linenos">1169</span></a><span class="sd">    &gt;&gt;&gt; microscope.connect(&quot;localhost&quot;)</span>
</span><span id="grab_custom_resolution_frame-1170"><a href="#grab_custom_resolution_frame-1170"><span class="linenos">1170</span></a><span class="sd">    Client connecting to [localhost:7520]...</span>
</span><span id="grab_custom_resolution_frame-1171"><a href="#grab_custom_resolution_frame-1171"><span class="linenos">1171</span></a><span class="sd">    Client connected to [localhost:7520]</span>
</span><span id="grab_custom_resolution_frame-1172"><a href="#grab_custom_resolution_frame-1172"><span class="linenos">1172</span></a><span class="sd">    &gt;&gt;&gt; img_settings = tbt.ImageSettings(</span>
</span><span id="grab_custom_resolution_frame-1173"><a href="#grab_custom_resolution_frame-1173"><span class="linenos">1173</span></a><span class="sd">    ...     microscope=microscope,</span>
</span><span id="grab_custom_resolution_frame-1174"><a href="#grab_custom_resolution_frame-1174"><span class="linenos">1174</span></a><span class="sd">    ...     beam=tbt.ElectronBeam(settings=None),</span>
</span><span id="grab_custom_resolution_frame-1175"><a href="#grab_custom_resolution_frame-1175"><span class="linenos">1175</span></a><span class="sd">    ...     detector=tbt.Detector(),</span>
</span><span id="grab_custom_resolution_frame-1176"><a href="#grab_custom_resolution_frame-1176"><span class="linenos">1176</span></a><span class="sd">    ...     scan=tbt.Scan(resolution=tbt.Resolution(width=1024, height=768)),</span>
</span><span id="grab_custom_resolution_frame-1177"><a href="#grab_custom_resolution_frame-1177"><span class="linenos">1177</span></a><span class="sd">    ...     bit_depth=tbt.ColorDepth.BITS_8,</span>
</span><span id="grab_custom_resolution_frame-1178"><a href="#grab_custom_resolution_frame-1178"><span class="linenos">1178</span></a><span class="sd">    ... )</span>
</span><span id="grab_custom_resolution_frame-1179"><a href="#grab_custom_resolution_frame-1179"><span class="linenos">1179</span></a><span class="sd">    &gt;&gt;&gt; save_path = Path(&quot;/path/to/save/image.tif&quot;)</span>
</span><span id="grab_custom_resolution_frame-1180"><a href="#grab_custom_resolution_frame-1180"><span class="linenos">1180</span></a><span class="sd">    &gt;&gt;&gt; success = grab_custom_resolution_frame(img_settings, save_path)</span>
</span><span id="grab_custom_resolution_frame-1181"><a href="#grab_custom_resolution_frame-1181"><span class="linenos">1181</span></a><span class="sd">    &gt;&gt;&gt; print(success)</span>
</span><span id="grab_custom_resolution_frame-1182"><a href="#grab_custom_resolution_frame-1182"><span class="linenos">1182</span></a><span class="sd">    True</span>
</span><span id="grab_custom_resolution_frame-1183"><a href="#grab_custom_resolution_frame-1183"><span class="linenos">1183</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="grab_custom_resolution_frame-1184"><a href="#grab_custom_resolution_frame-1184"><span class="linenos">1184</span></a>    <span class="n">microscope</span> <span class="o">=</span> <span class="n">img_settings</span><span class="o">.</span><span class="n">microscope</span>
</span><span id="grab_custom_resolution_frame-1185"><a href="#grab_custom_resolution_frame-1185"><span class="linenos">1185</span></a>    <span class="n">resolution</span> <span class="o">=</span> <span class="n">img_settings</span><span class="o">.</span><span class="n">scan</span><span class="o">.</span><span class="n">resolution</span>
</span><span id="grab_custom_resolution_frame-1186"><a href="#grab_custom_resolution_frame-1186"><span class="linenos">1186</span></a>    <span class="n">microscope</span><span class="o">.</span><span class="n">imaging</span><span class="o">.</span><span class="n">grab_frame_to_disk</span><span class="p">(</span>
</span><span id="grab_custom_resolution_frame-1187"><a href="#grab_custom_resolution_frame-1187"><span class="linenos">1187</span></a>        <span class="n">save_path</span><span class="o">.</span><span class="n">absolute</span><span class="p">()</span><span class="o">.</span><span class="n">as_posix</span><span class="p">(),</span>
</span><span id="grab_custom_resolution_frame-1188"><a href="#grab_custom_resolution_frame-1188"><span class="linenos">1188</span></a>        <span class="n">file_format</span><span class="o">=</span><span class="n">tbt</span><span class="o">.</span><span class="n">ImageFileFormat</span><span class="o">.</span><span class="n">TIFF</span><span class="o">.</span><span class="n">value</span><span class="p">,</span>
</span><span id="grab_custom_resolution_frame-1189"><a href="#grab_custom_resolution_frame-1189"><span class="linenos">1189</span></a>        <span class="n">settings</span><span class="o">=</span><span class="n">tbt</span><span class="o">.</span><span class="n">GrabFrameSettings</span><span class="p">(</span>
</span><span id="grab_custom_resolution_frame-1190"><a href="#grab_custom_resolution_frame-1190"><span class="linenos">1190</span></a>            <span class="n">resolution</span><span class="o">=</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">resolution</span><span class="o">.</span><span class="n">width</span><span class="si">}</span><span class="s2">x</span><span class="si">{</span><span class="n">resolution</span><span class="o">.</span><span class="n">height</span><span class="si">}</span><span class="s2">&quot;</span>
</span><span id="grab_custom_resolution_frame-1191"><a href="#grab_custom_resolution_frame-1191"><span class="linenos">1191</span></a>        <span class="p">),</span>
</span><span id="grab_custom_resolution_frame-1192"><a href="#grab_custom_resolution_frame-1192"><span class="linenos">1192</span></a>    <span class="p">)</span>
</span><span id="grab_custom_resolution_frame-1193"><a href="#grab_custom_resolution_frame-1193"><span class="linenos">1193</span></a>    <span class="k">return</span> <span class="kc">True</span>
</span></pre></div>


            <div class="docstring"><p>Method for single frame imaging used with custom resolutions.</p>

<p>This function captures a single frame image using custom resolutions and saves it to the specified path.</p>

<h2 id="parameters">Parameters</h2>

<p>img_settings : tbt.ImageSettings
    The image settings, including the microscope and scan resolution.
save_path : Path
    The path to save the captured image.</p>

<h2 id="returns">Returns</h2>

<p>bool
    True if the image is captured and saved successfully, False otherwise.</p>

<h2 id="examples">Examples</h2>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn"><a href="types.html">pytribeam.types</a></span> <span class="k">as</span> <span class="nn">tbt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">pathlib</span> <span class="kn">import</span> <span class="n">Path</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">microscope</span> <span class="o">=</span> <span class="n">tbt</span><span class="o">.</span><span class="n">Microscope</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">microscope</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;localhost&quot;</span><span class="p">)</span>
<span class="go">Client connecting to [localhost:7520]...</span>
<span class="go">Client connected to [localhost:7520]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_settings</span> <span class="o">=</span> <span class="n">tbt</span><span class="o">.</span><span class="n">ImageSettings</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">microscope</span><span class="o">=</span><span class="n">microscope</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">beam</span><span class="o">=</span><span class="n">tbt</span><span class="o">.</span><span class="n">ElectronBeam</span><span class="p">(</span><span class="n">settings</span><span class="o">=</span><span class="kc">None</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">detector</span><span class="o">=</span><span class="n">tbt</span><span class="o">.</span><span class="n">Detector</span><span class="p">(),</span>
<span class="gp">... </span>    <span class="n">scan</span><span class="o">=</span><span class="n">tbt</span><span class="o">.</span><span class="n">Scan</span><span class="p">(</span><span class="n">resolution</span><span class="o">=</span><span class="n">tbt</span><span class="o">.</span><span class="n">Resolution</span><span class="p">(</span><span class="n">width</span><span class="o">=</span><span class="mi">1024</span><span class="p">,</span> <span class="n">height</span><span class="o">=</span><span class="mi">768</span><span class="p">)),</span>
<span class="gp">... </span>    <span class="n">bit_depth</span><span class="o">=</span><span class="n">tbt</span><span class="o">.</span><span class="n">ColorDepth</span><span class="o">.</span><span class="n">BITS_8</span><span class="p">,</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">save_path</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="s2">&quot;/path/to/save/image.tif&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">success</span> <span class="o">=</span> <span class="n">grab_custom_resolution_frame</span><span class="p">(</span><span class="n">img_settings</span><span class="p">,</span> <span class="n">save_path</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">success</span><span class="p">)</span>
<span class="go">True</span>
</code></pre>
</div>
</div>


                </section>
                <section id="grab_preset_resolution_frame">
                            <input id="grab_preset_resolution_frame-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">grab_preset_resolution_frame</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">img_settings</span><span class="p">:</span> <span class="n"><a href="types.html#ImageSettings">pytribeam.types.ImageSettings</a></span></span><span class="return-annotation">) -> <span class="n"><a href="types.html#AdornedImage">pytribeam.types.AdornedImage</a></span>:</span></span>

                <label class="view-source-button" for="grab_preset_resolution_frame-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#grab_preset_resolution_frame"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="grab_preset_resolution_frame-1196"><a href="#grab_preset_resolution_frame-1196"><span class="linenos">1196</span></a><span class="k">def</span> <span class="nf">grab_preset_resolution_frame</span><span class="p">(</span>
</span><span id="grab_preset_resolution_frame-1197"><a href="#grab_preset_resolution_frame-1197"><span class="linenos">1197</span></a>    <span class="n">img_settings</span><span class="p">:</span> <span class="n">tbt</span><span class="o">.</span><span class="n">ImageSettings</span><span class="p">,</span>
</span><span id="grab_preset_resolution_frame-1198"><a href="#grab_preset_resolution_frame-1198"><span class="linenos">1198</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">tbt</span><span class="o">.</span><span class="n">AdornedImage</span><span class="p">:</span>
</span><span id="grab_preset_resolution_frame-1199"><a href="#grab_preset_resolution_frame-1199"><span class="linenos">1199</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="grab_preset_resolution_frame-1200"><a href="#grab_preset_resolution_frame-1200"><span class="linenos">1200</span></a><span class="sd">    Method for single frame imaging used with preset resolutions.</span>
</span><span id="grab_preset_resolution_frame-1201"><a href="#grab_preset_resolution_frame-1201"><span class="linenos">1201</span></a>
</span><span id="grab_preset_resolution_frame-1202"><a href="#grab_preset_resolution_frame-1202"><span class="linenos">1202</span></a><span class="sd">    This function captures a single frame image using preset resolutions.</span>
</span><span id="grab_preset_resolution_frame-1203"><a href="#grab_preset_resolution_frame-1203"><span class="linenos">1203</span></a>
</span><span id="grab_preset_resolution_frame-1204"><a href="#grab_preset_resolution_frame-1204"><span class="linenos">1204</span></a><span class="sd">    Parameters</span>
</span><span id="grab_preset_resolution_frame-1205"><a href="#grab_preset_resolution_frame-1205"><span class="linenos">1205</span></a><span class="sd">    ----------</span>
</span><span id="grab_preset_resolution_frame-1206"><a href="#grab_preset_resolution_frame-1206"><span class="linenos">1206</span></a><span class="sd">    img_settings : tbt.ImageSettings</span>
</span><span id="grab_preset_resolution_frame-1207"><a href="#grab_preset_resolution_frame-1207"><span class="linenos">1207</span></a><span class="sd">        The image settings, including the microscope, beam, detector, and scan resolution.</span>
</span><span id="grab_preset_resolution_frame-1208"><a href="#grab_preset_resolution_frame-1208"><span class="linenos">1208</span></a>
</span><span id="grab_preset_resolution_frame-1209"><a href="#grab_preset_resolution_frame-1209"><span class="linenos">1209</span></a><span class="sd">    Returns</span>
</span><span id="grab_preset_resolution_frame-1210"><a href="#grab_preset_resolution_frame-1210"><span class="linenos">1210</span></a><span class="sd">    -------</span>
</span><span id="grab_preset_resolution_frame-1211"><a href="#grab_preset_resolution_frame-1211"><span class="linenos">1211</span></a><span class="sd">    tbt.AdornedImage</span>
</span><span id="grab_preset_resolution_frame-1212"><a href="#grab_preset_resolution_frame-1212"><span class="linenos">1212</span></a><span class="sd">        The captured image.</span>
</span><span id="grab_preset_resolution_frame-1213"><a href="#grab_preset_resolution_frame-1213"><span class="linenos">1213</span></a>
</span><span id="grab_preset_resolution_frame-1214"><a href="#grab_preset_resolution_frame-1214"><span class="linenos">1214</span></a><span class="sd">    Examples</span>
</span><span id="grab_preset_resolution_frame-1215"><a href="#grab_preset_resolution_frame-1215"><span class="linenos">1215</span></a><span class="sd">    --------</span>
</span><span id="grab_preset_resolution_frame-1216"><a href="#grab_preset_resolution_frame-1216"><span class="linenos">1216</span></a><span class="sd">    &gt;&gt;&gt; import pytribeam.types as tbt</span>
</span><span id="grab_preset_resolution_frame-1217"><a href="#grab_preset_resolution_frame-1217"><span class="linenos">1217</span></a><span class="sd">    &gt;&gt;&gt; microscope = tbt.Microscope()</span>
</span><span id="grab_preset_resolution_frame-1218"><a href="#grab_preset_resolution_frame-1218"><span class="linenos">1218</span></a><span class="sd">    &gt;&gt;&gt; microscope.connect(&quot;localhost&quot;)</span>
</span><span id="grab_preset_resolution_frame-1219"><a href="#grab_preset_resolution_frame-1219"><span class="linenos">1219</span></a><span class="sd">    Client connecting to [localhost:7520]...</span>
</span><span id="grab_preset_resolution_frame-1220"><a href="#grab_preset_resolution_frame-1220"><span class="linenos">1220</span></a><span class="sd">    Client connected to [localhost:7520]</span>
</span><span id="grab_preset_resolution_frame-1221"><a href="#grab_preset_resolution_frame-1221"><span class="linenos">1221</span></a><span class="sd">    &gt;&gt;&gt; img_settings = tbt.ImageSettings(</span>
</span><span id="grab_preset_resolution_frame-1222"><a href="#grab_preset_resolution_frame-1222"><span class="linenos">1222</span></a><span class="sd">    ...     microscope=microscope,</span>
</span><span id="grab_preset_resolution_frame-1223"><a href="#grab_preset_resolution_frame-1223"><span class="linenos">1223</span></a><span class="sd">    ...     beam=tbt.ElectronBeam(settings=None),</span>
</span><span id="grab_preset_resolution_frame-1224"><a href="#grab_preset_resolution_frame-1224"><span class="linenos">1224</span></a><span class="sd">    ...     detector=tbt.Detector(),</span>
</span><span id="grab_preset_resolution_frame-1225"><a href="#grab_preset_resolution_frame-1225"><span class="linenos">1225</span></a><span class="sd">    ...     scan=tbt.Scan(resolution=tbt.PresetResolution.PRESET_768X512),</span>
</span><span id="grab_preset_resolution_frame-1226"><a href="#grab_preset_resolution_frame-1226"><span class="linenos">1226</span></a><span class="sd">    ...     bit_depth=tbt.ColorDepth.BITS_8,</span>
</span><span id="grab_preset_resolution_frame-1227"><a href="#grab_preset_resolution_frame-1227"><span class="linenos">1227</span></a><span class="sd">    ... )</span>
</span><span id="grab_preset_resolution_frame-1228"><a href="#grab_preset_resolution_frame-1228"><span class="linenos">1228</span></a><span class="sd">    &gt;&gt;&gt; image = grab_preset_resolution_frame(img_settings)</span>
</span><span id="grab_preset_resolution_frame-1229"><a href="#grab_preset_resolution_frame-1229"><span class="linenos">1229</span></a><span class="sd">    &gt;&gt;&gt; print(image)</span>
</span><span id="grab_preset_resolution_frame-1230"><a href="#grab_preset_resolution_frame-1230"><span class="linenos">1230</span></a><span class="sd">    AdornedImage(width=768, height=512, bit_depth=8)</span>
</span><span id="grab_preset_resolution_frame-1231"><a href="#grab_preset_resolution_frame-1231"><span class="linenos">1231</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="grab_preset_resolution_frame-1232"><a href="#grab_preset_resolution_frame-1232"><span class="linenos">1232</span></a>    <span class="n">beam</span> <span class="o">=</span> <span class="n">img_settings</span><span class="o">.</span><span class="n">beam</span>
</span><span id="grab_preset_resolution_frame-1233"><a href="#grab_preset_resolution_frame-1233"><span class="linenos">1233</span></a>    <span class="n">microscope</span> <span class="o">=</span> <span class="n">img_settings</span><span class="o">.</span><span class="n">microscope</span>
</span><span id="grab_preset_resolution_frame-1234"><a href="#grab_preset_resolution_frame-1234"><span class="linenos">1234</span></a>    <span class="n">beam_scan_resolution</span><span class="p">(</span>
</span><span id="grab_preset_resolution_frame-1235"><a href="#grab_preset_resolution_frame-1235"><span class="linenos">1235</span></a>        <span class="n">beam</span><span class="o">=</span><span class="n">beam</span><span class="p">,</span>
</span><span id="grab_preset_resolution_frame-1236"><a href="#grab_preset_resolution_frame-1236"><span class="linenos">1236</span></a>        <span class="n">microscope</span><span class="o">=</span><span class="n">microscope</span><span class="p">,</span>
</span><span id="grab_preset_resolution_frame-1237"><a href="#grab_preset_resolution_frame-1237"><span class="linenos">1237</span></a>        <span class="n">resolution</span><span class="o">=</span><span class="n">img_settings</span><span class="o">.</span><span class="n">scan</span><span class="o">.</span><span class="n">resolution</span><span class="p">,</span>
</span><span id="grab_preset_resolution_frame-1238"><a href="#grab_preset_resolution_frame-1238"><span class="linenos">1238</span></a>    <span class="p">)</span>
</span><span id="grab_preset_resolution_frame-1239"><a href="#grab_preset_resolution_frame-1239"><span class="linenos">1239</span></a>    <span class="k">return</span> <span class="n">microscope</span><span class="o">.</span><span class="n">imaging</span><span class="o">.</span><span class="n">grab_frame</span><span class="p">(</span>
</span><span id="grab_preset_resolution_frame-1240"><a href="#grab_preset_resolution_frame-1240"><span class="linenos">1240</span></a>        <span class="n">tbt</span><span class="o">.</span><span class="n">GrabFrameSettings</span><span class="p">(</span><span class="n">bit_depth</span><span class="o">=</span><span class="n">img_settings</span><span class="o">.</span><span class="n">bit_depth</span><span class="p">)</span>
</span><span id="grab_preset_resolution_frame-1241"><a href="#grab_preset_resolution_frame-1241"><span class="linenos">1241</span></a>    <span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Method for single frame imaging used with preset resolutions.</p>

<p>This function captures a single frame image using preset resolutions.</p>

<h2 id="parameters">Parameters</h2>

<p>img_settings : tbt.ImageSettings
    The image settings, including the microscope, beam, detector, and scan resolution.</p>

<h2 id="returns">Returns</h2>

<p>tbt.AdornedImage
    The captured image.</p>

<h2 id="examples">Examples</h2>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn"><a href="types.html">pytribeam.types</a></span> <span class="k">as</span> <span class="nn">tbt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">microscope</span> <span class="o">=</span> <span class="n">tbt</span><span class="o">.</span><span class="n">Microscope</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">microscope</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;localhost&quot;</span><span class="p">)</span>
<span class="go">Client connecting to [localhost:7520]...</span>
<span class="go">Client connected to [localhost:7520]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_settings</span> <span class="o">=</span> <span class="n">tbt</span><span class="o">.</span><span class="n">ImageSettings</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">microscope</span><span class="o">=</span><span class="n">microscope</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">beam</span><span class="o">=</span><span class="n">tbt</span><span class="o">.</span><span class="n">ElectronBeam</span><span class="p">(</span><span class="n">settings</span><span class="o">=</span><span class="kc">None</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">detector</span><span class="o">=</span><span class="n">tbt</span><span class="o">.</span><span class="n">Detector</span><span class="p">(),</span>
<span class="gp">... </span>    <span class="n">scan</span><span class="o">=</span><span class="n">tbt</span><span class="o">.</span><span class="n">Scan</span><span class="p">(</span><span class="n">resolution</span><span class="o">=</span><span class="n">tbt</span><span class="o">.</span><span class="n">PresetResolution</span><span class="o">.</span><span class="n">PRESET_768X512</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">bit_depth</span><span class="o">=</span><span class="n">tbt</span><span class="o">.</span><span class="n">ColorDepth</span><span class="o">.</span><span class="n">BITS_8</span><span class="p">,</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">image</span> <span class="o">=</span> <span class="n">grab_preset_resolution_frame</span><span class="p">(</span><span class="n">img_settings</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">image</span><span class="p">)</span>
<span class="go">AdornedImage(width=768, height=512, bit_depth=8)</span>
</code></pre>
</div>
</div>


                </section>
                <section id="imaging_detector">
                            <input id="imaging_detector-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">imaging_detector</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">img_settings</span><span class="p">:</span> <span class="n"><a href="types.html#ImageSettings">pytribeam.types.ImageSettings</a></span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <label class="view-source-button" for="imaging_detector-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#imaging_detector"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="imaging_detector-1244"><a href="#imaging_detector-1244"><span class="linenos">1244</span></a><span class="k">def</span> <span class="nf">imaging_detector</span><span class="p">(</span><span class="n">img_settings</span><span class="p">:</span> <span class="n">tbt</span><span class="o">.</span><span class="n">ImageSettings</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="imaging_detector-1245"><a href="#imaging_detector-1245"><span class="linenos">1245</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="imaging_detector-1246"><a href="#imaging_detector-1246"><span class="linenos">1246</span></a><span class="sd">    Prepares the detector and inserts it if applicable.</span>
</span><span id="imaging_detector-1247"><a href="#imaging_detector-1247"><span class="linenos">1247</span></a>
</span><span id="imaging_detector-1248"><a href="#imaging_detector-1248"><span class="linenos">1248</span></a><span class="sd">    This function sets the detector type, inserts the detector if necessary, sets the detector mode,</span>
</span><span id="imaging_detector-1249"><a href="#imaging_detector-1249"><span class="linenos">1249</span></a><span class="sd">    and adjusts the contrast and brightness settings. It is important to set detector mode settings</span>
</span><span id="imaging_detector-1250"><a href="#imaging_detector-1250"><span class="linenos">1250</span></a><span class="sd">    right before contrast and brightness as any subsequent calls to a detector type can overwrite the mode.</span>
</span><span id="imaging_detector-1251"><a href="#imaging_detector-1251"><span class="linenos">1251</span></a>
</span><span id="imaging_detector-1252"><a href="#imaging_detector-1252"><span class="linenos">1252</span></a><span class="sd">    Parameters</span>
</span><span id="imaging_detector-1253"><a href="#imaging_detector-1253"><span class="linenos">1253</span></a><span class="sd">    ----------</span>
</span><span id="imaging_detector-1254"><a href="#imaging_detector-1254"><span class="linenos">1254</span></a><span class="sd">    img_settings : tbt.ImageSettings</span>
</span><span id="imaging_detector-1255"><a href="#imaging_detector-1255"><span class="linenos">1255</span></a><span class="sd">        The image settings, including the microscope, beam, and detector settings.</span>
</span><span id="imaging_detector-1256"><a href="#imaging_detector-1256"><span class="linenos">1256</span></a>
</span><span id="imaging_detector-1257"><a href="#imaging_detector-1257"><span class="linenos">1257</span></a><span class="sd">    Returns</span>
</span><span id="imaging_detector-1258"><a href="#imaging_detector-1258"><span class="linenos">1258</span></a><span class="sd">    -------</span>
</span><span id="imaging_detector-1259"><a href="#imaging_detector-1259"><span class="linenos">1259</span></a><span class="sd">    bool</span>
</span><span id="imaging_detector-1260"><a href="#imaging_detector-1260"><span class="linenos">1260</span></a><span class="sd">        True if the detector is prepared successfully, False otherwise.</span>
</span><span id="imaging_detector-1261"><a href="#imaging_detector-1261"><span class="linenos">1261</span></a>
</span><span id="imaging_detector-1262"><a href="#imaging_detector-1262"><span class="linenos">1262</span></a><span class="sd">    Examples</span>
</span><span id="imaging_detector-1263"><a href="#imaging_detector-1263"><span class="linenos">1263</span></a><span class="sd">    --------</span>
</span><span id="imaging_detector-1264"><a href="#imaging_detector-1264"><span class="linenos">1264</span></a><span class="sd">    &gt;&gt;&gt; import pytribeam.types as tbt</span>
</span><span id="imaging_detector-1265"><a href="#imaging_detector-1265"><span class="linenos">1265</span></a><span class="sd">    &gt;&gt;&gt; microscope = tbt.Microscope()</span>
</span><span id="imaging_detector-1266"><a href="#imaging_detector-1266"><span class="linenos">1266</span></a><span class="sd">    &gt;&gt;&gt; microscope.connect(&quot;localhost&quot;)</span>
</span><span id="imaging_detector-1267"><a href="#imaging_detector-1267"><span class="linenos">1267</span></a><span class="sd">    Client connecting to [localhost:7520]...</span>
</span><span id="imaging_detector-1268"><a href="#imaging_detector-1268"><span class="linenos">1268</span></a><span class="sd">    Client connected to [localhost:7520]</span>
</span><span id="imaging_detector-1269"><a href="#imaging_detector-1269"><span class="linenos">1269</span></a><span class="sd">    &gt;&gt;&gt; img_settings = tbt.ImageSettings(</span>
</span><span id="imaging_detector-1270"><a href="#imaging_detector-1270"><span class="linenos">1270</span></a><span class="sd">    ...     microscope=microscope,</span>
</span><span id="imaging_detector-1271"><a href="#imaging_detector-1271"><span class="linenos">1271</span></a><span class="sd">    ...     beam=tbt.ElectronBeam(settings=None),</span>
</span><span id="imaging_detector-1272"><a href="#imaging_detector-1272"><span class="linenos">1272</span></a><span class="sd">    ...     detector=tbt.Detector(</span>
</span><span id="imaging_detector-1273"><a href="#imaging_detector-1273"><span class="linenos">1273</span></a><span class="sd">    ...         type=tbt.DetectorType.ETD,</span>
</span><span id="imaging_detector-1274"><a href="#imaging_detector-1274"><span class="linenos">1274</span></a><span class="sd">    ...         mode=tbt.DetectorMode.SECONDARY_ELECTRONS,</span>
</span><span id="imaging_detector-1275"><a href="#imaging_detector-1275"><span class="linenos">1275</span></a><span class="sd">    ...         brightness=0.4,</span>
</span><span id="imaging_detector-1276"><a href="#imaging_detector-1276"><span class="linenos">1276</span></a><span class="sd">    ...         contrast=0.2,</span>
</span><span id="imaging_detector-1277"><a href="#imaging_detector-1277"><span class="linenos">1277</span></a><span class="sd">    ...     ),</span>
</span><span id="imaging_detector-1278"><a href="#imaging_detector-1278"><span class="linenos">1278</span></a><span class="sd">    ...     scan=tbt.Scan(resolution=tbt.PresetResolution.PRESET_768X512),</span>
</span><span id="imaging_detector-1279"><a href="#imaging_detector-1279"><span class="linenos">1279</span></a><span class="sd">    ...     bit_depth=tbt.ColorDepth.BITS_8,</span>
</span><span id="imaging_detector-1280"><a href="#imaging_detector-1280"><span class="linenos">1280</span></a><span class="sd">    ... )</span>
</span><span id="imaging_detector-1281"><a href="#imaging_detector-1281"><span class="linenos">1281</span></a><span class="sd">    &gt;&gt;&gt; success = imaging_detector(img_settings)</span>
</span><span id="imaging_detector-1282"><a href="#imaging_detector-1282"><span class="linenos">1282</span></a><span class="sd">    &gt;&gt;&gt; print(success)</span>
</span><span id="imaging_detector-1283"><a href="#imaging_detector-1283"><span class="linenos">1283</span></a><span class="sd">    True</span>
</span><span id="imaging_detector-1284"><a href="#imaging_detector-1284"><span class="linenos">1284</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="imaging_detector-1285"><a href="#imaging_detector-1285"><span class="linenos">1285</span></a>    <span class="n">microscope</span> <span class="o">=</span> <span class="n">img_settings</span><span class="o">.</span><span class="n">microscope</span>
</span><span id="imaging_detector-1286"><a href="#imaging_detector-1286"><span class="linenos">1286</span></a>    <span class="n">detector</span> <span class="o">=</span> <span class="n">img_settings</span><span class="o">.</span><span class="n">detector</span><span class="o">.</span><span class="n">type</span>
</span><span id="imaging_detector-1287"><a href="#imaging_detector-1287"><span class="linenos">1287</span></a>    <span class="n">detector_type</span><span class="p">(</span>
</span><span id="imaging_detector-1288"><a href="#imaging_detector-1288"><span class="linenos">1288</span></a>        <span class="n">microscope</span><span class="o">=</span><span class="n">microscope</span><span class="p">,</span>
</span><span id="imaging_detector-1289"><a href="#imaging_detector-1289"><span class="linenos">1289</span></a>        <span class="n">detector</span><span class="o">=</span><span class="n">detector</span><span class="p">,</span>
</span><span id="imaging_detector-1290"><a href="#imaging_detector-1290"><span class="linenos">1290</span></a>    <span class="p">)</span>
</span><span id="imaging_detector-1291"><a href="#imaging_detector-1291"><span class="linenos">1291</span></a>    <span class="n">detector_state</span> <span class="o">=</span> <span class="n">devices</span><span class="o">.</span><span class="n">detector_state</span><span class="p">(</span>
</span><span id="imaging_detector-1292"><a href="#imaging_detector-1292"><span class="linenos">1292</span></a>        <span class="n">microscope</span><span class="o">=</span><span class="n">microscope</span><span class="p">,</span>
</span><span id="imaging_detector-1293"><a href="#imaging_detector-1293"><span class="linenos">1293</span></a>        <span class="n">detector</span><span class="o">=</span><span class="n">detector</span><span class="p">,</span>
</span><span id="imaging_detector-1294"><a href="#imaging_detector-1294"><span class="linenos">1294</span></a>    <span class="p">)</span>
</span><span id="imaging_detector-1295"><a href="#imaging_detector-1295"><span class="linenos">1295</span></a>    <span class="k">if</span> <span class="n">detector_state</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
</span><span id="imaging_detector-1296"><a href="#imaging_detector-1296"><span class="linenos">1296</span></a>        <span class="n">devices</span><span class="o">.</span><span class="n">insert_detector</span><span class="p">(</span>
</span><span id="imaging_detector-1297"><a href="#imaging_detector-1297"><span class="linenos">1297</span></a>            <span class="n">microscope</span><span class="o">=</span><span class="n">microscope</span><span class="p">,</span>
</span><span id="imaging_detector-1298"><a href="#imaging_detector-1298"><span class="linenos">1298</span></a>            <span class="n">detector</span><span class="o">=</span><span class="n">detector</span><span class="p">,</span>
</span><span id="imaging_detector-1299"><a href="#imaging_detector-1299"><span class="linenos">1299</span></a>        <span class="p">)</span>
</span><span id="imaging_detector-1300"><a href="#imaging_detector-1300"><span class="linenos">1300</span></a>    <span class="n">detector_mode</span><span class="p">(</span>
</span><span id="imaging_detector-1301"><a href="#imaging_detector-1301"><span class="linenos">1301</span></a>        <span class="n">microscope</span><span class="o">=</span><span class="n">microscope</span><span class="p">,</span>
</span><span id="imaging_detector-1302"><a href="#imaging_detector-1302"><span class="linenos">1302</span></a>        <span class="n">detector_mode</span><span class="o">=</span><span class="n">img_settings</span><span class="o">.</span><span class="n">detector</span><span class="o">.</span><span class="n">mode</span><span class="p">,</span>
</span><span id="imaging_detector-1303"><a href="#imaging_detector-1303"><span class="linenos">1303</span></a>    <span class="p">)</span>
</span><span id="imaging_detector-1304"><a href="#imaging_detector-1304"><span class="linenos">1304</span></a>    <span class="n">detector_cb</span><span class="p">(</span>
</span><span id="imaging_detector-1305"><a href="#imaging_detector-1305"><span class="linenos">1305</span></a>        <span class="n">microscope</span><span class="o">=</span><span class="n">microscope</span><span class="p">,</span>
</span><span id="imaging_detector-1306"><a href="#imaging_detector-1306"><span class="linenos">1306</span></a>        <span class="n">detector_settings</span><span class="o">=</span><span class="n">img_settings</span><span class="o">.</span><span class="n">detector</span><span class="p">,</span>
</span><span id="imaging_detector-1307"><a href="#imaging_detector-1307"><span class="linenos">1307</span></a>        <span class="n">beam</span><span class="o">=</span><span class="n">img_settings</span><span class="o">.</span><span class="n">beam</span><span class="p">,</span>
</span><span id="imaging_detector-1308"><a href="#imaging_detector-1308"><span class="linenos">1308</span></a>    <span class="p">)</span>
</span><span id="imaging_detector-1309"><a href="#imaging_detector-1309"><span class="linenos">1309</span></a>    <span class="k">return</span> <span class="kc">True</span>
</span></pre></div>


            <div class="docstring"><p>Prepares the detector and inserts it if applicable.</p>

<p>This function sets the detector type, inserts the detector if necessary, sets the detector mode,
and adjusts the contrast and brightness settings. It is important to set detector mode settings
right before contrast and brightness as any subsequent calls to a detector type can overwrite the mode.</p>

<h2 id="parameters">Parameters</h2>

<p>img_settings : tbt.ImageSettings
    The image settings, including the microscope, beam, and detector settings.</p>

<h2 id="returns">Returns</h2>

<p>bool
    True if the detector is prepared successfully, False otherwise.</p>

<h2 id="examples">Examples</h2>

<div class="pdoc-code codehilite">
<pre><span></span><code><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn"><a href="types.html">pytribeam.types</a></span> <span class="k">as</span> <span class="nn">tbt</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">microscope</span> <span class="o">=</span> <span class="n">tbt</span><span class="o">.</span><span class="n">Microscope</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">microscope</span><span class="o">.</span><span class="n">connect</span><span class="p">(</span><span class="s2">&quot;localhost&quot;</span><span class="p">)</span>
<span class="go">Client connecting to [localhost:7520]...</span>
<span class="go">Client connected to [localhost:7520]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">img_settings</span> <span class="o">=</span> <span class="n">tbt</span><span class="o">.</span><span class="n">ImageSettings</span><span class="p">(</span>
<span class="gp">... </span>    <span class="n">microscope</span><span class="o">=</span><span class="n">microscope</span><span class="p">,</span>
<span class="gp">... </span>    <span class="n">beam</span><span class="o">=</span><span class="n">tbt</span><span class="o">.</span><span class="n">ElectronBeam</span><span class="p">(</span><span class="n">settings</span><span class="o">=</span><span class="kc">None</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">detector</span><span class="o">=</span><span class="n">tbt</span><span class="o">.</span><span class="n">Detector</span><span class="p">(</span>
<span class="gp">... </span>        <span class="nb">type</span><span class="o">=</span><span class="n">tbt</span><span class="o">.</span><span class="n">DetectorType</span><span class="o">.</span><span class="n">ETD</span><span class="p">,</span>
<span class="gp">... </span>        <span class="n">mode</span><span class="o">=</span><span class="n">tbt</span><span class="o">.</span><span class="n">DetectorMode</span><span class="o">.</span><span class="n">SECONDARY_ELECTRONS</span><span class="p">,</span>
<span class="gp">... </span>        <span class="n">brightness</span><span class="o">=</span><span class="mf">0.4</span><span class="p">,</span>
<span class="gp">... </span>        <span class="n">contrast</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>
<span class="gp">... </span>    <span class="p">),</span>
<span class="gp">... </span>    <span class="n">scan</span><span class="o">=</span><span class="n">tbt</span><span class="o">.</span><span class="n">Scan</span><span class="p">(</span><span class="n">resolution</span><span class="o">=</span><span class="n">tbt</span><span class="o">.</span><span class="n">PresetResolution</span><span class="o">.</span><span class="n">PRESET_768X512</span><span class="p">),</span>
<span class="gp">... </span>    <span class="n">bit_depth</span><span class="o">=</span><span class="n">tbt</span><span class="o">.</span><span class="n">ColorDepth</span><span class="o">.</span><span class="n">BITS_8</span><span class="p">,</span>
<span class="gp">... </span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">success</span> <span class="o">=</span> <span class="n">imaging_detector</span><span class="p">(</span><span class="n">img_settings</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">success</span><span class="p">)</span>
<span class="go">True</span>
</code></pre>
</div>
</div>


                </section>
                <section id="imaging_device">
                            <input id="imaging_device-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">imaging_device</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">microscope</span><span class="p">:</span> <span class="n"><a href="types.html#Microscope">pytribeam.types.Microscope</a></span>,</span><span class="param">	<span class="n">beam</span><span class="p">:</span> <span class="n"><a href="types.html#Beam">pytribeam.types.Beam</a></span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <label class="view-source-button" for="imaging_device-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#imaging_device"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="imaging_device-1312"><a href="#imaging_device-1312"><span class="linenos">1312</span></a><span class="k">def</span> <span class="nf">imaging_device</span><span class="p">(</span>
</span><span id="imaging_device-1313"><a href="#imaging_device-1313"><span class="linenos">1313</span></a>    <span class="n">microscope</span><span class="p">:</span> <span class="n">tbt</span><span class="o">.</span><span class="n">Microscope</span><span class="p">,</span>
</span><span id="imaging_device-1314"><a href="#imaging_device-1314"><span class="linenos">1314</span></a>    <span class="n">beam</span><span class="p">:</span> <span class="n">tbt</span><span class="o">.</span><span class="n">Beam</span><span class="p">,</span>
</span><span id="imaging_device-1315"><a href="#imaging_device-1315"><span class="linenos">1315</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="imaging_device-1316"><a href="#imaging_device-1316"><span class="linenos">1316</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="imaging_device-1317"><a href="#imaging_device-1317"><span class="linenos">1317</span></a><span class="sd">    Prepares the imaging beam, viewing quad, and the beam voltage and current.</span>
</span><span id="imaging_device-1318"><a href="#imaging_device-1318"><span class="linenos">1318</span></a>
</span><span id="imaging_device-1319"><a href="#imaging_device-1319"><span class="linenos">1319</span></a><span class="sd">    This function sets the beam device, ensures the beam is ready, sets the beam voltage and current,</span>
</span><span id="imaging_device-1320"><a href="#imaging_device-1320"><span class="linenos">1320</span></a><span class="sd">    and applies angular correction if the beam type is electron.</span>
</span><span id="imaging_device-1321"><a href="#imaging_device-1321"><span class="linenos">1321</span></a>
</span><span id="imaging_device-1322"><a href="#imaging_device-1322"><span class="linenos">1322</span></a><span class="sd">    Parameters</span>
</span><span id="imaging_device-1323"><a href="#imaging_device-1323"><span class="linenos">1323</span></a><span class="sd">    ----------</span>
</span><span id="imaging_device-1324"><a href="#imaging_device-1324"><span class="linenos">1324</span></a><span class="sd">    microscope : tbt.Microscope</span>
</span><span id="imaging_device-1325"><a href="#imaging_device-1325"><span class="linenos">1325</span></a><span class="sd">        The microscope object to configure.</span>
</span><span id="imaging_device-1326"><a href="#imaging_device-1326"><span class="linenos">1326</span></a><span class="sd">    beam : tbt.Beam</span>
</span><span id="imaging_device-1327"><a href="#imaging_device-1327"><span class="linenos">1327</span></a><span class="sd">        The beam type to configure, including its settings.</span>
</span><span id="imaging_device-1328"><a href="#imaging_device-1328"><span class="linenos">1328</span></a>
</span><span id="imaging_device-1329"><a href="#imaging_device-1329"><span class="linenos">1329</span></a><span class="sd">    Returns</span>
</span><span id="imaging_device-1330"><a href="#imaging_device-1330"><span class="linenos">1330</span></a><span class="sd">    -------</span>
</span><span id="imaging_device-1331"><a href="#imaging_device-1331"><span class="linenos">1331</span></a><span class="sd">    bool</span>
</span><span id="imaging_device-1332"><a href="#imaging_device-1332"><span class="linenos">1332</span></a><span class="sd">        True if the imaging device is prepared successfully, False otherwise.</span>
</span><span id="imaging_device-1333"><a href="#imaging_device-1333"><span class="linenos">1333</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="imaging_device-1334"><a href="#imaging_device-1334"><span class="linenos">1334</span></a>    <span class="n">set_beam_device</span><span class="p">(</span><span class="n">microscope</span><span class="o">=</span><span class="n">microscope</span><span class="p">,</span> <span class="n">device</span><span class="o">=</span><span class="n">beam</span><span class="o">.</span><span class="n">device</span><span class="p">)</span>
</span><span id="imaging_device-1335"><a href="#imaging_device-1335"><span class="linenos">1335</span></a>    <span class="n">beam_ready</span><span class="p">(</span><span class="n">beam</span><span class="o">=</span><span class="n">beam</span><span class="p">,</span> <span class="n">microscope</span><span class="o">=</span><span class="n">microscope</span><span class="p">)</span>
</span><span id="imaging_device-1336"><a href="#imaging_device-1336"><span class="linenos">1336</span></a>    <span class="n">beam_voltage</span><span class="p">(</span>
</span><span id="imaging_device-1337"><a href="#imaging_device-1337"><span class="linenos">1337</span></a>        <span class="n">beam</span><span class="o">=</span><span class="n">beam</span><span class="p">,</span>
</span><span id="imaging_device-1338"><a href="#imaging_device-1338"><span class="linenos">1338</span></a>        <span class="n">microscope</span><span class="o">=</span><span class="n">microscope</span><span class="p">,</span>
</span><span id="imaging_device-1339"><a href="#imaging_device-1339"><span class="linenos">1339</span></a>        <span class="n">voltage_kv</span><span class="o">=</span><span class="n">beam</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">voltage_kv</span><span class="p">,</span>
</span><span id="imaging_device-1340"><a href="#imaging_device-1340"><span class="linenos">1340</span></a>        <span class="n">voltage_tol_kv</span><span class="o">=</span><span class="n">beam</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">voltage_tol_kv</span><span class="p">,</span>
</span><span id="imaging_device-1341"><a href="#imaging_device-1341"><span class="linenos">1341</span></a>    <span class="p">)</span>
</span><span id="imaging_device-1342"><a href="#imaging_device-1342"><span class="linenos">1342</span></a>    <span class="n">beam_current</span><span class="p">(</span>
</span><span id="imaging_device-1343"><a href="#imaging_device-1343"><span class="linenos">1343</span></a>        <span class="n">beam</span><span class="o">=</span><span class="n">beam</span><span class="p">,</span>
</span><span id="imaging_device-1344"><a href="#imaging_device-1344"><span class="linenos">1344</span></a>        <span class="n">microscope</span><span class="o">=</span><span class="n">microscope</span><span class="p">,</span>
</span><span id="imaging_device-1345"><a href="#imaging_device-1345"><span class="linenos">1345</span></a>        <span class="n">current_na</span><span class="o">=</span><span class="n">beam</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">current_na</span><span class="p">,</span>
</span><span id="imaging_device-1346"><a href="#imaging_device-1346"><span class="linenos">1346</span></a>        <span class="n">current_tol_na</span><span class="o">=</span><span class="n">beam</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">current_tol_na</span><span class="p">,</span>
</span><span id="imaging_device-1347"><a href="#imaging_device-1347"><span class="linenos">1347</span></a>    <span class="p">)</span>
</span><span id="imaging_device-1348"><a href="#imaging_device-1348"><span class="linenos">1348</span></a>    <span class="k">if</span> <span class="n">beam</span><span class="o">.</span><span class="n">type</span> <span class="o">==</span> <span class="n">tbt</span><span class="o">.</span><span class="n">BeamType</span><span class="o">.</span><span class="n">ELECTRON</span><span class="p">:</span>
</span><span id="imaging_device-1349"><a href="#imaging_device-1349"><span class="linenos">1349</span></a>        <span class="n">beam_angular_correction</span><span class="p">(</span>
</span><span id="imaging_device-1350"><a href="#imaging_device-1350"><span class="linenos">1350</span></a>            <span class="n">microscope</span><span class="o">=</span><span class="n">microscope</span><span class="p">,</span>
</span><span id="imaging_device-1351"><a href="#imaging_device-1351"><span class="linenos">1351</span></a>            <span class="n">dynamic_focus</span><span class="o">=</span><span class="n">beam</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">dynamic_focus</span><span class="p">,</span>
</span><span id="imaging_device-1352"><a href="#imaging_device-1352"><span class="linenos">1352</span></a>            <span class="n">tilt_correction</span><span class="o">=</span><span class="n">beam</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">tilt_correction</span><span class="p">,</span>
</span><span id="imaging_device-1353"><a href="#imaging_device-1353"><span class="linenos">1353</span></a>        <span class="p">)</span>
</span><span id="imaging_device-1354"><a href="#imaging_device-1354"><span class="linenos">1354</span></a>    <span class="k">return</span> <span class="kc">True</span>
</span></pre></div>


            <div class="docstring"><p>Prepares the imaging beam, viewing quad, and the beam voltage and current.</p>

<p>This function sets the beam device, ensures the beam is ready, sets the beam voltage and current,
and applies angular correction if the beam type is electron.</p>

<h2 id="parameters">Parameters</h2>

<p>microscope : tbt.Microscope
    The microscope object to configure.
beam : tbt.Beam
    The beam type to configure, including its settings.</p>

<h2 id="returns">Returns</h2>

<p>bool
    True if the imaging device is prepared successfully, False otherwise.</p>
</div>


                </section>
                <section id="imaging_scan">
                            <input id="imaging_scan-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">imaging_scan</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">img_settings</span><span class="p">:</span> <span class="n"><a href="types.html#ImageSettings">pytribeam.types.ImageSettings</a></span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <label class="view-source-button" for="imaging_scan-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#imaging_scan"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="imaging_scan-1357"><a href="#imaging_scan-1357"><span class="linenos">1357</span></a><span class="k">def</span> <span class="nf">imaging_scan</span><span class="p">(</span><span class="n">img_settings</span><span class="p">:</span> <span class="n">tbt</span><span class="o">.</span><span class="n">ImageSettings</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="imaging_scan-1358"><a href="#imaging_scan-1358"><span class="linenos">1358</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="imaging_scan-1359"><a href="#imaging_scan-1359"><span class="linenos">1359</span></a><span class="sd">    Sets all scan settings except for the resolution.</span>
</span><span id="imaging_scan-1360"><a href="#imaging_scan-1360"><span class="linenos">1360</span></a>
</span><span id="imaging_scan-1361"><a href="#imaging_scan-1361"><span class="linenos">1361</span></a><span class="sd">    This function configures the scan settings for the specified image settings, including</span>
</span><span id="imaging_scan-1362"><a href="#imaging_scan-1362"><span class="linenos">1362</span></a><span class="sd">    setting the scan mode to full frame, scan rotation, working distance, horizontal field width,</span>
</span><span id="imaging_scan-1363"><a href="#imaging_scan-1363"><span class="linenos">1363</span></a><span class="sd">    and dwell time.</span>
</span><span id="imaging_scan-1364"><a href="#imaging_scan-1364"><span class="linenos">1364</span></a>
</span><span id="imaging_scan-1365"><a href="#imaging_scan-1365"><span class="linenos">1365</span></a><span class="sd">    Parameters</span>
</span><span id="imaging_scan-1366"><a href="#imaging_scan-1366"><span class="linenos">1366</span></a><span class="sd">    ----------</span>
</span><span id="imaging_scan-1367"><a href="#imaging_scan-1367"><span class="linenos">1367</span></a><span class="sd">    img_settings : tbt.ImageSettings</span>
</span><span id="imaging_scan-1368"><a href="#imaging_scan-1368"><span class="linenos">1368</span></a><span class="sd">        The image settings, including the microscope, beam, and scan settings.</span>
</span><span id="imaging_scan-1369"><a href="#imaging_scan-1369"><span class="linenos">1369</span></a>
</span><span id="imaging_scan-1370"><a href="#imaging_scan-1370"><span class="linenos">1370</span></a><span class="sd">    Returns</span>
</span><span id="imaging_scan-1371"><a href="#imaging_scan-1371"><span class="linenos">1371</span></a><span class="sd">    -------</span>
</span><span id="imaging_scan-1372"><a href="#imaging_scan-1372"><span class="linenos">1372</span></a><span class="sd">    bool</span>
</span><span id="imaging_scan-1373"><a href="#imaging_scan-1373"><span class="linenos">1373</span></a><span class="sd">        True if the scan settings are configured successfully, False otherwise.</span>
</span><span id="imaging_scan-1374"><a href="#imaging_scan-1374"><span class="linenos">1374</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="imaging_scan-1375"><a href="#imaging_scan-1375"><span class="linenos">1375</span></a>    <span class="n">microscope</span> <span class="o">=</span> <span class="n">img_settings</span><span class="o">.</span><span class="n">microscope</span>
</span><span id="imaging_scan-1376"><a href="#imaging_scan-1376"><span class="linenos">1376</span></a>    <span class="n">beam</span> <span class="o">=</span> <span class="n">img_settings</span><span class="o">.</span><span class="n">beam</span>
</span><span id="imaging_scan-1377"><a href="#imaging_scan-1377"><span class="linenos">1377</span></a>    <span class="n">beam_scan_full_frame</span><span class="p">(</span>
</span><span id="imaging_scan-1378"><a href="#imaging_scan-1378"><span class="linenos">1378</span></a>        <span class="n">beam</span><span class="o">=</span><span class="n">beam</span><span class="p">,</span>
</span><span id="imaging_scan-1379"><a href="#imaging_scan-1379"><span class="linenos">1379</span></a>        <span class="n">microscope</span><span class="o">=</span><span class="n">microscope</span><span class="p">,</span>
</span><span id="imaging_scan-1380"><a href="#imaging_scan-1380"><span class="linenos">1380</span></a>    <span class="p">)</span>
</span><span id="imaging_scan-1381"><a href="#imaging_scan-1381"><span class="linenos">1381</span></a>    <span class="n">beam_scan_rotation</span><span class="p">(</span>
</span><span id="imaging_scan-1382"><a href="#imaging_scan-1382"><span class="linenos">1382</span></a>        <span class="n">beam</span><span class="o">=</span><span class="n">beam</span><span class="p">,</span> <span class="n">microscope</span><span class="o">=</span><span class="n">microscope</span><span class="p">,</span> <span class="n">rotation_deg</span><span class="o">=</span><span class="n">img_settings</span><span class="o">.</span><span class="n">scan</span><span class="o">.</span><span class="n">rotation_deg</span>
</span><span id="imaging_scan-1383"><a href="#imaging_scan-1383"><span class="linenos">1383</span></a>    <span class="p">)</span>
</span><span id="imaging_scan-1384"><a href="#imaging_scan-1384"><span class="linenos">1384</span></a>    <span class="n">beam_working_distance</span><span class="p">(</span>
</span><span id="imaging_scan-1385"><a href="#imaging_scan-1385"><span class="linenos">1385</span></a>        <span class="n">beam</span><span class="o">=</span><span class="n">beam</span><span class="p">,</span>
</span><span id="imaging_scan-1386"><a href="#imaging_scan-1386"><span class="linenos">1386</span></a>        <span class="n">microscope</span><span class="o">=</span><span class="n">microscope</span><span class="p">,</span>
</span><span id="imaging_scan-1387"><a href="#imaging_scan-1387"><span class="linenos">1387</span></a>        <span class="n">wd_mm</span><span class="o">=</span><span class="n">img_settings</span><span class="o">.</span><span class="n">beam</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">working_dist_mm</span><span class="p">,</span>
</span><span id="imaging_scan-1388"><a href="#imaging_scan-1388"><span class="linenos">1388</span></a>    <span class="p">)</span>
</span><span id="imaging_scan-1389"><a href="#imaging_scan-1389"><span class="linenos">1389</span></a>    <span class="n">beam_hfw</span><span class="p">(</span><span class="n">beam</span><span class="o">=</span><span class="n">beam</span><span class="p">,</span> <span class="n">microscope</span><span class="o">=</span><span class="n">microscope</span><span class="p">,</span> <span class="n">hfw_mm</span><span class="o">=</span><span class="n">img_settings</span><span class="o">.</span><span class="n">beam</span><span class="o">.</span><span class="n">settings</span><span class="o">.</span><span class="n">hfw_mm</span><span class="p">)</span>
</span><span id="imaging_scan-1390"><a href="#imaging_scan-1390"><span class="linenos">1390</span></a>    <span class="n">beam_dwell_time</span><span class="p">(</span>
</span><span id="imaging_scan-1391"><a href="#imaging_scan-1391"><span class="linenos">1391</span></a>        <span class="n">beam</span><span class="o">=</span><span class="n">beam</span><span class="p">,</span> <span class="n">microscope</span><span class="o">=</span><span class="n">microscope</span><span class="p">,</span> <span class="n">dwell_us</span><span class="o">=</span><span class="n">img_settings</span><span class="o">.</span><span class="n">scan</span><span class="o">.</span><span class="n">dwell_time_us</span>
</span><span id="imaging_scan-1392"><a href="#imaging_scan-1392"><span class="linenos">1392</span></a>    <span class="p">)</span>
</span><span id="imaging_scan-1393"><a href="#imaging_scan-1393"><span class="linenos">1393</span></a>    <span class="k">return</span> <span class="kc">True</span>
</span></pre></div>


            <div class="docstring"><p>Sets all scan settings except for the resolution.</p>

<p>This function configures the scan settings for the specified image settings, including
setting the scan mode to full frame, scan rotation, working distance, horizontal field width,
and dwell time.</p>

<h2 id="parameters">Parameters</h2>

<p>img_settings : tbt.ImageSettings
    The image settings, including the microscope, beam, and scan settings.</p>

<h2 id="returns">Returns</h2>

<p>bool
    True if the scan settings are configured successfully, False otherwise.</p>
</div>


                </section>
                <section id="prepare_imaging">
                            <input id="prepare_imaging-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">prepare_imaging</span><span class="signature pdoc-code condensed">(<span class="param"><span class="n">img_settings</span><span class="p">:</span> <span class="n"><a href="types.html#ImageSettings">pytribeam.types.ImageSettings</a></span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <label class="view-source-button" for="prepare_imaging-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#prepare_imaging"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="prepare_imaging-1396"><a href="#prepare_imaging-1396"><span class="linenos">1396</span></a><span class="k">def</span> <span class="nf">prepare_imaging</span><span class="p">(</span><span class="n">img_settings</span><span class="p">:</span> <span class="n">tbt</span><span class="o">.</span><span class="n">ImageSettings</span><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="prepare_imaging-1397"><a href="#prepare_imaging-1397"><span class="linenos">1397</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="prepare_imaging-1398"><a href="#prepare_imaging-1398"><span class="linenos">1398</span></a><span class="sd">    Prepares various imaging settings.</span>
</span><span id="prepare_imaging-1399"><a href="#prepare_imaging-1399"><span class="linenos">1399</span></a>
</span><span id="prepare_imaging-1400"><a href="#prepare_imaging-1400"><span class="linenos">1400</span></a><span class="sd">    This function prepares the imaging device, scan settings, and detector settings</span>
</span><span id="prepare_imaging-1401"><a href="#prepare_imaging-1401"><span class="linenos">1401</span></a><span class="sd">    based on the specified image settings.</span>
</span><span id="prepare_imaging-1402"><a href="#prepare_imaging-1402"><span class="linenos">1402</span></a>
</span><span id="prepare_imaging-1403"><a href="#prepare_imaging-1403"><span class="linenos">1403</span></a><span class="sd">    Parameters</span>
</span><span id="prepare_imaging-1404"><a href="#prepare_imaging-1404"><span class="linenos">1404</span></a><span class="sd">    ----------</span>
</span><span id="prepare_imaging-1405"><a href="#prepare_imaging-1405"><span class="linenos">1405</span></a><span class="sd">    img_settings : tbt.ImageSettings</span>
</span><span id="prepare_imaging-1406"><a href="#prepare_imaging-1406"><span class="linenos">1406</span></a><span class="sd">        The image settings, including the microscope, beam, scan, and detector settings.</span>
</span><span id="prepare_imaging-1407"><a href="#prepare_imaging-1407"><span class="linenos">1407</span></a>
</span><span id="prepare_imaging-1408"><a href="#prepare_imaging-1408"><span class="linenos">1408</span></a><span class="sd">    Returns</span>
</span><span id="prepare_imaging-1409"><a href="#prepare_imaging-1409"><span class="linenos">1409</span></a><span class="sd">    -------</span>
</span><span id="prepare_imaging-1410"><a href="#prepare_imaging-1410"><span class="linenos">1410</span></a><span class="sd">    bool</span>
</span><span id="prepare_imaging-1411"><a href="#prepare_imaging-1411"><span class="linenos">1411</span></a><span class="sd">        True if the imaging settings are prepared successfully, False otherwise.</span>
</span><span id="prepare_imaging-1412"><a href="#prepare_imaging-1412"><span class="linenos">1412</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="prepare_imaging-1413"><a href="#prepare_imaging-1413"><span class="linenos">1413</span></a>    <span class="n">imaging_device</span><span class="p">(</span><span class="n">microscope</span><span class="o">=</span><span class="n">img_settings</span><span class="o">.</span><span class="n">microscope</span><span class="p">,</span> <span class="n">beam</span><span class="o">=</span><span class="n">img_settings</span><span class="o">.</span><span class="n">beam</span><span class="p">)</span>
</span><span id="prepare_imaging-1414"><a href="#prepare_imaging-1414"><span class="linenos">1414</span></a>    <span class="n">imaging_scan</span><span class="p">(</span><span class="n">img_settings</span><span class="o">=</span><span class="n">img_settings</span><span class="p">)</span>
</span><span id="prepare_imaging-1415"><a href="#prepare_imaging-1415"><span class="linenos">1415</span></a>    <span class="n">imaging_detector</span><span class="p">(</span><span class="n">img_settings</span><span class="o">=</span><span class="n">img_settings</span><span class="p">)</span>
</span><span id="prepare_imaging-1416"><a href="#prepare_imaging-1416"><span class="linenos">1416</span></a>    <span class="k">return</span> <span class="kc">True</span>
</span></pre></div>


            <div class="docstring"><p>Prepares various imaging settings.</p>

<p>This function prepares the imaging device, scan settings, and detector settings
based on the specified image settings.</p>

<h2 id="parameters">Parameters</h2>

<p>img_settings : tbt.ImageSettings
    The image settings, including the microscope, beam, scan, and detector settings.</p>

<h2 id="returns">Returns</h2>

<p>bool
    True if the imaging settings are prepared successfully, False otherwise.</p>
</div>


                </section>
                <section id="set_view">
                            <input id="set_view-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">set_view</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">microscope</span><span class="p">:</span> <span class="n"><a href="types.html#Microscope">pytribeam.types.Microscope</a></span>,</span><span class="param">	<span class="n">quad</span><span class="p">:</span> <span class="n"><a href="types.html#ViewQuad">pytribeam.types.ViewQuad</a></span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <label class="view-source-button" for="set_view-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#set_view"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="set_view-1419"><a href="#set_view-1419"><span class="linenos">1419</span></a><span class="k">def</span> <span class="nf">set_view</span><span class="p">(</span>
</span><span id="set_view-1420"><a href="#set_view-1420"><span class="linenos">1420</span></a>    <span class="n">microscope</span><span class="p">:</span> <span class="n">tbt</span><span class="o">.</span><span class="n">Microscope</span><span class="p">,</span>
</span><span id="set_view-1421"><a href="#set_view-1421"><span class="linenos">1421</span></a>    <span class="n">quad</span><span class="p">:</span> <span class="n">tbt</span><span class="o">.</span><span class="n">ViewQuad</span><span class="p">,</span>
</span><span id="set_view-1422"><a href="#set_view-1422"><span class="linenos">1422</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="set_view-1423"><a href="#set_view-1423"><span class="linenos">1423</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="set_view-1424"><a href="#set_view-1424"><span class="linenos">1424</span></a><span class="sd">    Sets the active view to the specified quad.</span>
</span><span id="set_view-1425"><a href="#set_view-1425"><span class="linenos">1425</span></a>
</span><span id="set_view-1426"><a href="#set_view-1426"><span class="linenos">1426</span></a><span class="sd">    This function sets the active imaging view to the specified quad on the microscope.</span>
</span><span id="set_view-1427"><a href="#set_view-1427"><span class="linenos">1427</span></a>
</span><span id="set_view-1428"><a href="#set_view-1428"><span class="linenos">1428</span></a><span class="sd">    Parameters</span>
</span><span id="set_view-1429"><a href="#set_view-1429"><span class="linenos">1429</span></a><span class="sd">    ----------</span>
</span><span id="set_view-1430"><a href="#set_view-1430"><span class="linenos">1430</span></a><span class="sd">    microscope : tbt.Microscope</span>
</span><span id="set_view-1431"><a href="#set_view-1431"><span class="linenos">1431</span></a><span class="sd">        The microscope object to configure.</span>
</span><span id="set_view-1432"><a href="#set_view-1432"><span class="linenos">1432</span></a><span class="sd">    quad : tbt.ViewQuad</span>
</span><span id="set_view-1433"><a href="#set_view-1433"><span class="linenos">1433</span></a><span class="sd">        The imaging view to select:</span>
</span><span id="set_view-1434"><a href="#set_view-1434"><span class="linenos">1434</span></a><span class="sd">        - 1 is upper left</span>
</span><span id="set_view-1435"><a href="#set_view-1435"><span class="linenos">1435</span></a><span class="sd">        - 2 is upper right</span>
</span><span id="set_view-1436"><a href="#set_view-1436"><span class="linenos">1436</span></a><span class="sd">        - 3 is lower left</span>
</span><span id="set_view-1437"><a href="#set_view-1437"><span class="linenos">1437</span></a><span class="sd">        - 4 is lower right</span>
</span><span id="set_view-1438"><a href="#set_view-1438"><span class="linenos">1438</span></a>
</span><span id="set_view-1439"><a href="#set_view-1439"><span class="linenos">1439</span></a><span class="sd">    Returns</span>
</span><span id="set_view-1440"><a href="#set_view-1440"><span class="linenos">1440</span></a><span class="sd">    -------</span>
</span><span id="set_view-1441"><a href="#set_view-1441"><span class="linenos">1441</span></a><span class="sd">    bool</span>
</span><span id="set_view-1442"><a href="#set_view-1442"><span class="linenos">1442</span></a><span class="sd">        True if the active view is set successfully, False otherwise.</span>
</span><span id="set_view-1443"><a href="#set_view-1443"><span class="linenos">1443</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="set_view-1444"><a href="#set_view-1444"><span class="linenos">1444</span></a>    <span class="n">microscope</span><span class="o">.</span><span class="n">imaging</span><span class="o">.</span><span class="n">set_active_view</span><span class="p">(</span><span class="n">quad</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
</span></pre></div>


            <div class="docstring"><p>Sets the active view to the specified quad.</p>

<p>This function sets the active imaging view to the specified quad on the microscope.</p>

<h2 id="parameters">Parameters</h2>

<p>microscope : tbt.Microscope
    The microscope object to configure.
quad : tbt.ViewQuad
    The imaging view to select:
    - 1 is upper left
    - 2 is upper right
    - 3 is lower left
    - 4 is lower right</p>

<h2 id="returns">Returns</h2>

<p>bool
    True if the active view is set successfully, False otherwise.</p>
</div>


                </section>
                <section id="set_beam_device">
                            <input id="set_beam_device-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">set_beam_device</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">microscope</span><span class="p">:</span> <span class="n"><a href="types.html#Microscope">pytribeam.types.Microscope</a></span>,</span><span class="param">	<span class="n">device</span><span class="p">:</span> <span class="n"><a href="types.html#Device">pytribeam.types.Device</a></span>,</span><span class="param">	<span class="n">delay_s</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.1</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <label class="view-source-button" for="set_beam_device-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#set_beam_device"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="set_beam_device-1447"><a href="#set_beam_device-1447"><span class="linenos">1447</span></a><span class="k">def</span> <span class="nf">set_beam_device</span><span class="p">(</span>
</span><span id="set_beam_device-1448"><a href="#set_beam_device-1448"><span class="linenos">1448</span></a>    <span class="n">microscope</span><span class="p">:</span> <span class="n">tbt</span><span class="o">.</span><span class="n">Microscope</span><span class="p">,</span>
</span><span id="set_beam_device-1449"><a href="#set_beam_device-1449"><span class="linenos">1449</span></a>    <span class="n">device</span><span class="p">:</span> <span class="n">tbt</span><span class="o">.</span><span class="n">Device</span><span class="p">,</span>
</span><span id="set_beam_device-1450"><a href="#set_beam_device-1450"><span class="linenos">1450</span></a>    <span class="n">delay_s</span><span class="p">:</span> <span class="nb">float</span> <span class="o">=</span> <span class="mf">0.1</span><span class="p">,</span>
</span><span id="set_beam_device-1451"><a href="#set_beam_device-1451"><span class="linenos">1451</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="set_beam_device-1452"><a href="#set_beam_device-1452"><span class="linenos">1452</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="set_beam_device-1453"><a href="#set_beam_device-1453"><span class="linenos">1453</span></a><span class="sd">    Sets the active imaging device.</span>
</span><span id="set_beam_device-1454"><a href="#set_beam_device-1454"><span class="linenos">1454</span></a>
</span><span id="set_beam_device-1455"><a href="#set_beam_device-1455"><span class="linenos">1455</span></a><span class="sd">    This function sets the active imaging device on the microscope and waits for the specified delay.</span>
</span><span id="set_beam_device-1456"><a href="#set_beam_device-1456"><span class="linenos">1456</span></a>
</span><span id="set_beam_device-1457"><a href="#set_beam_device-1457"><span class="linenos">1457</span></a><span class="sd">    Parameters</span>
</span><span id="set_beam_device-1458"><a href="#set_beam_device-1458"><span class="linenos">1458</span></a><span class="sd">    ----------</span>
</span><span id="set_beam_device-1459"><a href="#set_beam_device-1459"><span class="linenos">1459</span></a><span class="sd">    microscope : tbt.Microscope</span>
</span><span id="set_beam_device-1460"><a href="#set_beam_device-1460"><span class="linenos">1460</span></a><span class="sd">        The microscope object to configure.</span>
</span><span id="set_beam_device-1461"><a href="#set_beam_device-1461"><span class="linenos">1461</span></a><span class="sd">    device : tbt.Device</span>
</span><span id="set_beam_device-1462"><a href="#set_beam_device-1462"><span class="linenos">1462</span></a><span class="sd">        The desired imaging device.</span>
</span><span id="set_beam_device-1463"><a href="#set_beam_device-1463"><span class="linenos">1463</span></a><span class="sd">    delay_s : float, optional</span>
</span><span id="set_beam_device-1464"><a href="#set_beam_device-1464"><span class="linenos">1464</span></a><span class="sd">        The delay in seconds to wait after setting the device (default is 0.1).</span>
</span><span id="set_beam_device-1465"><a href="#set_beam_device-1465"><span class="linenos">1465</span></a>
</span><span id="set_beam_device-1466"><a href="#set_beam_device-1466"><span class="linenos">1466</span></a><span class="sd">    Returns</span>
</span><span id="set_beam_device-1467"><a href="#set_beam_device-1467"><span class="linenos">1467</span></a><span class="sd">    -------</span>
</span><span id="set_beam_device-1468"><a href="#set_beam_device-1468"><span class="linenos">1468</span></a><span class="sd">    bool</span>
</span><span id="set_beam_device-1469"><a href="#set_beam_device-1469"><span class="linenos">1469</span></a><span class="sd">        True if the active device is set successfully, False otherwise.</span>
</span><span id="set_beam_device-1470"><a href="#set_beam_device-1470"><span class="linenos">1470</span></a>
</span><span id="set_beam_device-1471"><a href="#set_beam_device-1471"><span class="linenos">1471</span></a><span class="sd">    Raises</span>
</span><span id="set_beam_device-1472"><a href="#set_beam_device-1472"><span class="linenos">1472</span></a><span class="sd">    ------</span>
</span><span id="set_beam_device-1473"><a href="#set_beam_device-1473"><span class="linenos">1473</span></a><span class="sd">    ValueError</span>
</span><span id="set_beam_device-1474"><a href="#set_beam_device-1474"><span class="linenos">1474</span></a><span class="sd">        If the active device cannot be set correctly.</span>
</span><span id="set_beam_device-1475"><a href="#set_beam_device-1475"><span class="linenos">1475</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="set_beam_device-1476"><a href="#set_beam_device-1476"><span class="linenos">1476</span></a>    <span class="n">microscope</span><span class="o">.</span><span class="n">imaging</span><span class="o">.</span><span class="n">set_active_device</span><span class="p">(</span><span class="n">device</span><span class="p">)</span>
</span><span id="set_beam_device-1477"><a href="#set_beam_device-1477"><span class="linenos">1477</span></a>    <span class="n">time</span><span class="o">.</span><span class="n">sleep</span><span class="p">(</span><span class="n">delay_s</span><span class="p">)</span>
</span><span id="set_beam_device-1478"><a href="#set_beam_device-1478"><span class="linenos">1478</span></a>    <span class="n">curr_device</span> <span class="o">=</span> <span class="n">tbt</span><span class="o">.</span><span class="n">Device</span><span class="p">(</span><span class="n">microscope</span><span class="o">.</span><span class="n">imaging</span><span class="o">.</span><span class="n">get_active_device</span><span class="p">())</span>
</span><span id="set_beam_device-1479"><a href="#set_beam_device-1479"><span class="linenos">1479</span></a>    <span class="k">if</span> <span class="n">curr_device</span> <span class="o">!=</span> <span class="n">device</span><span class="o">.</span><span class="n">value</span><span class="p">:</span>
</span><span id="set_beam_device-1480"><a href="#set_beam_device-1480"><span class="linenos">1480</span></a>        <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="set_beam_device-1481"><a href="#set_beam_device-1481"><span class="linenos">1481</span></a>            <span class="sa">f</span><span class="s2">&quot;&quot;&quot;Could not set active device,</span>
</span><span id="set_beam_device-1482"><a href="#set_beam_device-1482"><span class="linenos">1482</span></a><span class="s2">            requested device </span><span class="si">{</span><span class="n">device</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2"> but current device is </span><span class="si">{</span><span class="n">curr_device</span><span class="si">}</span><span class="s2">.</span>
</span><span id="set_beam_device-1483"><a href="#set_beam_device-1483"><span class="linenos">1483</span></a><span class="s2">            Device list:</span>
</span><span id="set_beam_device-1484"><a href="#set_beam_device-1484"><span class="linenos">1484</span></a><span class="s2">                </span><span class="si">{</span><span class="n">tbt</span><span class="o">.</span><span class="n">Device</span><span class="o">.</span><span class="n">ELECTRON_BEAM</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2">: Electron Beam</span>
</span><span id="set_beam_device-1485"><a href="#set_beam_device-1485"><span class="linenos">1485</span></a><span class="s2">                </span><span class="si">{</span><span class="n">tbt</span><span class="o">.</span><span class="n">Device</span><span class="o">.</span><span class="n">ION_BEAM</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2">: Ion Beam</span>
</span><span id="set_beam_device-1486"><a href="#set_beam_device-1486"><span class="linenos">1486</span></a><span class="s2">                </span><span class="si">{</span><span class="n">tbt</span><span class="o">.</span><span class="n">Device</span><span class="o">.</span><span class="n">CCD_CAMERA</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2">: CCD Camera</span>
</span><span id="set_beam_device-1487"><a href="#set_beam_device-1487"><span class="linenos">1487</span></a><span class="s2">                </span><span class="si">{</span><span class="n">tbt</span><span class="o">.</span><span class="n">Device</span><span class="o">.</span><span class="n">IR_CAMERA</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2">: IR Camera</span>
</span><span id="set_beam_device-1488"><a href="#set_beam_device-1488"><span class="linenos">1488</span></a><span class="s2">                </span><span class="si">{</span><span class="n">tbt</span><span class="o">.</span><span class="n">Device</span><span class="o">.</span><span class="n">NAV_CAM</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2">: Nav Cam&quot;&quot;&quot;</span>
</span><span id="set_beam_device-1489"><a href="#set_beam_device-1489"><span class="linenos">1489</span></a>        <span class="p">)</span>
</span><span id="set_beam_device-1490"><a href="#set_beam_device-1490"><span class="linenos">1490</span></a>    <span class="k">return</span> <span class="kc">True</span>
</span></pre></div>


            <div class="docstring"><p>Sets the active imaging device.</p>

<p>This function sets the active imaging device on the microscope and waits for the specified delay.</p>

<h2 id="parameters">Parameters</h2>

<p>microscope : tbt.Microscope
    The microscope object to configure.
device : tbt.Device
    The desired imaging device.
delay_s : float, optional
    The delay in seconds to wait after setting the device (default is 0.1).</p>

<h2 id="returns">Returns</h2>

<p>bool
    True if the active device is set successfully, False otherwise.</p>

<h2 id="raises">Raises</h2>

<p>ValueError
    If the active device cannot be set correctly.</p>
</div>


                </section>
                <section id="collect_single_image">
                            <input id="collect_single_image-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">collect_single_image</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">save_path</span><span class="p">:</span> <span class="n">pathlib</span><span class="o">.</span><span class="n">Path</span>,</span><span class="param">	<span class="n">img_settings</span><span class="p">:</span> <span class="n"><a href="types.html#ImageSettings">pytribeam.types.ImageSettings</a></span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <label class="view-source-button" for="collect_single_image-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#collect_single_image"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="collect_single_image-1496"><a href="#collect_single_image-1496"><span class="linenos">1496</span></a><span class="k">def</span> <span class="nf">collect_single_image</span><span class="p">(</span>
</span><span id="collect_single_image-1497"><a href="#collect_single_image-1497"><span class="linenos">1497</span></a>    <span class="n">save_path</span><span class="p">:</span> <span class="n">Path</span><span class="p">,</span>
</span><span id="collect_single_image-1498"><a href="#collect_single_image-1498"><span class="linenos">1498</span></a>    <span class="n">img_settings</span><span class="p">:</span> <span class="n">tbt</span><span class="o">.</span><span class="n">ImageSettings</span><span class="p">,</span>
</span><span id="collect_single_image-1499"><a href="#collect_single_image-1499"><span class="linenos">1499</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="collect_single_image-1500"><a href="#collect_single_image-1500"><span class="linenos">1500</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="collect_single_image-1501"><a href="#collect_single_image-1501"><span class="linenos">1501</span></a><span class="sd">    Collects a single frame image with defined image settings.</span>
</span><span id="collect_single_image-1502"><a href="#collect_single_image-1502"><span class="linenos">1502</span></a>
</span><span id="collect_single_image-1503"><a href="#collect_single_image-1503"><span class="linenos">1503</span></a><span class="sd">    This function prepares the imaging settings, sets the view, and captures a single frame image.</span>
</span><span id="collect_single_image-1504"><a href="#collect_single_image-1504"><span class="linenos">1504</span></a><span class="sd">    It saves the image to the specified path. If a non-preset resolution is requested, the image</span>
</span><span id="collect_single_image-1505"><a href="#collect_single_image-1505"><span class="linenos">1505</span></a><span class="sd">    will be saved at 8-bit color depth.</span>
</span><span id="collect_single_image-1506"><a href="#collect_single_image-1506"><span class="linenos">1506</span></a>
</span><span id="collect_single_image-1507"><a href="#collect_single_image-1507"><span class="linenos">1507</span></a><span class="sd">    Parameters</span>
</span><span id="collect_single_image-1508"><a href="#collect_single_image-1508"><span class="linenos">1508</span></a><span class="sd">    ----------</span>
</span><span id="collect_single_image-1509"><a href="#collect_single_image-1509"><span class="linenos">1509</span></a><span class="sd">    save_path : Path</span>
</span><span id="collect_single_image-1510"><a href="#collect_single_image-1510"><span class="linenos">1510</span></a><span class="sd">        The path to save the captured image.</span>
</span><span id="collect_single_image-1511"><a href="#collect_single_image-1511"><span class="linenos">1511</span></a><span class="sd">    img_settings : tbt.ImageSettings</span>
</span><span id="collect_single_image-1512"><a href="#collect_single_image-1512"><span class="linenos">1512</span></a><span class="sd">        The image settings, including the microscope, beam, scan, and detector settings.</span>
</span><span id="collect_single_image-1513"><a href="#collect_single_image-1513"><span class="linenos">1513</span></a>
</span><span id="collect_single_image-1514"><a href="#collect_single_image-1514"><span class="linenos">1514</span></a><span class="sd">    Returns</span>
</span><span id="collect_single_image-1515"><a href="#collect_single_image-1515"><span class="linenos">1515</span></a><span class="sd">    -------</span>
</span><span id="collect_single_image-1516"><a href="#collect_single_image-1516"><span class="linenos">1516</span></a><span class="sd">    bool</span>
</span><span id="collect_single_image-1517"><a href="#collect_single_image-1517"><span class="linenos">1517</span></a><span class="sd">        True if the image is captured and saved successfully, False otherwise.</span>
</span><span id="collect_single_image-1518"><a href="#collect_single_image-1518"><span class="linenos">1518</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="collect_single_image-1519"><a href="#collect_single_image-1519"><span class="linenos">1519</span></a>    <span class="n">beam</span> <span class="o">=</span> <span class="n">img_settings</span><span class="o">.</span><span class="n">beam</span>
</span><span id="collect_single_image-1520"><a href="#collect_single_image-1520"><span class="linenos">1520</span></a>    <span class="n">microscope</span> <span class="o">=</span> <span class="n">img_settings</span><span class="o">.</span><span class="n">microscope</span>
</span><span id="collect_single_image-1521"><a href="#collect_single_image-1521"><span class="linenos">1521</span></a>    <span class="n">set_view</span><span class="p">(</span><span class="n">microscope</span><span class="o">=</span><span class="n">microscope</span><span class="p">,</span> <span class="n">quad</span><span class="o">=</span><span class="n">beam</span><span class="o">.</span><span class="n">default_view</span><span class="p">)</span>
</span><span id="collect_single_image-1522"><a href="#collect_single_image-1522"><span class="linenos">1522</span></a>    <span class="n">prepare_imaging</span><span class="p">(</span><span class="n">img_settings</span><span class="o">=</span><span class="n">img_settings</span><span class="p">)</span>
</span><span id="collect_single_image-1523"><a href="#collect_single_image-1523"><span class="linenos">1523</span></a>
</span><span id="collect_single_image-1524"><a href="#collect_single_image-1524"><span class="linenos">1524</span></a>    <span class="n">resolution</span> <span class="o">=</span> <span class="n">img_settings</span><span class="o">.</span><span class="n">scan</span><span class="o">.</span><span class="n">resolution</span>
</span><span id="collect_single_image-1525"><a href="#collect_single_image-1525"><span class="linenos">1525</span></a>    <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">resolution</span><span class="p">,</span> <span class="n">tbt</span><span class="o">.</span><span class="n">PresetResolution</span><span class="p">):</span>
</span><span id="collect_single_image-1526"><a href="#collect_single_image-1526"><span class="linenos">1526</span></a>        <span class="n">img</span> <span class="o">=</span> <span class="n">grab_preset_resolution_frame</span><span class="p">(</span><span class="n">img_settings</span><span class="o">=</span><span class="n">img_settings</span><span class="p">)</span>
</span><span id="collect_single_image-1527"><a href="#collect_single_image-1527"><span class="linenos">1527</span></a>        <span class="n">img</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">save_path</span><span class="p">))</span>
</span><span id="collect_single_image-1528"><a href="#collect_single_image-1528"><span class="linenos">1528</span></a>        <span class="k">return</span> <span class="kc">True</span>
</span><span id="collect_single_image-1529"><a href="#collect_single_image-1529"><span class="linenos">1529</span></a>    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
</span><span id="collect_single_image-1530"><a href="#collect_single_image-1530"><span class="linenos">1530</span></a>        <span class="sa">f</span><span class="s1">&#39;Warning, non-preset resolution of &quot;</span><span class="si">{</span><span class="n">img_settings</span><span class="o">.</span><span class="n">scan</span><span class="o">.</span><span class="n">resolution</span><span class="si">}</span><span class="s1">&quot; requested. Image will automatically be saved at 8-bit color depth&#39;</span>
</span><span id="collect_single_image-1531"><a href="#collect_single_image-1531"><span class="linenos">1531</span></a>    <span class="p">)</span>
</span><span id="collect_single_image-1532"><a href="#collect_single_image-1532"><span class="linenos">1532</span></a>    <span class="k">if</span> <span class="n">img_settings</span><span class="o">.</span><span class="n">bit_depth</span> <span class="o">!=</span> <span class="n">tbt</span><span class="o">.</span><span class="n">ColorDepth</span><span class="o">.</span><span class="n">BITS_8</span><span class="p">:</span>
</span><span id="collect_single_image-1533"><a href="#collect_single_image-1533"><span class="linenos">1533</span></a>        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
</span><span id="collect_single_image-1534"><a href="#collect_single_image-1534"><span class="linenos">1534</span></a>            <span class="sa">f</span><span class="s2">&quot;Warning, non-preset resolution necessitates images be stored at 8-bit color depth, requested bit-depth of </span><span class="si">{</span><span class="n">img_settings</span><span class="o">.</span><span class="n">bit_depth</span><span class="o">.</span><span class="n">value</span><span class="si">}</span><span class="s2"> will be ignored.&quot;</span>
</span><span id="collect_single_image-1535"><a href="#collect_single_image-1535"><span class="linenos">1535</span></a>        <span class="p">)</span>
</span><span id="collect_single_image-1536"><a href="#collect_single_image-1536"><span class="linenos">1536</span></a>    <span class="n">grab_custom_resolution_frame</span><span class="p">(</span>
</span><span id="collect_single_image-1537"><a href="#collect_single_image-1537"><span class="linenos">1537</span></a>        <span class="n">img_settings</span><span class="o">=</span><span class="n">img_settings</span><span class="p">,</span>
</span><span id="collect_single_image-1538"><a href="#collect_single_image-1538"><span class="linenos">1538</span></a>        <span class="n">save_path</span><span class="o">=</span><span class="n">save_path</span><span class="p">,</span>
</span><span id="collect_single_image-1539"><a href="#collect_single_image-1539"><span class="linenos">1539</span></a>    <span class="p">)</span>
</span><span id="collect_single_image-1540"><a href="#collect_single_image-1540"><span class="linenos">1540</span></a>    <span class="k">return</span> <span class="kc">True</span>
</span></pre></div>


            <div class="docstring"><p>Collects a single frame image with defined image settings.</p>

<p>This function prepares the imaging settings, sets the view, and captures a single frame image.
It saves the image to the specified path. If a non-preset resolution is requested, the image
will be saved at 8-bit color depth.</p>

<h2 id="parameters">Parameters</h2>

<p>save_path : Path
    The path to save the captured image.
img_settings : tbt.ImageSettings
    The image settings, including the microscope, beam, scan, and detector settings.</p>

<h2 id="returns">Returns</h2>

<p>bool
    True if the image is captured and saved successfully, False otherwise.</p>
</div>


                </section>
                <section id="collect_multiple_images">
                            <input id="collect_multiple_images-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">collect_multiple_images</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">multiple_img_settings</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n"><a href="types.html#ImageSettings">pytribeam.types.ImageSettings</a></span><span class="p">]</span>,</span><span class="param">	<span class="n">num_frames</span><span class="p">:</span> <span class="nb">int</span></span><span class="return-annotation">) -> <span class="n">List</span><span class="p">[</span><span class="n"><a href="types.html#AdornedImage">pytribeam.types.AdornedImage</a></span><span class="p">]</span>:</span></span>

                <label class="view-source-button" for="collect_multiple_images-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#collect_multiple_images"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="collect_multiple_images-1543"><a href="#collect_multiple_images-1543"><span class="linenos">1543</span></a><span class="k">def</span> <span class="nf">collect_multiple_images</span><span class="p">(</span>
</span><span id="collect_multiple_images-1544"><a href="#collect_multiple_images-1544"><span class="linenos">1544</span></a>    <span class="n">multiple_img_settings</span><span class="p">:</span> <span class="n">List</span><span class="p">[</span><span class="n">tbt</span><span class="o">.</span><span class="n">ImageSettings</span><span class="p">],</span> <span class="n">num_frames</span><span class="p">:</span> <span class="nb">int</span>
</span><span id="collect_multiple_images-1545"><a href="#collect_multiple_images-1545"><span class="linenos">1545</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="n">List</span><span class="p">[</span><span class="n">tbt</span><span class="o">.</span><span class="n">AdornedImage</span><span class="p">]:</span>
</span><span id="collect_multiple_images-1546"><a href="#collect_multiple_images-1546"><span class="linenos">1546</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="collect_multiple_images-1547"><a href="#collect_multiple_images-1547"><span class="linenos">1547</span></a><span class="sd">    Sets up scanning for multiple frames.</span>
</span><span id="collect_multiple_images-1548"><a href="#collect_multiple_images-1548"><span class="linenos">1548</span></a>
</span><span id="collect_multiple_images-1549"><a href="#collect_multiple_images-1549"><span class="linenos">1549</span></a><span class="sd">    This function is best used for collecting multiple segments on a single detector simultaneously.</span>
</span><span id="collect_multiple_images-1550"><a href="#collect_multiple_images-1550"><span class="linenos">1550</span></a><span class="sd">    It is limited to preset resolutions only.</span>
</span><span id="collect_multiple_images-1551"><a href="#collect_multiple_images-1551"><span class="linenos">1551</span></a>
</span><span id="collect_multiple_images-1552"><a href="#collect_multiple_images-1552"><span class="linenos">1552</span></a><span class="sd">    Parameters</span>
</span><span id="collect_multiple_images-1553"><a href="#collect_multiple_images-1553"><span class="linenos">1553</span></a><span class="sd">    ----------</span>
</span><span id="collect_multiple_images-1554"><a href="#collect_multiple_images-1554"><span class="linenos">1554</span></a><span class="sd">    multiple_img_settings : List[tbt.ImageSettings]</span>
</span><span id="collect_multiple_images-1555"><a href="#collect_multiple_images-1555"><span class="linenos">1555</span></a><span class="sd">        The list of image settings for each frame, including the microscope, beam, scan, and detector settings.</span>
</span><span id="collect_multiple_images-1556"><a href="#collect_multiple_images-1556"><span class="linenos">1556</span></a><span class="sd">    num_frames : int</span>
</span><span id="collect_multiple_images-1557"><a href="#collect_multiple_images-1557"><span class="linenos">1557</span></a><span class="sd">        The number of frames to collect.</span>
</span><span id="collect_multiple_images-1558"><a href="#collect_multiple_images-1558"><span class="linenos">1558</span></a>
</span><span id="collect_multiple_images-1559"><a href="#collect_multiple_images-1559"><span class="linenos">1559</span></a><span class="sd">    Returns</span>
</span><span id="collect_multiple_images-1560"><a href="#collect_multiple_images-1560"><span class="linenos">1560</span></a><span class="sd">    -------</span>
</span><span id="collect_multiple_images-1561"><a href="#collect_multiple_images-1561"><span class="linenos">1561</span></a><span class="sd">    List[tbt.AdornedImage]</span>
</span><span id="collect_multiple_images-1562"><a href="#collect_multiple_images-1562"><span class="linenos">1562</span></a><span class="sd">        The list of captured images.</span>
</span><span id="collect_multiple_images-1563"><a href="#collect_multiple_images-1563"><span class="linenos">1563</span></a>
</span><span id="collect_multiple_images-1564"><a href="#collect_multiple_images-1564"><span class="linenos">1564</span></a><span class="sd">    Raises</span>
</span><span id="collect_multiple_images-1565"><a href="#collect_multiple_images-1565"><span class="linenos">1565</span></a><span class="sd">    ------</span>
</span><span id="collect_multiple_images-1566"><a href="#collect_multiple_images-1566"><span class="linenos">1566</span></a><span class="sd">    ValueError</span>
</span><span id="collect_multiple_images-1567"><a href="#collect_multiple_images-1567"><span class="linenos">1567</span></a><span class="sd">        If a non-preset resolution is requested for simultaneous multiple frame imaging.</span>
</span><span id="collect_multiple_images-1568"><a href="#collect_multiple_images-1568"><span class="linenos">1568</span></a>
</span><span id="collect_multiple_images-1569"><a href="#collect_multiple_images-1569"><span class="linenos">1569</span></a><span class="sd">    Notes</span>
</span><span id="collect_multiple_images-1570"><a href="#collect_multiple_images-1570"><span class="linenos">1570</span></a><span class="sd">    -----</span>
</span><span id="collect_multiple_images-1571"><a href="#collect_multiple_images-1571"><span class="linenos">1571</span></a><span class="sd">    This method has not yet been tested.</span>
</span><span id="collect_multiple_images-1572"><a href="#collect_multiple_images-1572"><span class="linenos">1572</span></a>
</span><span id="collect_multiple_images-1573"><a href="#collect_multiple_images-1573"><span class="linenos">1573</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="collect_multiple_images-1574"><a href="#collect_multiple_images-1574"><span class="linenos">1574</span></a>    <span class="c1"># TODO test this</span>
</span><span id="collect_multiple_images-1575"><a href="#collect_multiple_images-1575"><span class="linenos">1575</span></a>    <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span><span class="s2">&quot;Method not yet tested&quot;</span><span class="p">)</span>
</span><span id="collect_multiple_images-1576"><a href="#collect_multiple_images-1576"><span class="linenos">1576</span></a>    <span class="n">views</span> <span class="o">=</span> <span class="p">[]</span>
</span><span id="collect_multiple_images-1577"><a href="#collect_multiple_images-1577"><span class="linenos">1577</span></a>    <span class="k">for</span> <span class="n">quad</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">num_frames</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
</span><span id="collect_multiple_images-1578"><a href="#collect_multiple_images-1578"><span class="linenos">1578</span></a>        <span class="n">img_settings</span> <span class="o">=</span> <span class="n">multiple_img_settings</span><span class="p">[</span><span class="n">quad</span><span class="p">]</span>
</span><span id="collect_multiple_images-1579"><a href="#collect_multiple_images-1579"><span class="linenos">1579</span></a>        <span class="n">resolution</span> <span class="o">=</span> <span class="n">img_settings</span><span class="o">.</span><span class="n">scan</span><span class="o">.</span><span class="n">resolution</span>
</span><span id="collect_multiple_images-1580"><a href="#collect_multiple_images-1580"><span class="linenos">1580</span></a>        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">resolution</span><span class="p">,</span> <span class="n">tbt</span><span class="o">.</span><span class="n">PresetResolution</span><span class="p">):</span>
</span><span id="collect_multiple_images-1581"><a href="#collect_multiple_images-1581"><span class="linenos">1581</span></a>            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span>
</span><span id="collect_multiple_images-1582"><a href="#collect_multiple_images-1582"><span class="linenos">1582</span></a>                <span class="sa">f</span><span class="s1">&#39;Only preset resolutions allowed for simultaneous multiple frame imaging, but resolution of &quot;</span><span class="si">{</span><span class="n">resolution</span><span class="o">.</span><span class="n">width</span><span class="si">}</span><span class="s1">x</span><span class="si">{</span><span class="n">resolution</span><span class="o">.</span><span class="n">height</span><span class="si">}</span><span class="s1">&quot; was requested.&#39;</span>
</span><span id="collect_multiple_images-1583"><a href="#collect_multiple_images-1583"><span class="linenos">1583</span></a>            <span class="p">)</span>
</span><span id="collect_multiple_images-1584"><a href="#collect_multiple_images-1584"><span class="linenos">1584</span></a>
</span><span id="collect_multiple_images-1585"><a href="#collect_multiple_images-1585"><span class="linenos">1585</span></a>        <span class="n">microscope</span> <span class="o">=</span> <span class="n">img_settings</span><span class="o">.</span><span class="n">microscope</span>
</span><span id="collect_multiple_images-1586"><a href="#collect_multiple_images-1586"><span class="linenos">1586</span></a>        <span class="n">beam</span> <span class="o">=</span> <span class="n">img_settings</span><span class="o">.</span><span class="n">beam</span>
</span><span id="collect_multiple_images-1587"><a href="#collect_multiple_images-1587"><span class="linenos">1587</span></a>        <span class="n">views</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">quad</span><span class="p">)</span>
</span><span id="collect_multiple_images-1588"><a href="#collect_multiple_images-1588"><span class="linenos">1588</span></a>        <span class="n">set_view</span><span class="p">(</span><span class="n">microscope</span><span class="o">=</span><span class="n">microscope</span><span class="p">,</span> <span class="n">quad</span><span class="o">=</span><span class="n">quad</span><span class="p">)</span>
</span><span id="collect_multiple_images-1589"><a href="#collect_multiple_images-1589"><span class="linenos">1589</span></a>        <span class="n">prepare_imaging</span><span class="p">(</span><span class="n">microscope</span><span class="o">=</span><span class="n">microscope</span><span class="p">,</span> <span class="n">beam</span><span class="o">=</span><span class="n">beam</span><span class="p">,</span> <span class="n">img_settings</span><span class="o">=</span><span class="n">img_settings</span><span class="p">)</span>
</span><span id="collect_multiple_images-1590"><a href="#collect_multiple_images-1590"><span class="linenos">1590</span></a>    <span class="n">frames</span> <span class="o">=</span> <span class="n">microscope</span><span class="o">.</span><span class="n">imaging</span><span class="o">.</span><span class="n">grab_multiple_frames</span><span class="p">(</span>
</span><span id="collect_multiple_images-1591"><a href="#collect_multiple_images-1591"><span class="linenos">1591</span></a>        <span class="n">tbt</span><span class="o">.</span><span class="n">GrabFrameSettings</span><span class="p">(</span><span class="n">bit_depth</span><span class="o">=</span><span class="n">img_settings</span><span class="o">.</span><span class="n">bit_depth</span><span class="p">,</span> <span class="n">views</span><span class="o">=</span><span class="n">views</span><span class="p">)</span>
</span><span id="collect_multiple_images-1592"><a href="#collect_multiple_images-1592"><span class="linenos">1592</span></a>    <span class="p">)</span>
</span><span id="collect_multiple_images-1593"><a href="#collect_multiple_images-1593"><span class="linenos">1593</span></a>    <span class="k">return</span> <span class="n">frames</span>
</span></pre></div>


            <div class="docstring"><p>Sets up scanning for multiple frames.</p>

<p>This function is best used for collecting multiple segments on a single detector simultaneously.
It is limited to preset resolutions only.</p>

<h2 id="parameters">Parameters</h2>

<p>multiple_img_settings : List[tbt.ImageSettings]
    The list of image settings for each frame, including the microscope, beam, scan, and detector settings.
num_frames : int
    The number of frames to collect.</p>

<h2 id="returns">Returns</h2>

<p>List[tbt.AdornedImage]
    The list of captured images.</p>

<h2 id="raises">Raises</h2>

<p>ValueError
    If a non-preset resolution is requested for simultaneous multiple frame imaging.</p>

<h2 id="notes">Notes</h2>

<p>This method has not yet been tested.</p>
</div>


                </section>
                <section id="image_operation">
                            <input id="image_operation-view-source" class="view-source-toggle-state" type="checkbox" aria-hidden="true" tabindex="-1">
<div class="attr function">
            
        <span class="def">def</span>
        <span class="name">image_operation</span><span class="signature pdoc-code multiline">(<span class="param">	<span class="n">step</span><span class="p">:</span> <span class="n"><a href="types.html#Step">pytribeam.types.Step</a></span>,</span><span class="param">	<span class="n">image_settings</span><span class="p">:</span> <span class="n"><a href="types.html#ImageSettings">pytribeam.types.ImageSettings</a></span>,</span><span class="param">	<span class="n">general_settings</span><span class="p">:</span> <span class="n"><a href="types.html#GeneralSettings">pytribeam.types.GeneralSettings</a></span>,</span><span class="param">	<span class="n">slice_number</span><span class="p">:</span> <span class="nb">int</span></span><span class="return-annotation">) -> <span class="nb">bool</span>:</span></span>

                <label class="view-source-button" for="image_operation-view-source"><span>View Source</span></label>

    </div>
    <a class="headerlink" href="#image_operation"></a>
            <div class="pdoc-code codehilite"><pre><span></span><span id="image_operation-1609"><a href="#image_operation-1609"><span class="linenos">1609</span></a><span class="k">def</span> <span class="nf">image_operation</span><span class="p">(</span>
</span><span id="image_operation-1610"><a href="#image_operation-1610"><span class="linenos">1610</span></a>    <span class="n">step</span><span class="p">:</span> <span class="n">tbt</span><span class="o">.</span><span class="n">Step</span><span class="p">,</span>
</span><span id="image_operation-1611"><a href="#image_operation-1611"><span class="linenos">1611</span></a>    <span class="n">image_settings</span><span class="p">:</span> <span class="n">tbt</span><span class="o">.</span><span class="n">ImageSettings</span><span class="p">,</span>
</span><span id="image_operation-1612"><a href="#image_operation-1612"><span class="linenos">1612</span></a>    <span class="n">general_settings</span><span class="p">:</span> <span class="n">tbt</span><span class="o">.</span><span class="n">GeneralSettings</span><span class="p">,</span>
</span><span id="image_operation-1613"><a href="#image_operation-1613"><span class="linenos">1613</span></a>    <span class="n">slice_number</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
</span><span id="image_operation-1614"><a href="#image_operation-1614"><span class="linenos">1614</span></a><span class="p">)</span> <span class="o">-&gt;</span> <span class="nb">bool</span><span class="p">:</span>
</span><span id="image_operation-1615"><a href="#image_operation-1615"><span class="linenos">1615</span></a><span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
</span><span id="image_operation-1616"><a href="#image_operation-1616"><span class="linenos">1616</span></a><span class="sd">    Performs an image operation based on the specified settings.</span>
</span><span id="image_operation-1617"><a href="#image_operation-1617"><span class="linenos">1617</span></a>
</span><span id="image_operation-1618"><a href="#image_operation-1618"><span class="linenos">1618</span></a><span class="sd">    This function collects an image, saves it to the specified directory, and turns off tilt correction and dynamic focus.</span>
</span><span id="image_operation-1619"><a href="#image_operation-1619"><span class="linenos">1619</span></a>
</span><span id="image_operation-1620"><a href="#image_operation-1620"><span class="linenos">1620</span></a><span class="sd">    Parameters</span>
</span><span id="image_operation-1621"><a href="#image_operation-1621"><span class="linenos">1621</span></a><span class="sd">    ----------</span>
</span><span id="image_operation-1622"><a href="#image_operation-1622"><span class="linenos">1622</span></a><span class="sd">    step : tbt.Step</span>
</span><span id="image_operation-1623"><a href="#image_operation-1623"><span class="linenos">1623</span></a><span class="sd">        The step information, including the name of the step.</span>
</span><span id="image_operation-1624"><a href="#image_operation-1624"><span class="linenos">1624</span></a><span class="sd">    image_settings : tbt.ImageSettings</span>
</span><span id="image_operation-1625"><a href="#image_operation-1625"><span class="linenos">1625</span></a><span class="sd">        The image settings, including the microscope, beam, scan, and detector settings.</span>
</span><span id="image_operation-1626"><a href="#image_operation-1626"><span class="linenos">1626</span></a><span class="sd">    general_settings : tbt.GeneralSettings</span>
</span><span id="image_operation-1627"><a href="#image_operation-1627"><span class="linenos">1627</span></a><span class="sd">        The general settings, including the experimental directory.</span>
</span><span id="image_operation-1628"><a href="#image_operation-1628"><span class="linenos">1628</span></a><span class="sd">    slice_number : int</span>
</span><span id="image_operation-1629"><a href="#image_operation-1629"><span class="linenos">1629</span></a><span class="sd">        The slice number for naming the saved image file.</span>
</span><span id="image_operation-1630"><a href="#image_operation-1630"><span class="linenos">1630</span></a>
</span><span id="image_operation-1631"><a href="#image_operation-1631"><span class="linenos">1631</span></a><span class="sd">    Returns</span>
</span><span id="image_operation-1632"><a href="#image_operation-1632"><span class="linenos">1632</span></a><span class="sd">    -------</span>
</span><span id="image_operation-1633"><a href="#image_operation-1633"><span class="linenos">1633</span></a><span class="sd">    bool</span>
</span><span id="image_operation-1634"><a href="#image_operation-1634"><span class="linenos">1634</span></a><span class="sd">        True if the image operation is performed successfully, False otherwise.</span>
</span><span id="image_operation-1635"><a href="#image_operation-1635"><span class="linenos">1635</span></a><span class="sd">    &quot;&quot;&quot;</span>
</span><span id="image_operation-1636"><a href="#image_operation-1636"><span class="linenos">1636</span></a>    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">Collecting image&quot;</span><span class="p">)</span>
</span><span id="image_operation-1637"><a href="#image_operation-1637"><span class="linenos">1637</span></a>    <span class="c1"># create folder in same directory as experimental directory</span>
</span><span id="image_operation-1638"><a href="#image_operation-1638"><span class="linenos">1638</span></a>    <span class="n">image_directory</span> <span class="o">=</span> <span class="n">Path</span><span class="p">(</span><span class="n">general_settings</span><span class="o">.</span><span class="n">exp_dir</span><span class="p">)</span><span class="o">.</span><span class="n">joinpath</span><span class="p">(</span><span class="n">step</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span><span id="image_operation-1639"><a href="#image_operation-1639"><span class="linenos">1639</span></a>    <span class="n">image_directory</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">exist_ok</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span><span id="image_operation-1640"><a href="#image_operation-1640"><span class="linenos">1640</span></a>
</span><span id="image_operation-1641"><a href="#image_operation-1641"><span class="linenos">1641</span></a>    <span class="c1"># TODO</span>
</span><span id="image_operation-1642"><a href="#image_operation-1642"><span class="linenos">1642</span></a>    <span class="c1"># determine_image_method()</span>
</span><span id="image_operation-1643"><a href="#image_operation-1643"><span class="linenos">1643</span></a>    <span class="c1"># collect_multiple_images()</span>
</span><span id="image_operation-1644"><a href="#image_operation-1644"><span class="linenos">1644</span></a>
</span><span id="image_operation-1645"><a href="#image_operation-1645"><span class="linenos">1645</span></a>    <span class="c1"># single image process:</span>
</span><span id="image_operation-1646"><a href="#image_operation-1646"><span class="linenos">1646</span></a>    <span class="n">save_path</span> <span class="o">=</span> <span class="n">image_directory</span><span class="o">.</span><span class="n">joinpath</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">slice_number</span><span class="si">:</span><span class="s2">04</span><span class="si">}</span><span class="s2">.tif&quot;</span><span class="p">)</span>
</span><span id="image_operation-1647"><a href="#image_operation-1647"><span class="linenos">1647</span></a>    <span class="n">collect_single_image</span><span class="p">(</span><span class="n">save_path</span><span class="o">=</span><span class="n">save_path</span><span class="p">,</span> <span class="n">img_settings</span><span class="o">=</span><span class="n">image_settings</span><span class="p">)</span>
</span><span id="image_operation-1648"><a href="#image_operation-1648"><span class="linenos">1648</span></a>    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\t</span><span class="s2">Image saved to </span><span class="si">{</span><span class="n">save_path</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</span><span id="image_operation-1649"><a href="#image_operation-1649"><span class="linenos">1649</span></a>
</span><span id="image_operation-1650"><a href="#image_operation-1650"><span class="linenos">1650</span></a>    <span class="c1"># turn off tilt correction and dynamic focus</span>
</span><span id="image_operation-1651"><a href="#image_operation-1651"><span class="linenos">1651</span></a>    <span class="n">beam_angular_correction</span><span class="p">(</span>
</span><span id="image_operation-1652"><a href="#image_operation-1652"><span class="linenos">1652</span></a>        <span class="n">microscope</span><span class="o">=</span><span class="n">image_settings</span><span class="o">.</span><span class="n">microscope</span><span class="p">,</span>
</span><span id="image_operation-1653"><a href="#image_operation-1653"><span class="linenos">1653</span></a>        <span class="n">dynamic_focus</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="image_operation-1654"><a href="#image_operation-1654"><span class="linenos">1654</span></a>        <span class="n">tilt_correction</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
</span><span id="image_operation-1655"><a href="#image_operation-1655"><span class="linenos">1655</span></a>    <span class="p">)</span>
</span><span id="image_operation-1656"><a href="#image_operation-1656"><span class="linenos">1656</span></a>
</span><span id="image_operation-1657"><a href="#image_operation-1657"><span class="linenos">1657</span></a>    <span class="k">return</span> <span class="kc">True</span>
</span></pre></div>


            <div class="docstring"><p>Performs an image operation based on the specified settings.</p>

<p>This function collects an image, saves it to the specified directory, and turns off tilt correction and dynamic focus.</p>

<h2 id="parameters">Parameters</h2>

<p>step : tbt.Step
    The step information, including the name of the step.
image_settings : tbt.ImageSettings
    The image settings, including the microscope, beam, scan, and detector settings.
general_settings : tbt.GeneralSettings
    The general settings, including the experimental directory.
slice_number : int
    The slice number for naming the saved image file.</p>

<h2 id="returns">Returns</h2>

<p>bool
    True if the image operation is performed successfully, False otherwise.</p>
</div>


                </section>
    </main>
<script>
    function escapeHTML(html) {
        return document.createElement('div').appendChild(document.createTextNode(html)).parentNode.innerHTML;
    }

    const originalContent = document.querySelector("main.pdoc");
    let currentContent = originalContent;

    function setContent(innerHTML) {
        let elem;
        if (innerHTML) {
            elem = document.createElement("main");
            elem.classList.add("pdoc");
            elem.innerHTML = innerHTML;
        } else {
            elem = originalContent;
        }
        if (currentContent !== elem) {
            currentContent.replaceWith(elem);
            currentContent = elem;
        }
    }

    function getSearchTerm() {
        return (new URL(window.location)).searchParams.get("search");
    }

    const searchBox = document.querySelector(".pdoc input[type=search]");
    searchBox.addEventListener("input", function () {
        let url = new URL(window.location);
        if (searchBox.value.trim()) {
            url.hash = "";
            url.searchParams.set("search", searchBox.value);
        } else {
            url.searchParams.delete("search");
        }
        history.replaceState("", "", url.toString());
        onInput();
    });
    window.addEventListener("popstate", onInput);


    let search, searchErr;

    async function initialize() {
        try {
            search = await new Promise((resolve, reject) => {
                const script = document.createElement("script");
                script.type = "text/javascript";
                script.async = true;
                script.onload = () => resolve(window.pdocSearch);
                script.onerror = (e) => reject(e);
                script.src = "../search.js";
                document.getElementsByTagName("head")[0].appendChild(script);
            });
        } catch (e) {
            console.error("Cannot fetch pdoc search index");
            searchErr = "Cannot fetch search index.";
        }
        onInput();

        document.querySelector("nav.pdoc").addEventListener("click", e => {
            if (e.target.hash) {
                searchBox.value = "";
                searchBox.dispatchEvent(new Event("input"));
            }
        });
    }

    function onInput() {
        setContent((() => {
            const term = getSearchTerm();
            if (!term) {
                return null
            }
            if (searchErr) {
                return `<h3>Error: ${searchErr}</h3>`
            }
            if (!search) {
                return "<h3>Searching...</h3>"
            }

            window.scrollTo({top: 0, left: 0, behavior: 'auto'});

            const results = search(term);

            let html;
            if (results.length === 0) {
                html = `No search results for '${escapeHTML(term)}'.`
            } else {
                html = `<h4>${results.length} search result${results.length > 1 ? "s" : ""} for '${escapeHTML(term)}'.</h4>`;
            }
            for (let result of results.slice(0, 10)) {
                let doc = result.doc;
                let url = `../${doc.modulename.replaceAll(".", "/")}.html`;
                if (doc.qualname) {
                    url += `#${doc.qualname}`;
                }

                let heading;
                switch (result.doc.kind) {
                    case "function":
                        if (doc.fullname.endsWith(".__init__")) {
                            heading = `<span class="name">${doc.fullname.replace(/\.__init__$/, "")}</span>${doc.signature}`;
                        } else {
                            heading = `<span class="def">${doc.funcdef}</span> <span class="name">${doc.fullname}</span>${doc.signature}`;
                        }
                        break;
                    case "class":
                        heading = `<span class="def">class</span> <span class="name">${doc.fullname}</span>`;
                        if (doc.bases)
                            heading += `<wbr>(<span class="base">${doc.bases}</span>)`;
                        heading += `:`;
                        break;
                    case "variable":
                        heading = `<span class="name">${doc.fullname}</span>`;
                        if (doc.annotation)
                            heading += `<span class="annotation">${doc.annotation}</span>`;
                        if (doc.default_value)
                            heading += `<span class="default_value"> = ${doc.default_value}</span>`;
                        break;
                    default:
                        heading = `<span class="name">${doc.fullname}</span>`;
                        break;
                }
                html += `
                        <section class="search-result">
                        <a href="${url}" class="attr ${doc.kind}">${heading}</a>
                        <div class="docstring">${doc.doc}</div>
                        </section>
                    `;

            }
            return html;
        })());
    }

    if (getSearchTerm()) {
        initialize();
        searchBox.value = getSearchTerm();
        onInput();
    } else {
        searchBox.addEventListener("focus", initialize, {once: true});
    }

    searchBox.addEventListener("keydown", e => {
        if (["ArrowDown", "ArrowUp", "Enter"].includes(e.key)) {
            let focused = currentContent.querySelector(".search-result.focused");
            if (!focused) {
                currentContent.querySelector(".search-result").classList.add("focused");
            } else if (
                e.key === "ArrowDown"
                && focused.nextElementSibling
                && focused.nextElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.nextElementSibling.classList.add("focused");
                focused.nextElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "ArrowUp"
                && focused.previousElementSibling
                && focused.previousElementSibling.classList.contains("search-result")
            ) {
                focused.classList.remove("focused");
                focused.previousElementSibling.classList.add("focused");
                focused.previousElementSibling.scrollIntoView({
                    behavior: "smooth",
                    block: "nearest",
                    inline: "nearest"
                });
            } else if (
                e.key === "Enter"
            ) {
                focused.querySelector("a").click();
            }
        }
    });
</script></body>
</html>